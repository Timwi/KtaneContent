<!DOCTYPE html>
<html class="no-js">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Coordinates — Keep Talking and Nobody Explodes Module</title>
    <meta content="initial-scale=1" name="viewport">
    <link rel='stylesheet' type='text/css' href='css/font.css'>
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/main.css" rel="stylesheet" type="text/css">
    <script src='js/highlighter.js'></script>
    <style>
        span.footnote-marker {
            vertical-align: super;
            font-size: 70%;
        }
        table {
            border: none;
        }
        table.grid {
            border-collapse: separate;
            border-spacing: .5mm;
        }
        td.corner {
            border: none;
        }
        p.footnote {
            font-size: 70%;
        }
        div.column {
            float: left;
            margin: 0 0 .7em;
        }
        div.column-1 { width: 37.5%; }
        div.column-2 { width: 40.5%; }
        div.column-3 { width: 22%; }
        h4 {
            clear: both;
            margin: .7em 0 .2em;
        }
        div.footnotes {
            position: relative;
            margin-top: 2em;
            padding-top: 1em;
        }
        div.footnotes:before {
            border-top: 1px solid black;
            left: 0;
            top: 0;
            position: absolute;
            width: 50mm;
            content: '';
        }
        table.coordinate-notations th {
            white-space: nowrap;
        }
        table.two-column-groups tr th:not(:first-child) {
            border-left: 1mm solid black;
        }

        input {
            width: 25px;
        }

        .input-grid, .input-grid td, .input-grid th {
            border: none;
        }

        .grid td {
            padding: 0px 0px;
            width: 0px;
            height: 0px;
            transition: padding 0.5s, border-color 0.5s, background-color 0.5s;
            border: 1px solid rgba(0, 0, 0, 0);
            background-color: rgba(0, 0, 0, 0);
            user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
        }

        .grid td.cell {
            padding: 25px 25px;
            border-color: #222;
        }

        .grid td.cell.marked {
            background-color: rgba(255, 0, 0, 0.5);
        }

        .grid td .checkmark {
            transition: color 0.5s;
            color: rgba(0, 0, 0, 0);
        }

        .grid td.cell .checkmark.visible{
            color: rgba(0, 0, 0, 1);
        }

        .input {
            float: left;
            margin-right: 5px;
            padding-top: 10px;
        }

        .input.width, .input.height {
            padding: 10px;
        }

        .selected {
            background-color: rgba(255, 255, 0, 0.5);
        }

        button {
            font-family: Special Elite;
            background-color: white;
            color: black;
            padding: 5px 10px;
            border-radius: 5px;
            border: black 3px solid;
            transition: 0.3s;
            margin-top: 10px;
        }

        button:hover {
            background-color: black;
            color: white;
        }

        .page-content {
            position: relative;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script type="text/javascript">
        $(function() {
            var grid = $(".grid")
            var selected
            var helm = $(".height")
            var welm = $(".width")

            var undos = []
            var redos = []

            $(document).click(function() {
                selected = null

                updateSelection()
            }).keydown(function(event) {
                if (!selected) {
                    selected = welm
                    updateSelection()
                }

                if (event.key == "w") {
                    selected = welm
                    updateSelection()
                } else if (event.key == "h") {
                    selected = helm
                    updateSelection()
                } else if (event.key == "z" && undos.length > 0) {
                    var undo = undos[undos.length - 1]
                    var elem = undo[0]
                    redos.push([elem, elem.hasClass("marked")])
                    elem.toggleClass("marked", undo[1])

                    undos.splice(undos.length - 1, 1)
                } else if (event.key == "y" && redos.length > 0) {
                    var redo = redos[redos.length - 1]
                    var elem = redo[0]
                    undos.push([elem, elem.hasClass("marked")])
                    elem.toggleClass("marked", redo[1])

                    redos.splice(redos.length - 1, 1)
                } else {
                    var n = parseInt(event.key)
                    if (n) {
                        selected.text(n)
                        width = parseInt(welm.text())
                        height = parseInt(helm.text())
                        updateGrid()

                        if (selected.is(welm)) {
                            selected = helm
                        } else {
                            selected = welm
                        }

                        updateSelection()
                    }
                }
            })

            function updateSelection() {
                $(".selected").removeClass("selected")
                if (selected && selected.length > 0) {
                    selected.addClass("selected")
                }
            }

            for (var i = 0; i < 8; i++) {
                var row = $("<tr>").appendTo(grid)
                for (var n = 0; n < 8; n++) {
                    $("<td>").appendTo(row).click(function() {
                        undos.push([$(this), $(this).hasClass("marked")])
                        $(this).toggleClass("marked")
                    }).contextmenu(function(event) {
                        var elm = $(this)
                        var checks = elm.children(".checkmark.visible")
                        if (checks.length == 0) {
                            var pos = elm.position()
                            $("<div>").addClass("checkmark").css({"position": "absolute", "left": pos.left + 19, "top": pos.top + 18}).text("✔").appendTo(elm).delay(100).queue(function(next) {
                                    $(this).addClass("visible")
                                    next()
                                })

                        } else {
                            checks.eq(0).removeClass("visible").delay(500).queue(function(next) {
                                $(this).remove()
                                next()
                            })
                        }
                        event.preventDefault()
                    })
                }
            }

            var width = parseInt(welm.text())
            var height = parseInt(helm.text())

            function updateGrid() {
                width = Math.min(Math.max(width, 2), 8)
                height = Math.min(Math.max(height, 2), 8)

                welm.text(width)
                helm.text(height)
                grid.children().each(function(index) {
                    var row = $(this)
                    row.children().each(function(index2) {
                        $(this).toggleClass("cell", index2 < width && index < height)
                    })
                })
            }
            updateGrid()

            $(".width, .height").click(function(event) {
                selected = $(this)
                updateSelection()

                event.stopPropagation()
            })

            function resetGrid() {
                $(".marked").removeClass("marked")
                undos = []
                redos = []
                $(".checkmark").removeClass("visible").delay(500).queue(function(next) {
                    $(this).remove()
                    next()
                })
            }

            $(".reset").click(function() {
                $(".width, .height").text(5)
                width = 5
                height = 5
                updateGrid()
                resetGrid()
            })

            $(".reset-grid").click(function() {
                resetGrid()
            })

            $(".arrow-up").click(function() {
                height--
                updateGrid()
            })

            $(".arrow-down").click(function() {
                height++
                updateGrid()
            })

            $(".arrow-left").click(function() {
                width--
                updateGrid()
            })

            $(".arrow-right").click(function() {
                width++
                updateGrid()
            })
        })
    </script>
</head>
<body>
    <div id="ManualContent">
        <div class="section">
            <div class="page page-bg-01">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Coordinates</span>
                </div>
                <div class="page-content">
                    <img class="diagram" src="img/Component/Coordinates.svg">
                    <h2>On the Subject of a Coordinate Grid</h2>

                    <p class="flavour-text">Column first or row first?

                    <p>All information pertaining to how to interact with the module can be found in the original manual.

                    <p>To determine the size of the grid, find the clue that is represented in any
                        of the formats described in Table 1. The italicized letters in the table
                        stand in for a number on the module.

                    <p>To determine the illegal locations, first obtain a list of numbers as follows:
                    <ul>
                        <li>Put each digit in the serial number on the list.
                        <li>For each indicator in alphabetical order, put a number on the list as indicated by Table 2.
                            Add 1 to the number if the indicator is lit.
                        <li>Then, for each port in alphabetical order, put a number on the list as indicated by Table 3.
                        <li>Finally, put the number 2 on the list.
                    </ul>

                    <p>Now start with a blank grid of the size determined earlier. Mark off illegal cells as you go
                        through the list. Start in the top left corner and advance from cell to cell in scanline
                        order<span class='footnote-marker'>[1]</span>. If you reach the bottom right, wrap back to the
                        top left. For each number in the list, count that many unmarked cells ignoring cells
                        already marked off, then mark off the cell you land on. Move to the next unmarked cell
                        and then move on to the next number in the list.

                    <p>Finally, select the only legal grid location offered by the module. The locations may be
                        notated in any of the formats listed in Table 5. The module may also describe locations
                        using words such as “top”, “bottom”, “left”, “right”, “up”, “down”, “center”, “middle”,
                        cardinal directions or clockface directions.

                    <table class="input-grid">
                        <tr>
                            <td>Width</td>
                            <th class="width">5</th>
                            <td>Height</td>
                            <th class="height">5</th>
                        </tr>
                    </table>
                    <div style="margin-left: 50px; margin-bottom: 10px;">
                        <button class="arrow-left">←</button> <button class="arrow-right">→</button>
                    </div>
                    <div style="float: left; margin-right: 10px">
                        <button class="arrow-up" style="margin-top: 0px;">↑</button>
                        <br>
                        <button class="arrow-down">↓</button>
                    </div>
                    <table class="grid"></table>

                    <br>
                    <button class="reset-grid">Reset Grid</button>
                    <button class="reset">Reset</button>

                    <br>
                    <br>
                    <table>
                        <tr>
                            <th>Control</th>
                            <th>Action</th>
                        </tr>
                        <tr>
                            <td>Click</td>
                            <td>Mark a square as invalid</td>
                        </tr>
                        <tr>
                            <td>Right-Click</td>
                            <td>Mark a square as checked</td>
                        </tr>
                    </table>

                    <div class='footnotes'>
                        <p class='footnote'>
                            [1] Scanline order, also known as reading order, starts at the top-left, moves right across the row, and then continues likewise with each row from top to bottom.
                        <p class='footnote'>
                            [2] Cartesian order, also known as geometric order, starts at the bottom-left, moves right across the row, and then continues likewise with each row from bottom to top.
                        <p class='footnote'>
                            [3] Traditional Chinese reading order starts at the top-right, moves down the column, and then continues likewise with each column from right to left.
                    </div>
                </div>
                <div class="page-footer relative-footer">Page 1 of 2</div>
            </div>
            <div class="page page-bg-02">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Coordinates</span>
                </div>
                <div class="page-content">
                    <h4>Table 1</h4>
                    <table>
                        <tr><th>Format<th>How to interpret</tr>
                        <tr><th><var>x</var><td>The number <var>x</var> is a product of two primes. The grid’s width is the larger prime, the height the smaller.</tr>
                        <tr><th>(<var>x</var>)<td>Same as <var>x</var>, but width and height are swapped.</tr>
                        <tr><th><var>x</var>×<var>y</var><td><var>x</var> is the width, <var>y</var> the height of the grid.</tr>
                        <tr><th><var>x</var> by <var>y</var><td><var>x</var> is the height, <var>y</var> the width of the grid.</tr>
                        <tr><th><var>x</var>*<var>y</var><td><var>x</var> is the total size of the grid, <var>y</var> the height.</tr>
                        <tr><th><var>x</var> : <var>y</var><td><var>x</var> is the total size of the grid, <var>y</var> the width.</tr>
                    </table>

                    <div class='column column-1'>
                        <h4>Table 2</h4>
                        <table class='two-column-groups'>
                            <tr><th>BOB<td>5<th>FRQ<td>2<th>SIG<td>4</tr>
                            <tr><th>CAR<td>4<th>IND<td>0<th>SND<td>1</tr>
                            <tr><th>CLR<td>2<th>MSA<td>3<th>TRN<td>3</tr>
                            <tr><th>FRK<td>1<th>NSA<td>0</tr>
                        </table>
                    </div>

                    <div class='column column-2'>
                        <h4>Table 3</h4>
                        <table class='two-column-groups'>
                            <tr><th>DVI-D   <td>5<th>RJ-45     <td>3</tr>
                            <tr><th>Parallel<td>2<th>Serial    <td>1</tr>
                            <tr><th>PS/2    <td>0<th>Stereo RCA<td>4</tr>
                        </table>
                    </div>

                    <div class='column column-3'>
                        <h4>Table 4</h4>
                        <table class='two-column-groups'>
                            <tr><th>一<td>1<th>六<td>6</tr>
                            <tr><th>二<td>2<th>七<td>7</tr>
                            <tr><th>三<td>3<th>八<td>8</tr>
                            <tr><th>四<td>4<th>九<td>9</tr>
                            <tr><th>五<td>5<th>十<td>10</tr>
                        </table>
                    </div>

                    <h4>Table 5</h4>
                    <table class='coordinate-notations'>
                        <tr><th>[<var>x</var>,<var>y</var>]<td>Column, then row; top-left is [0,0].
                        <tr><th><var>letter</var> <var>number</var><td>Column, then row; top-left is A1.
                        <tr><th>&lt;<var>x</var>, <var>y</var>&gt;<td>Row, then column; top-left is &lt;0, 0&gt;.
                        <tr><th><var>x</var>, <var>y</var><td>Row, then column; top-left is 1, 1.
                        <tr><th>(<var>x</var>,<var>y</var>)<td>Column, then row; bottom-left is (0,0).
                        <tr><th><var>letter</var>-<var>number</var><td>Column, then row; bottom-left is A-1.
                        <tr><th>“<var>x</var>, <var>y</var>”<td>Row, then column; bottom-left is “0, 0”.
                        <tr><th><var>x</var>/<var>y</var><td>Row, then column; bottom-left is 1/1.
                        <tr><th>[<var>x</var>]<td>Cell number in scanline order<span class='footnote-marker'>[1]</span>; top-left is [0].
                        <tr><th><var>x</var>th<td>Cell number in scanline order<span class='footnote-marker'>[1]</span>; top-left is 1st.
                        <tr><th>#<var>x</var><td>Cell number in Cartesian order<span class='footnote-marker'>[2]</span>; bottom-left is #1.
                        <tr><th>四十七<td>Cell number in Chinese reading order<span class='footnote-marker'>[3]</span>; top-right is 一.
                            See Table 4 for Chinese numerals reference. The example shown here represents the number 47.
                    </table>
                </div>
                <div class="page-footer relative-footer">Page 2 of 2</div>
            </div>
        </div>
    </div>
</body>
</html>