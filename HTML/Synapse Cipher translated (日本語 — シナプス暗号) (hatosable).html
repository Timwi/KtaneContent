<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>シナプス暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .squeeze { 
            margin-bottom: auto; 
            margin-top: auto; 
        }
        table tr td { text-align: center }

        .noted { background-color: #0808; }
        .noting { background-color: #F008; }
        .start { background-color: #88F8; }
        .end { background-color: #00F8; }
        .blue { background-color: #0088; }

        .small { font-size: 14px; }
        .page-footer::before { content: 'ページ '; }
        .page-footer::after { content: '/6'; }

        .page.strip::before { background-image: linear-gradient(#2BB24C, #E90003, #305DF8, #FBF50B, #81FFD9) }

        .right { 
            float: right; 
            max-width: 90%;
        }
        .tryfix tr td { 
            width: 30px; 
            height: 30px; 
            padding: 0pt; 
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">シナプス暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Synapse Cipher.svg" class="diagram">
                <h2>モジュール詳細：シナプス暗号</h2>
                <p class="flavour-text">ふむ……。どうやらこれは非常に馴染み深いもののようだ。</p>
                <p>モジュールは、3つのディスプレーがあるウィンドウ、右側のページカウンター、前ページまたは次ページに移動するための2つの矢印ボタン、送信モードに入るためのボタンで構成されている。</p>
                <p>モジュールを解除するには、以下の4ステップを利用し単語を復号する。</p>
                <h3>ステップ1：重畳暗号</h3>
                <p>1ページ目の上のディスプレーにある暗号化された単語と、2ページ目の上のディスプレーにあるキーワードを取得する。キーワード中の重複する英字を、最初に出現したものを残したまま削除する。アルファベット全体の文字列を取得したら、キーワードに表示されている文字をすべて削除する。</p>
                <p>ポートの個数が素数の場合は、アルファベットをキーワードの末尾に置く。そうでない場合は、アルファベットをキーワードの先頭に置く。</p>
                <p>作成したアルファベット(C)、2ページ目の真ん中と下のディスプレーに表示されているキーワード(A, B)を使用し、暗号化された単語のX番目にある英字に対して以下の手順を実行する。</p>
                <ul>
                    <li>AのX番目の英字からスタートする。BのX番目の英字に到達するまでの移動回数を、必要であればループしながら数える。</li>
                    <li>X番目の暗号化された英字から、先程のステップと同じ方向に、必要であればループしながらその回数分移動し、CのX番目の復号された文字を得る。</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">1</div>
        </div>
        <div class="page page-bg-02 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">シナプス暗号</span>
            </div>
            <div class="page-content">
                <h3 class="centered">例：重畳暗号</h3>
                <p class="centered">ポートの個数は素数ではない</p>
                <p class="centered">ページ2の上のディスプレー：<b>DASHING</b></p>
                <p class="centered">ページ2の真ん中のディスプレー：<b>OBSESS</b></p>
                <p class="centered">ページ2の下のディスプレー：<b>KNOTTY</b></p>
                <p class="centered">暗号化された単語：<b>QUDMQA</b></p>
                <table class="small">
                    <tr>
                        <td>B</td><td>C</td><td>E</td><td>F</td><td>J</td><td class="noted">K</td><td>L</td><td class="end">M</td><td class="noting">O</td><td>P</td><td class="start">Q</td>
                        <td>R</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>D</td><td>A</td><td>S</td><td>H</td><td>I</td><td>N</td><td>G</td>
                    </tr>
                </table>
                <p class="centered">O -&gt; K, Q -&gt; M</p>
                <table class="small">
                    <tr>
                        <td class="noting">B</td><td>C</td><td>E</td><td>F</td><td>J</td><td>K</td><td>L</td><td>M</td><td>O</td><td>P</td><td>Q</td><td class="end">R</td><td>T</td>
                        <td class="start">U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>D</td><td>A</td><td>S</td><td>H</td><td>I</td><td class="noted">N</td><td>G</td>
                    </tr>
                </table>
                <p class="centered">B -&gt; N, U -&gt; R</p>
                <table class="small">
                    <tr>
                        <td>B</td><td>C</td><td>E</td><td>F</td><td>J</td><td>K</td><td class="end">L</td><td>M</td><td class="noted">O</td><td>P</td><td>Q</td><td>R</td><td>T</td>
                        <td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td class="start">D</td><td>A</td><td class="noting">S</td><td>H</td><td>I</td><td>N</td><td>G</td>
                    </tr>
                </table>
                <p class="centered">S -&gt; O, D -&gt; L</p>
                <table class="small">
                    <tr>
                        <td>B</td><td>C</td><td class="noting">E</td><td>F</td><td>J</td><td>K</td><td>L</td><td class="start">M</td><td>O</td><td>P</td><td>Q</td><td>R</td>
                        <td class="noted">T</td><td>U</td><td>V</td><td>W</td><td>X</td><td class="end">Y</td><td>Z</td><td>D</td><td>A</td><td>S</td><td>H</td><td>I</td><td>N</td><td>G</td>
                    </tr>
                </table>
                <p class="centered">E -&gt; T, M -&gt; Y</p>
                <table class="small">
                    <tr>
                        <td>B</td><td class="end">C</td><td>E</td><td>F</td><td>J</td><td>K</td><td>L</td><td>M</td><td>O</td><td>P</td><td class="start">Q</td><td>R</td><td class="noted">T</td>
                        <td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>D</td><td>A</td><td class="noting">S</td><td>H</td><td>I</td><td>N</td><td>G</td>
                    </tr>
                </table>
                <p class="centered">S -&gt; T, Q -&gt; C</p>
                <table class="small">
                    <tr>
                        <td>B</td><td>C</td><td>E</td><td>F</td><td>J</td><td>K</td><td>L</td><td>M</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>T</td><td>U</td><td>V</td><td>W</td>
                        <td class="end">X</td><td class="noted">Y</td><td>Z</td><td>D</td><td class="start">A</td><td class="noting">S</td><td>H</td><td>I</td><td>N</td><td>G</td>
                    </tr>
                </table>
                <p class="centered">S -&gt; Y, A -&gt; X</p>
                <p class="centered">復号された単語：<b>MRLYCX</b></p>
            </div>
            <div class="page-footer relative-footer">2</div>
        </div>
        <div class="page page-bg-03 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">シナプス暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ2：論理三進数演算暗号</h3>
                <p>ステップ1の結果を取得し、これらの英字をそれぞれアルファベットの位置に変換する(A1Z26)。これらの数字を三進数に変換し、ちょうど3桁にならない場合は先頭に0を追加する。</p>
                <p>次に、3ページに表示されているバイナリ文字列を取り出す。シリアルナンバーの最後の数字がシリアルナンバーの最初の数字と偶奇性が一致している場合、文字列の最初の3ビット同士をXORで演算し、最後の3ビット同士をXNORで演算する。そうでない場合、文字列の最初の3ビット同士をXNOR演算し、最後の3ビット同士をXOR演算する。</p>
                <p>結果を1つのバイナリ文字列に連結する。そのビットを使って、3桁の三進数にそれぞれ次のような調整を行う。</p>
                <ul>
                    <li>結果の二進数のX桁目が1の場合、X番目の三進数の各桁を1ずつ増加させ、2は0にループさせる。<b>桁の繰り上がりは行わないこと。</b></li>
                    <li>そうでない場合、その桁の調整は行わない。</li>
                </ul>
                <p>桁の増加が終わったら、000である三進数があれば、その三進数のすべての桁を再度1増加させる。</p>
                <p>この新しい三進数を十進数に戻し、アルファベット上の位置の数字を用いて英字に戻す。</p>
                <h3 class="centered">例：論理三項演算暗号</h3>
                <p class="centered squeeze">表示された二進数：<b>110001, 101110</b></p>
                <p class="centered squeeze">エッジワーク：シリアルナンバーの最初と最後の数字は偶奇性が一致していない。</p>
                <p class="centered">ステップ1完了後：<b>MRLYCX</b></p>
                <table>
                    <tr><th>M</th><th>R</th><th>L</th><th>Y</th><th>C</th><th>X</th></tr>
                    <tr><td>111</td><td>200</td><td>110</td><td>221</td><td>010</td><td>220</td></tr>
                </table>
                
                <p class="centered"><b>110 XOR 101 = 011, 001 XNOR 110 = 000</b> 連結後の二進数：<b>011000</b></p>
                <table>
                    <tr><th>0</th><th>1</th><th>1</th><th>0</th><th>0</th><th>0</th></tr>
                    <tr><td>111</td><td>200</td><td>110</td><td>221</td><td>010</td><td>220</td></tr>
                    <tr><td>111</td><td>011</td><td>221</td><td>221</td><td>010</td><td>220</td></tr>
                </table>
                <p class="centered">変換後の結果：MDYYCX</p>
                
            </div>
            <div class="page-footer relative-footer">3</div>
        </div>
        <div class="page page-bg-04 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">シナプス暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ3：双四角回転暗号</h3>
                <p>ページ4には、上から下の順に3つのキーワードがある。</p>
                <p>一つ目のキーワードから、すべての「J」を「I」に変え、重複する文字を削除する。次に、「J」と最初のキーワードの文字を除いたアルファベットを取得する。</p>
                <p>「エナ暗号(<span style="transform:scaleX(-1);display: inline-block;">E</span>NA Cipher)」が存在するか、シリアルナンバーを三十六進数とみなした際の各桁の和が奇数である場合、アルファベットを一つ目のキーワードの末尾に置く。それ以外の場合は、一つ目のキーワードの先頭に置く。</p>
                <p>二つ目のキーワードから、すべての「J」を「I」に変え、重複する文字を削除する。次に、「J」と最初のキーワードの文字を除いたアルファベットを取得する。</p>
                <p>「Holographic Memory」が存在するか、シリアルナンバーの数字の合計が偶数の場合、アルファベットを二つ目のキーワードの末尾に置く。それ以外の場合は、二つ目のキーワードの先頭に置く。</p>
                <p>2つの作成したキー文字列を、読み順で2つの5&times;5の正方形に配置する。三つ目のキーワード(A1Z26)の各英字のアルファベットの位置を求め、10で割った余りを求めておく。</p>
                <p>ステップ2から得られた文字の中に「J」があれば、同じ位置にある1ページ目の真ん中のディスプレーに表示されている英字に変える。このステップが完了したら、その英字を「J」に戻すこと。</p>
                <p>一つ目の正方形から始め、その後は2つの正方形を交互に切り替えつつ、先ほど得た各英字と数字を取得し、領域移動用の図を用いて、以下の手順を行う。</p>
                <table class="tryfix" style="float:right; margin-left: 20px; margin-bottom: 30px; margin-top: 30px;" >
                    <tr class="noted"><td></td><td></td><td></td><td></td><td></td></tr>
                    <tr><td class="noted"></td><td class="blue"></td><td class="blue"></td><td class="blue"></td><td class="noted"></td></tr>
                    <tr><td class="noted"></td><td class="blue"></td><td class="noting"></td><td class="blue"></td><td class="noted"></td></tr>
                    <tr><td class="noted"></td><td class="blue"></td><td class="blue"></td><td class="blue"></td><td class="noted"></td></tr>
                    <tr class="noted"><td></td><td></td><td></td><td></td><td></td></tr>
                </table>
                <ol>
                    <li>ステップ2の単語を取得し、保持している正方形からX番目の英字を探す。</li>
                    <li>得られた英字が正方形の中心にある場合、その英字を修正しない。そうでない場合は、その英字がある位置から時計回りにY回移動する。Yは3つ目のキーワードから取得したX番目の数字である。<br>これでX番目の復号された英字が得られる。</li>
                </ol>
                <b>すべての移動は、開始した英字と同じ領域内で行わなければならない。移動するときに領域を変えてはならない！<br>例：図の緑から青、青から赤、その逆などに進んではならない。</b>     
                    
            </div>
            <div class="page-footer relative-footer">4</div>
        </div>
        <div class="page page-bg-05 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">シナプス暗号</span>
            </div>
            <div class="page-content">
                <h3 class="centered">例：双四角回転暗号</h3>
                <p class="centered">ページ4の上のディスプレー：<b>DEVOTION</b></p>
                <p class="centered">ページ4の真ん中のディスプレー：<b>BUB</b></p>
                <p class="centered">ページ4の下のディスプレー：<b>HASSLE</b></p>
                <p class="centered">暗号化された単語：<b>MDYYCX</b></p>
                <p class="centered squeeze">作成した正方形</p>
                <table>
                    <tr>
                        <td class="corner">
                            <table>
                                <tr><td>A</td><td>B</td><td>C</td><td>F</td><td>G</td></tr>
                                <tr><td>H</td><td>K</td><td>L</td><td>M</td><td>P</td></tr>
                                <tr><td>Q</td><td>R</td><td>S</td><td>U</td><td>W</td></tr>
                                <tr><td>X</td><td>Y</td><td>Z</td><td>D</td><td>E</td></tr>
                                <tr><td>V</td><td>O</td><td>T</td><td>I</td><td>N</td></tr>
                            </table>
                        </td>
                        <td class="corner">
                            <table>
                                <tr><td>B</td><td>U</td><td>A</td><td>C</td><td>D</td></tr>
                                <tr><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td></tr>
                                <tr><td>K</td><td>L</td><td>M</td><td>N</td><td>O</td></tr>
                                <tr><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td></tr>
                                <tr><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <p class="centered">下のディスプレーの各英字をアルファベット上の位置の数字にし、10で割る：<b>8, 1, 9, 9, 2, 5</b></p>
                <p class="centered"><b>M, CW 8</b> -&gt; <b>M</b></p>
                <p class="centered"><b>D, CW 1</b> -&gt; <b>I</b></p>
                <p class="centered"><b>Y, CW 9</b> -&gt; <b>R</b></p>
                <p class="centered"><b>Y, CW 9</b> -&gt; <b>A</b></p>
                <p class="centered"><b>C, CW 2</b> -&gt; <b>G</b></p>
                <p class="centered"><b>X, CW 5</b> -&gt; <b>E</b></p>
                <p class="centered">復号された単語：<b>MIRAGE</b></p>
            </div>
            <div class="page-footer relative-footer">5</div>
        </div>
        <div class="page page-bg-06 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">シナプス暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ4：色による暗号化 & 送信</h3>
                <p>復号された単語を取得後、各英字をアルファベットの位置に変換し、4で割った余りに2を加えた後、シーケンス全体を反転させる。</p>
                <p>復号された単語中の各英字について、アルファベット上の位置の数字を、シーケンスの同じ位置に対応する数字を基数として先頭にゼロをつけずに変換する。得られた数列の各桁を、以下の表を使って色に変換する。</p>
                <table style="background-color: rgb(177, 175, 175)">
                    <tr><th>0</th><th style="color:#2BB24C">緑</th></tr>
                    <tr><th>1</th><th style="color:#E90003">赤</th></tr>
                    <tr><th>2</th><th style="color:#305DF8">青</th></tr>
                    <tr><th>3</th><th style="color:#FBF50B">黄</th></tr>
                    <tr><th>4</th><th style="color:#81FFD9">薄緑</th></tr>
                </table>
                <p>それが送信する回答である。</p>
                <p>下の真ん中にあるボタンをクリックすると、モジュールは送信モードになり、色を入力することができる。メインウインドウに戻りたい場合は、ウインドウ右上のXボタンをクリックする。</p>
                <p>入力中に間違いがあった場合は、バックスペース(左矢印)ボタンをクリックして直前の入力を削除することができる。回答を入力できたら、SUBMITをクリックして送信する。</p>
                <p>入力が正しければモジュールは解除され。そうでなければ、モジュールにはミスが記録され、入力はリセットし、メインウィンドウに戻される。メインウィンドウから得られる情報がリセットされることはない。</p>
            </div>
            <div class="page-footer relative-footer">6</div>
        </div>
    </div>
</body>
</html>