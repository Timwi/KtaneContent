<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Reformed Role Reversal — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        #showPDF {
            display: none
        }

        @media print {
            #showPDF {
                display: inline
            }

            #hidePDF {
                display: none
            }
        }

        div>input {
            transform: scale(2);
            text-align: center;
            background-color: #000
        }

        .red {
            background-color: #faa;
            border-color: #a00;
            color: #a00
        }

        .green {
            background-color: #afa;
            border-color: #0a0;
            color: #0a0
        }

        .navy {
            background-color: #99c;
            color: #004
        }

        .lapis {
            background-color: #abe;
            color: #134
        }

        .blue {
            background-color: #99f;
            color: #008
        }

        .sky {
            background-color: #cde;
            color: #467
        }

        .teal {
            background-color: #9cc;
            color: #044
        }

        .plum {
            background-color: #cac;
            color: #424
        }

        .violet {
            background-color: #cae;
            color: #417
        }

        .purple {
            background-color: #c9c;
            color: #404
        }

        .magenta {
            background-color: #f9f;
            color: #707
        }

        .lavender {
            background-color: #dbe;
            color: #436
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header"> <span class="page-header-doc-title">Keep Talking and Nobody Explodes
                    Mod</span> <span class="page-header-section-title">Reformed Role Reversal</span></div>
            <div class="page-content"> <img src="img/Component/Reformed Role Reversal.svg" class="diagram">
                <h2>Regarding Reformed Role Reversal</h2>
                <p class="flavour-text">References remain remotely removed. Report reforming rules remarkably
                    rigorously, remembering recherché regulations; refrain registering racks respecting ruthless
                    rockets round ripping reconditive ropes. Regulate reason rightfully, renowned reputation raised
                    regarding receptively repaired regions.</p>
                <p class="appendix-reference"> See Appendix A for indicator identification reference.<br> See
                    Appendix B for battery identification reference.<br> See Appendix C for port identification
                    reference.</p>
                <div id="hidePDF">
                    <table>
                        <tr>
                            <td style="text-align:center;"> Seed <span colspan="2"><input style="width: 106px"
                                        type="text" id="Seed" oninput="updateNumbers()"></span> in base <span
                                    colspan="2"><input style="width: 18px" type="text" id="BaseN"
                                        oninput="updateNumbers()"></span> is in base-10 <span colspan="2"><input
                                        style="width: 80px" type="text" id="Base10"
                                        oninput="updateBase10Length()"></span> and in modulo <span
                                    colspan="2"><input style="width: 9px" type="text" id="Mod"
                                        oninput="updateNumbers()"></span> [<span colspan="2"
                                    id="ModResult">?</span>].</td>
                        </tr>
                    </table>
                    <table>
                        <tr>
                            <th colspan="2">Lookup #<input style="width: 16px" type="text" id="Lookup"
                                    oninput="updateColors()"></th>
                        </tr>
                        <tr>
                            <th>Value</th>
                            <th>Color</th>
                            <th>Approximately</th>
                        </tr>
                        <tr>
                            <td id='colors-0'></td>
                            <td class="navy">Navy</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td id='colors-1'></td>
                            <td class="lapis">Lapis</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td id='colors-2'></td>
                            <td class="blue">Blue</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td id='colors-3'></td>
                            <td class="sky">Sky</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td id='colors-4'></td>
                            <td class="teal">Teal</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td id='colors-5'></td>
                            <td class="plum">Plum</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td id='colors-6'></td>
                            <td class="violet">Violet</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td id='colors-7'></td>
                            <td class="purple">Purple</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td id='colors-8'></td>
                            <td class="magenta">Magenta</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td id='colors-9'></td>
                            <td class="lavender">Lavender</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                    </table>
                </div>
                <div id="showPDF">
                    <table>
                        <tr>
                            <th colspan="10">Lookup #</th>
                        </tr>
                        <tr>
                            <th>0</th>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                            <th>4</th>
                            <th>5</th>
                            <th>6</th>
                            <th>7</th>
                            <th>8</th>
                            <th>9</th>
                        </tr>
                        <tr>
                            <th colspan="10">Value</th>
                            <th>Color</th>
                            <th>Approximately</th>
                        </tr>
                        <tr>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td class="navy">Navy</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td class="lapis">Lapis</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td class="blue">Blue</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td class="sky">Sky</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td class="teal">Teal</td>
                            <td class="blue">Blueish</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td class="plum">Plum</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td class="violet">Violet</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td class="purple">Purple</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td>1</td>
                            <td class="magenta">Magenta</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                            <td>0</td>
                            <td class="lavender">Lavender</td>
                            <td class="purple">Purpleish</td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
    </div>
    <script>
        const availableChars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
        const elementBase10 = document.getElementById('Base10');
        const elementBaseN = document.getElementById('BaseN');
        const elementLookup = document.getElementById('Lookup');
        const elementMod = document.getElementById('Mod');
        const elementModResult = document.getElementById('ModResult');
        const elementSeed = document.getElementById('Seed');
        const elementColors = [];
        for (let i = 0; i < 10; i++) { 
            elementColors.push(document.getElementById('colors-' + i));
            elementColors.lastIndexOf.innerHTML = '?';
        } 

        function updateColors() {
            const value = Number(elementLookup.value);
            const isValid = between(value, 0, 9);
            elementLookup.className = isValid ? 'green' : 'red';
            for (const [index, element] of elementColors.entries()) {
                element.innerHTML = isValid ? (index - value + elementColors.length) % elementColors.length : '?';
            }
        }

        function updateNumbers() {
            const value = Number(elementBaseN.value);
            const isBaseValid = between(value, 1, 62);
            const modulo = Number(elementMod.value);
            const isModValid = between(modulo, 1, 9);
            elementBaseN.className = isBaseValid ? 'green' : 'red';
            elementMod.className = isModValid ? 'green' : 'red';
            const validChars = availableChars.substring(0, value);
            let flag = true; const seed = elementSeed.value;
            if (seed.length > 7 || seed === null) flag = false;
            else {
                seed.split('').forEach(char => {
                    if (!validChars.includes(char)) {
                        flag = false; return; 
                    }
                });
            }
            elementSeed.className = flag ? 'green' : 'red';
            if (!isBaseValid || !flag) return;
            const convertedSeed = convertBase(seed, value);
            elementBase10.value = convertedSeed; updateBase10Length();
            elementModResult.innerHTML = isModValid ? convertedSeed % modulo : '?';
        } 

        function updateBase10Length() {
            elementBase10.className = elementBase10.value.length === 9 ? 'green' : 'red';
        }

        function between(x, min, max) {
            return x >= min && x <= max;
        }

        function convertBase(value, from_base) {
            const range = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/'.split('');
            const from_range = range.slice(0, from_base);
            let dec_value = value.split('').reverse().reduce(
                function (carry, digit, index) {
                    return carry += from_range.indexOf(digit) * (Math.pow(from_base, index));
                }, 0);
            let new_value = '';
            while (dec_value > 0) {
                new_value = '0123456789'[dec_value % 10] + new_value; dec_value = (dec_value - (dec_value % 10)) / 10;
            }
            return new_value || '0';
        }
    </script>
</body>
</html>