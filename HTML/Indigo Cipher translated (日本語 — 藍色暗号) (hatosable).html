<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>藍色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha { font-size: 13px; }
        .beta { font-size: 11px; }
        .tablea { font-size: 14px; }
        .tableb {
            font-size: 20px;
            width: 100%;
        }
        .dark img.morse-table { filter: invert(87%); }
        .morse-table {
            width: 70%;
            display: block;
            margin: .5em auto;
        }
        .hstack table { margin: 0px; }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">藍色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：藍色暗号</h2>
                <p class="flavour-text">バラは赤い。スミレは青い。そして藍色暗号はここにあり、あなたは絶望している。</p>
                <p>モジュール上には、3つのディスプレー、キーボード、2つの矢印、そして現在のページを表示する送信ボタンで構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに暗号化された鍵、下のディスプレーに単語が表示される。</p>
                <p>ページ2には、上と真ん中のディスプレーに6桁の二進数、下のディスプレーに論理演算子が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：分割モールス暗号</h3>
                <p>ページ1にある下のディスプレーの単語(キーワード)を取得し、以下のルールを使用して鍵に変換する。</p>
                <ul>
                    <li>キーワードから重複する英字を削除する(最初に出現している英字はそのままにする)。</li>
                    <li>アルファベット全体の文字列を取得し、キーワードに出現する英字を削除する。</li>
                    <li>ポートの数が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。</li>
                    <li>そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</li>
                </ul>
                <p>以下の文字列を下に配置して、鍵を獲得する。</p>
                <p class="centered">.........---------xxxxxxxx<br>
                    ...---xxx...---xxx...---xx<br>
                    .-x.-x.-x.-x.-x.-x.-x.-x.-
                </p>
                <p>ページ1の真ん中のディスプレーから暗号化された鍵を取得し、各文字に対して、その文字が含まれる列を上から下に読み3つの記号に変換する。</p>
                <p>変換した記号の文字列を左から右に読み、モールス信号に変換する。Xは文字間の空白を示す。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">藍色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">モールス信号表</h4>
                <img class="morse-table" src="img/Morse Code/morse-signals.svg">
                <p>全て完了したら、英単語にはならない6文字の論理鍵を手に入れられる。これはステップ3の論理暗号で使用する。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    下のディスプレー：WALLET ポートの数：偶数<br>
                    真ん中のディスプレー：BIFXDPSHMK<br>
                    鍵：BCDFGHIJKMNOPQRSUVXYZWALET
                </p>
                <table class = "alpha">
                    <tr><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>M</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>U</th><th>V</th><th>X</th><th>Y</th><th>Z</th><th>W</th><th>A</th><th>L</th><th>E</th><th>T</th></tr>
                    <tr><th>.</th><th>.</th><th>.</th><th>.</th><th>.</th><th>.</th><th>.</th><th>.</th><th>.</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>x</th><th>x</th><th>x</th><th>x</th><th>x</th><th>x</th><th>x</th><th>x</th></tr>
                    <tr><th>.</th><th>.</th><th>.</th><th>-</th><th>-</th><th>-</th><th>x</th><th>x</th><th>x</th><th>.</th><th>.</th><th>.</th><th>-</th><th>-</th><th>-</th><th>x</th><th>x</th><th>x</th><th>.</th><th>.</th><th>.</th><th>-</th><th>-</th><th>-</th><th>x</th><th>x</th></tr>
                    <tr><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th></tr>
                </table>
                <table>
                    <tr><th>B</th><th>I</th><th>F</th><th>X</th><th>D</th><th>P</th><th>S</th><th>H</th><th>M</th><th>K</th></tr>
                    <tr><th>.</th><th>.</th><th>.</th><th>x</th><th>.</th><th>-</th><th>-</th><th>.</th><th>-</th><th>.</th></tr>
                    <tr><th>.</th><th>x</th><th>-</th><th>.</th><th>.</th><th>-</th><th>x</th><th>-</th><th>.</th><th>x</th></tr>
                    <tr><th>.</th><th>.</th><th>.</th><th>.</th><th>x</th><th>.</th><th>.</th><th>x</th><th>.</th><th>x</th></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">ページ 2/6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">藍色暗号</span>
            </div>
            <div class="page-content">
                <p class="centered">. . . . x . . - . x . . . . x - - . - x . . - x - . . . x x ⇒ HFHQUB</p>

                <h3>ステップ2：コンディ暗号</h3>
                <p>ここでは、ステップ1で作成した鍵とページ1にある上のディスプレーの6文字の暗号化された単語を使用する。</p>
                <p>暗号化された鍵の下に、以下の2列を配置する。（ドット、ダッシュ、Xは今後使用しない）</p>
                <p class="centered">00000000011111111112222222<br>
                    12345678901234567890123456</p>
                <p>上段の数字を十の位、下段の数字を一の位として扱う。</p>
                <p>初期値は、シリアルナンバーの数字の合計を使用する。</p>
                <p>ページ1の上のディスプレーにあった暗号化された単語の各文字に対して、以下のステップに従う。</p>
                <ul>
                    <li>鍵の中からその文字を探す。</li>
                    <li>現在の値の数だけ、左に移動する。</li>
                    <li>到達した数字が新たな暗号化された文字である。</li>
                    <li>その文字と同じ列にある二桁の数字が、新たな値となる。</li>
                </ul>
                <p>これで新しい暗号化された単語ができ、この暗号の最後のステップに進む準備ができているはずだ。</p>

                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：UXKQAT<br>
                    鍵：BCDFGHIJKMNOPQRSUVXYZWALET<br>
                    初期値 = 25
                </p>
                <table class = "alpha">
                    <tr><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>M</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>U</th><th>V</th><th>X</th><th>Y</th><th>Z</th><th>W</th><th>A</th><th>L</th><th>E</th><th>T</th></tr>
                    <tr><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th></tr>
                    <tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr>
                </table>
                <p class="centered"> U - 25 ⇒ V, 18<br>
                    X - 18 ⇒ B, 01<br>
                    K - 01 ⇒ J, 08<br>
                    Q - 08 ⇒ H, 06<br>
                    A - 06 ⇒ U, 17<br>
                    T - 17 ⇒ K, 09<br>
                    新たな暗号化された単語：VBJHUK
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 3/6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">藍色暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ3：論理暗号</h3>
                <p>ステップ1の論理鍵とステップ2の新しい暗号化された単語を手に入れたら、ついに最後のステップに入る。</p>
                <p>
                    このステップでは、まずどの論理ゲートを使うかを考える。2ページ目の下のディスプレーにある数字を6桁の二進数に変換する。
                    そして、ディスプレーの左にある数字の桁から左のビット、真ん中の数字の桁から右のビットを取得し、3番目の数字の桁が出力ビットとなる論理ゲートを、次の表から調べる。各桁同士を比較して、全ての演算が正しくなるような論理ゲートが今回使用する論理ゲートである。
                </p>
                <table>
                    <tr><th>左の<br>ビット</th><th>右の<br>ビット</th><th>AND</th><th>OR</th><th>XOR</th><th>NAND</th><th>NOR</th><th>XNOR</th><th>→</th><th>&lt;-</th></tr>
                    <tr><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th></tr>
                    <tr><th>0</th><th>1</th><th>0</th><th>1</th><th>1</th><th>1</th><th>0</th><th>0</th><th>1</th><th>0</th></tr>
                    <tr><th>1</th><th>0</th><th>0</th><th>1</th><th>1</th><th>1</th><th>0</th><th>0</th><th>0</th><th>1</th></tr>
                    <tr><th>1</th><th>1</th><th>1</th><th>1</th><th>0</th><th>0</th><th>0</th><th>1</th><th>1</th><th>1</th></tr>
                </table>
                <p>暗号がどのゲートを使っているかを把握したら、暗号化された単語と論理鍵、そして2ページ目の上のディスプレーと真ん中のディスプレーにある2つの6桁の二進数を使い、以下の手順を実行する。</p>
                <ul>
                    <li>1：暗号化された単語の最初の文字をアルファベット上の位置から1を引いた数(A = 0, B = 1 ... Z = 25)に変換する。</li>
                    <li>2：その数字を5桁の二進数にする。</li>
                    <li>3：その文字と同じ位置にある上のディスプレーの二進数のビットが1の場合、手順2の二進数を反転させる。</li>
                    <li>4：論理鍵に対しても上記の3ステップを行う。また、上のディスプレーではなく真ん中のディスプレーを使用する。</li>
                    <li>5：2つの二進数の5ビットそれぞれについて、求めた論理演算を実行し結果のビットを取得する。最初に得た二進数を左のビット、2番目に得た二進数を右のビットとして扱う。</li>
                    <li>6：結果の二進数を、対応する英字(0 = A, 1 = B ... 25 = Z)に変換する。</li>
                    <li>7：これを暗号化された単語と論理鍵の各文字に対して行い、復号された単語を獲得する。</li>
                </ul>
                <p class="centered">
                    暗号化された単語：VBJHUK<br>
                    論理鍵：HFHQUB <br>
                    上のディスプレー：11011 <br>
                    真ん中のディスプレー：000101
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 4/6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">藍色暗号</span>
            </div>
            <div class="page-content">
                <p class="centered">
                    下のディスプレー：33 ? 60 = 34<br>
                    33 = 100001, 60 = 111100, 34 = 100010<br>
                    1 1 = 1,1 0 = 0,0 1 = 0,0 0 = 1 を満たす論理ゲートはXNOR<br>
                </p>
                <p class="centered">
                    V, H ⇒ 21, 07 ⇒ 10101, 00111 + 1, 0 ⇒ 01010 XNOR 00111 ⇒ 10010 ⇒ 18 ⇒ S
                </p>
                <p class="centered">
                    B, F ⇒ 01, 05 ⇒ 00001, 00101 + 1, 0 ⇒ 11110 XNOR 00101 ⇒ 00100 ⇒ 04 ⇒ E
                </p>
                <p class="centered">
                    J, H ⇒ 09, 07 ⇒ 01001, 00111 + 0, 0 ⇒ 01001 XNOR 00111 ⇒ 10001 ⇒ 17 ⇒ R
                </p>
                <p class="centered">
                    H, Q ⇒ 07, 16 ⇒ 00111, 10000 + 1, 1 ⇒ 11000 XNOR 01111 ⇒ 01000 ⇒ 08 ⇒ I
                </p>
                <p class="centered">
                    U, U ⇒ 20, 20 ⇒ 10100, 10100 + 1, 0 ⇒ 01011 XNOR 10100 ⇒ 00000 ⇒ 00 ⇒ A
                </p>
                <p class="centered">
                    K, B ⇒ 10, 01 ⇒ 01010, 00001 + 0, 1 ⇒ 01010 XNOR 11110 ⇒ 01011 ⇒ 11 ⇒ L
                </p>
                <p class="centered">
                    復号された単語：SERIAL
                </p>
                <p>十進数から二進数への相互変換方法が分からない場合、ページ6とページ7にある表を参照する。この表には0から63の数字に対して、5桁表記/6桁表記の二進数を示している。</p>
                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>

                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>

                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 5/6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">藍色暗号</span>
            </div>
            <div class="page-content">
                <div class="hstack gap3">
                    <table class = "alpha">
                        <tr><th>数字</th><th>六進数</th><th>五進数</th></tr>
                        <tr><th>0</th><th>000000</th><th>00000</th></tr>
                        <tr><th>1</th><th>000001</th><th>00001</th></tr>
                        <tr><th>2</th><th>000010</th><th>00010</th></tr>
                        <tr><th>3</th><th>000011</th><th>00011</th></tr>
                        <tr><th>4</th><th>000100</th><th>00100</th></tr>
                        <tr><th>5</th><th>000101</th><th>00101</th></tr>
                        <tr><th>6</th><th>000110</th><th>00110</th></tr>
                        <tr><th>7</th><th>000111</th><th>00111</th></tr>
                        <tr><th>8</th><th>001000</th><th>01000</th></tr>
                        <tr><th>9</th><th>001001</th><th>01001</th></tr>
                        <tr><th>10</th><th>001010</th><th>01010</th></tr>
                        <tr><th>11</th><th>001011</th><th>01011</th></tr>
                        <tr><th>12</th><th>001100</th><th>01100</th></tr>
                        <tr><th>13</th><th>001101</th><th>01101</th></tr>
                        <tr><th>14</th><th>001110</th><th>01110</th></tr>
                        <tr><th>15</th><th>001111</th><th>01111</th></tr>
                        <tr><th>16</th><th>010000</th><th>10000</th></tr>
                        <tr><th>17</th><th>010001</th><th>10001</th></tr>
                        <tr><th>18</th><th>010010</th><th>10010</th></tr>
                        <tr><th>19</th><th>010011</th><th>10011</th></tr>
                        <tr><th>20</th><th>010100</th><th>10100</th></tr>
                        <tr><th>21</th><th>010101</th><th>10101</th></tr>
                        <tr><th>22</th><th>010110</th><th>10110</th></tr>
                        <tr><th>23</th><th>010111</th><th>10111</th></tr>
                        <tr><th>24</th><th>011000</th><th>11000</th></tr>
                        <tr><th>25</th><th>011001</th><th>11001</th></tr>
                        <tr><th>26</th><th>011010</th><th>11010</th></tr>
                        <tr><th>27</th><th>011011</th><th>11011</th></tr>
                        <tr><th>28</th><th>011100</th><th>11100</th></tr>
                        <tr><th>29</th><th>011101</th><th>11101</th></tr>
                        <tr><th>30</th><th>011110</th><th>11110</th></tr>
                        <tr><th>31</th><th>011111</th><th>11111</th></tr>
                    </table>
                    <table class = "alpha">
                        <tr><th>数字</th><th>六進数</th></tr>
                        <tr><th>32</th><th>100000</th></tr>
                        <tr><th>33</th><th>100001</th></tr>
                        <tr><th>34</th><th>100010</th></tr>
                        <tr><th>35</th><th>100011</th></tr>
                        <tr><th>36</th><th>100100</th></tr>
                        <tr><th>37</th><th>100101</th></tr>
                        <tr><th>38</th><th>100110</th></tr>
                        <tr><th>39</th><th>100111</th></tr>
                        <tr><th>40</th><th>101000</th></tr>
                        <tr><th>41</th><th>101001</th></tr>
                        <tr><th>42</th><th>101010</th></tr>
                        <tr><th>43</th><th>101011</th></tr>
                        <tr><th>44</th><th>101100</th></tr>
                        <tr><th>45</th><th>101101</th></tr>
                        <tr><th>46</th><th>101110</th></tr>
                        <tr><th>47</th><th>101111</th></tr>
                        <tr><th>48</th><th>110000</th></tr>
                        <tr><th>49</th><th>110001</th></tr>
                        <tr><th>50</th><th>110010</th></tr>
                        <tr><th>51</th><th>110011</th></tr>
                        <tr><th>52</th><th>110100</th></tr>
                        <tr><th>53</th><th>110101</th></tr>
                        <tr><th>54</th><th>110110</th></tr>
                        <tr><th>55</th><th>110111</th></tr>
                        <tr><th>56</th><th>111000</th></tr>
                        <tr><th>57</th><th>111001</th></tr>
                        <tr><th>58</th><th>111010</th></tr>
                        <tr><th>59</th><th>111011</th></tr>
                        <tr><th>60</th><th>111100</th></tr>
                        <tr><th>61</th><th>111101</th></tr>
                        <tr><th>62</th><th>111110</th></tr>
                        <tr><th>63</th><th>111111</th></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">ページ 6/6</div>
        </div>
    </div>
</body>
</html>