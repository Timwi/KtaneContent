<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Inverted Crimson Cipher — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .nw {
            white-space: nowrap;
        }
        td.f, th.f, tr.f > td, tr.f > th {
            border: none;
        }
        table.big {
            margin-top: 0;
        }
        table.big svg {
            display: block;
        }
        table.big tr:not(.f) td:not(.f), table.big tr:not(.f) th:not(.f) {
            width: 1cm;
            height: 1cm;
            box-sizing: border-box;
            padding: 0;
            text-align: center;
        }
        span.p {
            display: inline-block;
            width:  .6cm;
            height: .6cm;
            background-repeat: no-repeat;
            background-size: cover;
            vertical-align: middle;
        }
        table.big span.p { display: block; margin: 0 auto; }

        span.p11 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p21 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p31 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p41 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p12 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p22 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p32 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p42 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="none"/></svg>'); }
        span.p13 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p23 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p33 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p43 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="none"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p14 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p24 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="none"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p34 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="none"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
        span.p44 { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" stroke="black" stroke-width=".05" viewBox="-.5 -.5 2 2"><circle r=".3" fill="black"/><circle cx="1" r=".3" fill="black"/><circle cy="1" r=".3" fill="black"/><circle cx="1" cy="1" r=".3" fill="black"/></svg>'); }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Inverted Crimson Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>On the Subject of The Inverted Crimson Cipher</h2>
                <p class="flavour-text">Confusion will be my epitaph...</p>
                <p>On the module, you will see 3 screens, a keyboard, 2 arrows, and a submit button that displays the current page you’re on.</p>
                <p>Pressing the right arrow takes you to the next page. Pressing the left arrow takes you to the previous page. There are a total of 3 pages.</p>
                <h3>Step 1: Caesar Shuffle Cipher</h3>
                <p>This step requires the encrypted word from step 2 and the two five-letter keywords from page 3. Reverse both keywords.</p>
                <p>Perform the following steps for each letter of both keywords:</p>
                <ul>
                    <li>Place a pivot after the Xth letter in the encrypted word where X is equal to 5, minus the current letter of the first key’s alphabetic position modulo 5. Swap the 2 strings to the left and right of the pivot.</li>
                    <li>Shift the now-right substring backwards in the alphabet by the current letter of the second key. Remove the pivot.</li>
                </ul>
                <h4 class="centered">Example</h4>
                <p class="centered">Encrypted Word: NBDXQG<br>Keyword 1: ULCER -> RECLU<br>Keyword 2: KNOBS -> SBONK</p>
                <p class="centered">NB.DXQG -> DXQG.NB -> DXQG.UI -> DXQGUI</p>
                <p class="centered">DXQGU.I -> I.DXQGU -> I.BVOES -> IBVOES</p>
                <p class="centered">IB.VOES -> VOES.IB -> VOES.TM -> VOESTM</p>
                <p class="centered">VOE.STM -> STM.VOE -> STM.HAQ -> STMHAQ</p>
                <p class="centered">STMH.AQ -> AQ.STMH -> AQ.HIBW -> AQHIBW</p>
                <p class="centered">New Encrypted Word: AQHIBW</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 6</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Inverted Crimson Cipher</span>
            </div>
            <div class="page-content">
                <h3>Step 2: Dual Triplex Reflector Cipher</h3>
                <p>This step requires the three keywords on page 2, as well as the first encrypted word. The first two keywords will be used to construct two triplex reflectors, while the third will be used to shuffle the reflectors after each encryption step.</p>
                <p>To construct a triplex reflector, make a string by concatenating the alphabet with the keyword used, removing duplicates, and lay the string out in a 3×9 grid with a hole in the center. The triplex reflector made from the first keyword is the top reflector, and the one made from the second is the bottom reflector.</p>
                <p>For each letter of the encrypted word, find it in the bottom reflector, then find the letter in the same position in the top reflector, which is your first intermediate letter. Find that letter in the bottom reflector, then find the letter in that position in the top reflector. Find that letter in the bottom reflector, which is your second intermediate letter, then find the corresponding letter in the decrypted word in the same position in the top reflector.</p>
                <p>Note down the columns and rows you found the intermediate letters in, bearing in mind that the first intermediate letter was found in the top reflector and the second found in the bottom reflector. Before decrypting the next letter, permute both reflectors as follows.</p>
                <ul>
                    <li>Convert the alphabetic position of the current letter of the third key into ternary.</li>
                    <li>If you are at an odd step, shift the row the second intermediate letter was found in to the left by the two most significant digits taken as a ternary number, and shift the column the first intermediate letter was found in down by the least significant digit.</li>
                    <li>If you are at an even step, shift the column the second intermediate letter was found in down by the most significant digit, and the row the first intermediate letter was found in to the left by the two least significant digits taken as a ternary number.</li>
                    <li>Do not move the hole when shifting the reflectors.</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 2 of 6</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Inverted Crimson Cipher</span>
            </div>
            <div class="page-content">
                <h4 class="centered">Example</h4>
                <p class="centered">Encrypted Word: AQHIBW<br>Keyword 3: LOCUS</p>
                <table>
                    <tr><td>A</td><td>L</td><td>G</td><td>E</td><td>B</td><td>C</td><td>D</td><td>F</td><td>H</td></tr>
                    <tr><td>I</td><td>J</td><td>K</td><td>M</td><td> </td><td>N</td><td>O</td><td>P</td><td>Q</td></tr>
                    <tr><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr>
                    <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    <tr><td>R</td><td>E</td><td>S</td><td>I</td><td>G</td><td>N</td><td>D</td><td>A</td><td>B</td></tr>
                    <tr><td>C</td><td>F</td><td>H</td><td>J</td><td> </td><td>K</td><td>L</td><td>M</td><td>O</td></tr>
                    <tr><td>P</td><td>Q</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr>
                </table>
                <p class="centered">A -> F -> J -> M<br>L -> 12 -> 110</p>
                <table>
                    <tr><td>A</td><td>L</td><td>G</td><td>E</td><td>B</td><td>C</td><td>D</td><td>F</td><td>H</td></tr>
                    <tr><td>I</td><td>J</td><td>K</td><td>M</td><td> </td><td>N</td><td>O</td><td>P</td><td>Q</td></tr>
                    <tr><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr>
                    <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    <tr><td>R</td><td>E</td><td>S</td><td>I</td><td>G</td><td>N</td><td>D</td><td>A</td><td>B</td></tr>
                    <tr><td>K</td><td>L</td><td>M</td><td>O</td><td> </td><td>C</td><td>F</td><td>H</td><td>J</td></tr>
                    <tr><td>P</td><td>Q</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr>
                </table>
                <p class="centered">Q -> S -> G -> B<br>O -> 15 -> 120</p>
                <table>
                    <tr><td>A</td><td>L</td><td>G</td><td>E</td><td>B</td><td>C</td><td>D</td><td>F</td><td>H</td></tr>
                    <tr><td>I</td><td>J</td><td>K</td><td>M</td><td> </td><td>N</td><td>O</td><td>P</td><td>Q</td></tr>
                    <tr><td>X</td><td>Y</td><td>Z</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td></tr>
                    <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    <tr><td>R</td><td>E</td><td>S</td><td>I</td><td>V</td><td>N</td><td>D</td><td>A</td><td>B</td></tr>
                    <tr><td>K</td><td>L</td><td>M</td><td>O</td><td> </td><td>C</td><td>F</td><td>H</td><td>J</td></tr>
                    <tr><td>P</td><td>Q</td><td>T</td><td>U</td><td>G</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 3 of 6</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Inverted Crimson Cipher</span>
            </div>
            <div class="page-content">
                <p class="centered">H -> P -> X -> U<br>C -> 3 -> 010</p>
                <table>
                    <tr><td>A</td><td>L</td><td>G</td><td>E</td><td>B</td><td>C</td><td>D</td><td>F</td><td>H</td></tr>
                    <tr><td>I</td><td>J</td><td>K</td><td>M</td><td> </td><td>N</td><td>O</td><td>P</td><td>Q</td></tr>
                    <tr><td>X</td><td>Y</td><td>Z</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td></tr>
                    <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    <tr><td>R</td><td>E</td><td>S</td><td>I</td><td>V</td><td>N</td><td>D</td><td>A</td><td>B</td></tr>
                    <tr><td>K</td><td>L</td><td>M</td><td>O</td><td> </td><td>C</td><td>F</td><td>H</td><td>J</td></tr>
                    <tr><td>Q</td><td>T</td><td>U</td><td>G</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>P</td></tr>
                </table>
                <p class="centered">I -> E -> L -> J<br>U -> 21 -> 210</p>
                <table>
                    <tr><td>E</td><td>B</td><td>C</td><td>D</td><td>F</td><td>H</td><td>A</td><td>L</td><td>G</td></tr>
                    <tr><td>I</td><td>J</td><td>K</td><td>M</td><td> </td><td>N</td><td>O</td><td>P</td><td>Q</td></tr>
                    <tr><td>X</td><td>Y</td><td>Z</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td></tr>
                    <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    <tr><td>R</td><td>L</td><td>S</td><td>I</td><td>V</td><td>N</td><td>D</td><td>A</td><td>B</td></tr>
                    <tr><td>K</td><td>T</td><td>M</td><td>O</td><td> </td><td>C</td><td>F</td><td>H</td><td>J</td></tr>
                    <tr><td>Q</td><td>E</td><td>U</td><td>G</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>P</td></tr>
                </table>
                <p class="centered">B -> G -> R -> E<br>S -> 19 -> 201</p>
                <table>
                    <tr><td>E</td><td>B</td><td>C</td><td>D</td><td>F</td><td>H</td><td>A</td><td>L</td><td>W</td></tr>
                    <tr><td>I</td><td>J</td><td>K</td><td>M</td><td> </td><td>N</td><td>O</td><td>P</td><td>G</td></tr>
                    <tr><td>X</td><td>Y</td><td>Z</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>Q</td></tr>
                    <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    <tr><td>D</td><td>A</td><td>B</td><td>R</td><td>L</td><td>S</td><td>I</td><td>V</td><td>N</td></tr>
                    <tr><td>K</td><td>T</td><td>M</td><td>O</td><td> </td><td>C</td><td>F</td><td>H</td><td>J</td></tr>
                    <tr><td>Q</td><td>E</td><td>U</td><td>G</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>P</td></tr>
                </table>
                <p class="centered">W -> S -> H -> P</p>
            </div>
            <div class="page-footer relative-footer">Page 4 of 6</div>
        </div>
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Inverted Crimson Cipher</span>
            </div>
            <div class="page-content">
                <h3>Step 3: Transposed Halved Polybius Cipher</h3>
                <p>This step uses the encrypted word as well as the two keys on page 1; known as the fractionation key and the transposition key respectively.</p>
                <p>To begin, take the fractionation key and enter it into the left half of the Halved Polybius Square in reading order, removing duplicates. Add the rest of the alphabet letter by letter, moving to the right half after running out of letters. The Halved Polybius Square is laid out like the diagram below.</p>
                <div style='display: flex; justify-content: space-around; gap: 2cm'>
                    <table class = "big">
                        <tr class='f'><td></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr>
                        <tr><td class = 'f'>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                        <tr><td class = 'f'>2</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                        <tr><td class = 'f'>3</td><td></td><td></td><td></td><td>#</td><td>#</td><td></td><td></td><td></td><td>#</td><td>#</td></tr>
                        <tr><td class = 'f'></td><td colspan =  5>L</td><td colspan =  5>R</td></tr>
                    </table>
                </div>
                <p>Convert each letter of the encrypted word into three coordinates and write them out top to bottom in the order Half, Row, Column and to the right of any previous coordinates.</p>
                <p>Then, for each letter in reverse order of the transposition key, find it in the Halved Polybius Square and perform the following operation on the 6×3 matrix of coordinates you created.</p>
                <ul>
                    <li>If you are at an odd step in the process, shift the row of that letter’s coordinate in the matrix to the right by the column coordinate.</li>
                    <li>If you are at an even step, start at the column of the matrix equal to the current key letter’s column coordinate, then continue counting columns to the right equal to the row coordinate, wrapping around if necessary. Swap the two columns received by this procedure.</li>
                    <li>When doing this, do not move threes in the second row and fours and fives in the third row.</li>
                </ul>
                <p>Read off each column of the resulting matrix and index into the Halved Polybius Square to obtain your decrypted word.</p>
            </div>
            <div class="page-footer relative-footer">Page 5 of 6</div>
        </div>
        <div class="page page-bg-06">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Inverted Crimson Cipher</span>
            </div>
            <div class="page-content">
                <h4 class="centered">Example</h4>
                <p class="centered">Encrypted Word: MBUJEP<br>Transposition Key: STYLE</p>
                <div style='display: flex; justify-content: space-around; gap: 2cm'>
                    <table class = "big">
                        <tr class='f'><td></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr>
                        <tr><td class = 'f'>1</td><td>M</td><td>A</td><td>X</td><td>I</td><td>B</td><td>L</td><td>N</td><td>O</td><td>P</td><td>Q</td></tr>
                        <tr><td class = 'f'>2</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td></tr>
                        <tr><td class = 'f'>3</td><td>H</td><td>J</td><td>K</td><td>#</td><td>#</td><td>W</td><td>Y</td><td>Z</td><td>#</td><td>#</td></tr>
                        <tr><td class = 'f'></td><td colspan =  5>L</td><td colspan =  5>R</td></tr>
                    </table>
                </div>
                <table>
                    <tr><td>LLRLLR<br>112321<br>154234</td><td>LLRLLR<br>221311<br>154234</td><td>LLRLLR<br>221311<br>514234</td><td>LLRLLR<br>221311<br>524314</td><td>LLLLRR<br>221311<br>521344</td><td>LLLLRR<br>112321<br>521344</td></tr>
                </table>
                <p class="centered">Decrypted Word: BACKUP</p>
                <p>Once completed, the result is your decrypted word, which you can now submit. Once you start typing, all the screens will go black and the bottom screen will show what you are typing.</p>
                <p>To clear it, just click one of the arrows. This goes to one of the pages and clears any input you put in. It will not let you go over 6 letters on input. </p>
                <p>Once you are satisfied with your input, press the button labeled "SUB" to submit your answer. On a strike, the module will go back to the first page of the module, but it does not regenerate.</p>
            </div>
            <div class="page-footer relative-footer">Page 6 of 6</div>
        </div>
    </div>
</body>
</html>