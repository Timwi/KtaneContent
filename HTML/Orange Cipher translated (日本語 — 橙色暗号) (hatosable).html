<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>橙色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        td, th { padding: .1em .4em 0 }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橙色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：橙色暗号</h2>
                <p class="flavour-text">橙色、それは私を元気にしてくれる。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>
                    ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに6文字の文字列、下のディスプレーには暗号化された文字列が表示される。
                    暗号化された単語に「J」が含まれている場合、同じ位置にある真ん中のディスプレーの文字に置き換える。3ステップ完了後、その文字を再び「J」に戻す。
                </p>
                <p>ページ2には、上のディスプレーに別の暗号化された文字列、真ん中のディスプレーに単語、下のディスプレーには数字が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：コロン暗号</h3>
                <p>まず、5×5の行列を作成する必要がある。</p>
                <p>ページ2の真ん中のディスプレーからキーワードを取得し、Jがある場合はそれをIに変換し、重複する英字の2文字目以降を削除する。</p>
                <p>アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの最後の数字が偶数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。これを行列Aと呼ぶ。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/6</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橙色暗号</span>
            </div>
            <div class="page-content">
                <p>ページ1の下のディスプレーにある単語とページ2の上のディスプレーにある暗号化された文字列を連結する。</p>
                <p>暗号化された文字列を2つずつのペアに分割し、各ペアについて以下の手順を実行する。</p>
                <ul>
                    <li>行列Aから1番目の英字を探し、その段を取得する。</li>
                    <li>行列Aから2番目の英字を探し、その列を取得する。</li>
                    <li>2つの英字の交点が、復号された英字となる。</li>
                </ul>
                <p>出来上がった文字が、ステップ3で使用するキーワードとなる。文字「J」が無いため、本来はJであった場所に「I」が含まれている可能性があることに注意する。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    ページ1の下のディスプレー: XFDFCTCGAL<br>ページ2の真ん中のディスプレー：MUSCLAR<br>
                    シリアルナンバーの最後の数字：3<br>
                    配置前行列A：MUSCLARBDEFGHIKNOPQTVWXYZ<br>
                </p>
                <table>
                    <tr><th>M</th><th>U</th><th>S</th><th>C</th><th>L</th></tr>
                    <tr><th>A</th><th>R</th><th>B</th><th>D</th><th>E</th></tr>
                    <tr><th>F</th><th>G</th><th>H</th><th>I</th><th>K</th></tr>
                    <tr><th>N</th><th>O</th><th>P</th><th>Q</th><th>T</th></tr>
                    <tr><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                </table>
                <p class="centered">
                    XF -> V<br>
                    DF -> A<br>
                    CT -> L<br>
                    CG -> U<br>
                    AL -> E<br>
                    復号された単語：VALUE
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 2/6</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橙色暗号</span>
            </div>
            <div class="page-content">

                <h3>ステップ2：バズリー暗号</h3>
                <p>ここでは、2つの行列を作成する必要がある。最初の行列は行列Bと呼ばれ、既に以下の通り作成されている。</p>
                <table>
                    <tr><th>A</th><th>F</th><th>L</th><th>Q</th><th>V</th></tr>
                    <tr><th>B</th><th>G</th><th>M</th><th>R</th><th>W</th></tr>
                    <tr><th>C</th><th>H</th><th>N</th><th>S</th><th>X</th></tr>
                    <tr><th>D</th><th>I</th><th>O</th><th>T</th><th>Y</th></tr>
                    <tr><th>E</th><th>K</th><th>P</th><th>U</th><th>Z</th></tr>
                </table>
                <p>最初の行列は行列Cと呼ばれ、ページ2の下のディスプレーにある4桁の数字を使用して作成される。</p>
                <p>数字の各桁を単語の形式に変換する(例：3097 → THREE ZERO NINE SEVEN)。これが行列Cで使うキーワードになる。</p>
                <p>Jがある場合はそれをIに変換し、全ての空白と重複する英字の2文字目以降を削除する。アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの二番目の数字が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。これを行列Cと呼ぶ。</p>
                <p>ページ1の上のディスプレーにある単語に対して、X文字ずつのグループに分割する。Xはページ2の下のディスプレーにある数字の各桁の合計を4で割った余りに2を加えた数である。</p>
                <p>各グループそれぞれに対して、文字を反転させ、元の位置に戻す。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    ページ2の下のディスプレー：3097 ページ1の上のディスプレー：DGPGKF<br>
                    3 + 0 + 9 + 7 = 19 % 4 = 3 + 2 = 5<br>
                    DGPGKF => DGPGK F => KGPGD F => KGPGDF
                </p>

            </div>
            <div class="page-footer relative-footer">ページ 3/6</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橙色暗号</span>
            </div>
            <div class="page-content">
                <p>各英字を行列Cの中から探し、それと同じ段/列を行列Bの中から探して、新たな英字を得る。</p>
                <p>結果の英字が、新たな暗号化された単語を綴る。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：KGPGDF 4桁の数字：3097<br>
                    シリアルナンバーの二番目の数字：2<br>
                    鍵B：AFLQVBGMRWCHNSXDIOTYEKPUZ<br>
                    鍵C：ABCDFGKLMPQUWXYTHREZONISV
                </p>
                <table>
                    <tr><th>A</th><th>F</th><th>L</th><th>Q</th><th>V</th><th>|</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th></tr>
                    <tr><th>B</th><th>G</th><th>M</th><th>R</th><th>W</th><th>|</th><th>G</th><th>K</th><th>L</th><th>M</th><th>P</th></tr>
                    <tr><th>C</th><th>H</th><th>N</th><th>S</th><th>X</th><th>|</th><th>Q</th><th>U</th><th>W</th><th>X</th><th>Y</th></tr>
                    <tr><th>D</th><th>I</th><th>O</th><th>T</th><th>Y</th><th>|</th><th>T</th><th>H</th><th>R</th><th>E</th><th>Z</th></tr>
                    <tr><th>E</th><th>K</th><th>P</th><th>U</th><th>Z</th><th>|</th><th>O</th><th>N</th><th>I</th><th>S</th><th>V</th></tr>
                </table>
                <p class="centered">
                    K -> G<br>
                    G -> B<br>
                    P -> W<br>
                    G -> B<br>
                    D -> Q<br>
                    F -> V<br>
                    新たな暗号化された単語：GBWBQV
                </p>
                <h3>ステップ3：フォースクエア暗号</h3>
                <p>ステップ名の通り、4つの行列が必要となる。ここでは、ステップ1、2で使用した行列A、B、Cをここでも使用する。行列Dは、ステップ1で得たキーワードを使って作成する。</p>
                <p>Jがある場合はそれをIに変換し、全ての空白と重複する英字の2文字目以降を削除する。アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの最初の数字が偶数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。これを行列Dと呼ぶ。</p>
            </div>
            <div class="page-footer relative-footer">ページ 4/6</div>
        </div>
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橙色暗号</span>
            </div>
            <div class="page-content">
                <p>4つの行列を取得し、以下のように2×2のグリッド上に配置する。</p>
                <p class="centered">
                    A | B<br>
                    ---<br>
                    C | D<br>
                </p>
                <p>ステップ2で獲得した暗号化された単語を2文字ずつのペアに分割する。各ペアに対して、以下の処理を行う。</p>
                <ul>
                    <li>一番目の文字を行列Bから見つけ、二番目の文字を行列Cから見つける。</li>
                    <li>一番目の文字がある行と二番目の文字がある列を行列Aから見つけ、一番目の復号された英字を獲得する。</li>
                    <li>一番目の文字がある列と二番目の文字がある行を行列Dから見つけ、二番目の復号された英字を獲得する。</li>
                </ul>
                <p>最初Jだった文字はJに置き換えることで、解読された単語になることを忘れないようにすること。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：GBWBQV<br>
                    シリアルナンバーの最初の数字：2<br>
                    鍵A：MUSCLARBDEFGHIKNOPQTVWXYZ<br>
                    鍵B：AFLQVBGMRWCHNSXDIOTYEKPUZ<br>
                    鍵C：ABCDFGKLMPQUWXYTHREZONISV<br>
                    鍵D：VALUEBCDFGHIKMNOPQRSTWXYZ
                </p>
                <table>
                    <tr><th>M</th><th>U</th><th>S</th><th>C</th><th>L</th><th>|</th><th>A</th><th>F</th><th>L</th><th>Q</th><th>V</th></tr>
                    <tr><th>A</th><th>R</th><th>B</th><th>D</th><th>E</th><th>|</th><th>B</th><th>G</th><th>M</th><th>R</th><th>W</th></tr>
                    <tr><th>F</th><th>G</th><th>H</th><th>I</th><th>K</th><th>|</th><th>C</th><th>H</th><th>N</th><th>S</th><th>X</th></tr>
                    <tr><th>N</th><th>O</th><th>P</th><th>Q</th><th>T</th><th>|</th><th>D</th><th>I</th><th>O</th><th>T</th><th>Y</th></tr>
                    <tr><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>|</th><th>E</th><th>K</th><th>P</th><th>U</th><th>Z</th></tr>
                    <tr><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>+</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th></tr>
                    <tr><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>|</th><th>V</th><th>A</th><th>L</th><th>U</th><th>E</th></tr>
                    <tr><th>G</th><th>K</th><th>L</th><th>M</th><th>P</th><th>|</th><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th></tr>
                    <tr><th>Q</th><th>U</th><th>W</th><th>X</th><th>Y</th><th>|</th><th>H</th><th>I</th><th>K</th><th>M</th><th>N</th></tr>
                    <tr><th>T</th><th>H</th><th>R</th><th>E</th><th>Z</th><th>|</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th></tr>
                    <tr><th>O</th><th>N</th><th>I</th><th>S</th><th>V</th><th>|</th><th>T</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                </table>
                <p class="centered">
                    GB -> RA<br>
                    WB -> RE<br>
                    QV -> LY<br>
                    復号された単語：RARELY
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 5/6</div>
        </div>
        <div class="page page-bg-06">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橙色暗号</span>
            </div>
            <div class="page-content">
                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 6/6</div>
        </div>
    </div>
</body>
</html>