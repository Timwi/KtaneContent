<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Variety CM — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Variety CM</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Cipher Machine.svg" class="diagram">
                <h2>On the Subject of the Variety CM</h2>
                <p class="flavour-text">A machine that knows no bounds when it comes to ciphers.</p>

                <p>Concatenate the digits displayed on the four large screens, in order, into a single number. Decoding this number involves an iterative process. In each iteration, a number <var>n</var> is relevant. Perform these calculations:</p>

                <ul>
                    <li>Take the number <em>modulo</em> <var>n</var> to obtain a value.</li>
                    <li><em>Divide</em> the number by <var>n</var> (rounding down) to obtain the number for the next iteration.</li>
                </ul>

                <p>First, apply the iteration with <var>n</var> equal to the number of letters in your encrypted word. The value obtained identifies which letter to decode, numbered from 0.</p>

                <p>Next, apply the iteration with <var>n</var> = 3 and perform the following decoding depending on the number obtained:</p>

                <ul>
                    <li><strong>0: Atbash.</strong> Turn the letter into its alphabetic position (A = 1, B = 2...Z = 26). Then take 27 minus the number to get a new number. Convert the number back to obtain the decrypted letter.</li>
                    <li><strong>1: Caesar.</strong> Apply the iteration once more, this time with <var>n</var> = 25. Add 1 to the obtained value. Add this to the alphabetic position of the encrypted letter. If the resulting number is above 26, subtract 26 from it. Then convert the number back to obtain the decrypted letter.</li>
                    <li><strong>2: Affine.</strong> Apply the iteration once more, this time with <var>n</var> = 12. Obtain a multiplier using the below table. Multiply the alphabetic position of the encrypted letter with this multiplier. If the resulting number is above 26, repeatedly subtract 26 from it until it is in range. Then convert the number back to obtain the decrypted letter.
                    <table>
                        <tr><th>Obtained value</th>
                        <td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td></tr>
                        <tr><th>Multiplier</th><td>1</td><td>3</td><td>5</td><td>7</td><td>9</td><td>11</td><td>15</td><td>17</td><td>19</td><td>21</td><td>23</td><td>25</td></tr>
                    </table>
                    </li>
                </ul>

                <p>Afterwards, remove the letter from the encrypted word. Continue this process, each time with the reduced set of remaining letters.</p>
                <p>The decrypted letters, in the other in which you decrypted them, form the decrypted word.</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Variety CM</span>
            </div>
            <div class="page-content">
                <h4 class="centered">Example</h4>
                <p class="centered">Encrypted word: ILFO</p>
                <p class="centered">Number = 327568</p>
                <p class="centered">327568 % 4 = 0 (I)<br>
                327568 / 4 = 81892<br>
                81892 % 3 = 1 (Caesar)<br>
                81892 / 3 = 27297<br>
                27297 % 25 = 22<br>
                27297 / 25 = 1091<br>
                Caesar by 23: I → F<br>
                1091 % 3 = 2 (O)<br>
                1091 / 3 = 363<br>
                363 % 3 = 0 (Atbash)<br>
                363 / 3 = 121<br>
                Atbash: O → L<br>
                121 % 2 = 1 (F)<br>
                121 / 2 = 60<br>
                60 % 3 = 0 (Atbash)<br>
                60 / 3 = 20<br>
                Atbash: F → U<br>
                20 % 1 = 0 (L)<br>
                20 / 1 = 20<br>
                20 % 3 = 2 (Affine)<br>
                20 / 3 = 6<br>
                6 % 12 = 6<br>
                6 / 12 = 0<br>
                Affine by 15: L → X</p>
                <p class="centered">Decrypted Word: FLUX</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
    </div>
</body>
</html>