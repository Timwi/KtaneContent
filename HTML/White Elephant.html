<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>White Elephant — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/ruleseed.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        td img { width: 100px; }
        .dark svg circle { stroke: #DDD; }
        .dark svg text { fill: #DDD; }
        .dark td img { filter: invert(90%); }

        code {
            background-color: #CCC;
            padding: .1em .5em;
        }
        .dark code { background-color: #444; }

        .page-footer::before { content: 'Page '; }
        .page-footer::after { content: ' of 3'; }
    </style>
    <script>
        var generated;
        var rng;
        var counter = 0;
        var edgework = ["D Batteries","AA Batteries","Battery Holders","Port Plates","Ports","Unlit Indicators","Lit Indicators"];
        var edgee = [0, 1, 2, 3, 4, 5, 6];
        var table1 = ["first-rec","second-rec","third-rec"];
        var table2 = ["first-num","second-num","third-num"];
        var amount = ["even", "odd"];
        var table_tags = ["venn-one", "venn-two","venn-four"];
        var edgeworkConditions = [[0,""],[0,""],[0,""]];
        var coloring = ["R","A","G"];
        var venn_color = ["","","","","","","",""];
        var venn_tags = ["venn-fff","venn-fft","venn-ftf","venn-ftt","venn-tff","venn-tft","venn-ttf","venn-ttt"];
        var receiver = [
            "James","Robert","John","Michael","David","William","Richard","Joseph","Thomas","Christopher",
            "Charles","Daniel","Matthew","Anthony","Mark","Donald","Steven","Andrew","Paul","Joshua",
            "Mary","Patricia","Jennifer","Linda","Elizabeth","Barbara","Susan","Jessica","Sarah","Karen",
            "Lisa","Nancy","Betty","Sandra","Margaret","Ashley","Kimberly","Emily","Donna","Kathryn"
        ];
        var receiver_table = ["","",""];

        function setDefaultRules(rnd) {
            setRules(rnd);
        }

        function setRules(rnd) {
            counter = 0;
            rng = rnd;
            for (var color = 0; color < venn_color.length; color++) {
                var index = rng.next(0, coloring.length);
                venn_color[color] = coloring[index];
            }
            console.log(venn_color);
            for (var i = 0; i < 8; i++) {
                generateVenn();
            }
            for (var edge = 0; edge < edgeworkConditions.length; edge++) {
                edgeworkConditions[edge][0] = edgee[rng.next(0, edgework.length)];
                edgeworkConditions[edge][1] = amount[rng.next(0, 2)];
                if (edge == 1) {
                    while(edgeworkConditions[edge][0] == edgeworkConditions[edge - 1][0]) {
                        edgeworkConditions[edge][0] = (edgeworkConditions[edge][0] + 1) % 7;
                    }
                }
                if (edge == 2) {
                    while (edgeworkConditions[edge][0] == edgeworkConditions[edge - 1][0] || edgeworkConditions[edge][0] == edgeworkConditions[edge - 2][0]) {
                        edgeworkConditions[edge][0] = (edgeworkConditions[edge][0] + 1) % 7;
                    }
                }

                console.log(rng);
                document.getElementById(`${table_tags[edge]}`).innerText = `If the number of ` + edgework[edgeworkConditions[edge][0]]+` is ` + edgeworkConditions[edge][1];
            }

            rnd = new MonoRandom(rnd.seed);
            rng = rnd;

            for (var i = 0; i < 3; i++) {
                var stage2 = rng.next(0, receiver.length);
                document.getElementById(`${table1[i]}`).innerText = receiver[stage2];
            }
            rnd = new MonoRandom(rnd.seed);
            rng = rnd;
            for (var i = 0; i < 3; i++) {
                var stage3 = rng.next(0, 10);
                document.getElementById(`${table2[i]}`).innerText = stage3;
            }
        }

        function generateVenn() {
            document.getElementById(venn_tags[counter]).textContent = getInstr();
        }

        function getInstr() {
            counter++;
            return venn_color[counter-1];
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">White Elephant</span>
            </div>
            <div class="page-content">
                <img src="img/Component/White Elephant.svg" class="diagram">
                <h2>On the Subject of White Elephant</h2>
                <p class="flavour-text">Season 6, Episode 11. Only on Cartoon Network™</p>
                <p>This module uses four rule seeds. To visit the necessary pages for this module, copy <code>https://ktane.timwi.de/HTML/White%20Elephant.html#</code> into your search bar and append any necessary rule seed.</p>
                <p>This module features a literal white elephant.</p>
                <p>When pressed, the module will progress into showing three presents. Hovering over a present will magnify their tag. Each tag has a segment of the first rule seed. Take note of each segment.</p>
                <p>Append each segment in reading order (LeftMiddleRight). Visit the rule-seeded page using the first rule seed provided to determine the present to give.</p>
                <p>When the defuser select the correct present to give, the defuser needs to find the person to give the present to.</p>
                <p>Hovering over a person will magnify a nametag with a name and an ID number. Each ID number is its own rule seed. There will be one person with question marks as their ID number. Their ID number is the first rule seed.</p>
                <p>The second and third rule seeds are the two visible ID numbers. Visit the three rule-seeded pages using the first, second, and third rule seeds provided to find the person in all three manuals.</p>
                <p>Find the person that appears in any of the three rule-seeded manuals. When selected, the person will give you a present.</p>
                <p>Remember the three segments of the first rule seed? Use the segment that corresponded with the present of the same color as yours as your fourth rule seed. Visit the rule-seeded page using the fourth rule seed provided to find an appropriate time to open the present.</p>
                <p>Follow the rules provided to open your present.</p>
                <p>To solve the module, press the correct present to give to the correct person, then open your present at the correct time.</p>
                <p>Pressing the wrong present, the wrong person, or your present at the wrong time will result in a strike and the entire module resets.</p>
            </div>
            <div class="page-footer relative-footer">1</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">White Elephant</span>
            </div>
            <div class="page-content">
                <h3>Selecting the Present</h3>
                <p>Using the edgework on the bomb, use the Venn diagram to determine which present to give.</p>
                <p>R = Red<br>G = Green<br>A = Gray/Grey</p>
                <table>
                    <tr>
                        <td><img src="img/White Elephant/venn_one.svg"></td>
                        <td id="venn-one">C</td>
                    </tr>
                    <tr>
                        <td><img src="img/White Elephant/venn_two.svg"></td>
                        <td id="venn-two">C</td>
                    </tr>
                    <tr>
                        <td><img src="img/White Elephant/venn_four.svg"></td>
                        <td id="venn-four">C</td>
                    </tr>
                </table>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 320">
                    <circle cx="200" cy="120" r="100" fill="none" stroke="#000" stroke-width="1.8"/>
                    <circle cx="260" cy="200" r="100" fill="none" stroke="#000" stroke-dasharray="7.03418,3.51709,1.75854,3.51709" stroke-width="1.8"/>
                    <circle cx="140" cy="200" r="100" fill="none" stroke="#000" stroke-dasharray="10.5546,1.7591" stroke-width="1.8"/>
                    <text x="320" y="70" font-size="48" id="venn-fff">C</text>
                    <text x="185" y="80" font-size="48" id="venn-fft">C</text>
                    <text x="100" y="250" font-size="48" id="venn-ftf">C</text>
                    <text x="120" y="160" font-size="48" id="venn-ftt">C</text>
                    <text x="260" y="250" font-size="48" id="venn-tff">C</text>
                    <text x="240" y="160" font-size="48" id="venn-tft">C</text>
                    <text x="185" y="260" font-size="48" id="venn-ttf">C</text>
                    <text x="185" y="190" font-size="48" id="venn-ttt">C</text>
                </svg>
            </div>
            <div class="page-footer relative-footer">2</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">White Elephant</span>
            </div>
            <div class="page-content">
                <h3>Selecting the Receiver</h3>
                <p>Using the rule seed from the previous step and two other rule seeds, find the one name that is present in one of the three manuals in the table below and select the receiver with that name.</p>
                <h3>Opening Your Present</h3>
                <p>A present with one of three colors will appear. The rule seed used for this step is the rule seed segment from that present in stage 1. The top row represents the leftmost receiver. The middle row represents the central receiver. The bottom row represents the rightmost receiver. Using the position of the correct receiver, use the specified row.</p>
                <table>
                    <tr><td id="first-rec"></td><td id="first-num">#</td></tr>
                    <tr><td id="second-rec"></td><td id="second-num">#</td></tr>
                    <tr><td id="third-rec"></td><td id="third-num">#</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">3</div>
        </div>
    </div>
</body>
</html>