<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>紫色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
    .dark table, table {
        margin: 1em auto;
        border: none;
    }
    .strip-change-one td,
    .strip-change-one th {
        padding: .3em .5em .2em;
    }
    .alpha {
        font-size: 13px;
        font-family: "Special Elite";
    }
    .beta {
        font-size: 11px;
    }
    .tablea {
        font-size: 14px;

    }
    .tableb {
        font-size: 20px;
        width: 100%;
    }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">紫色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：紫色暗号</h2>
                <p class="flavour-text">バラは赤い。スミレは青い。こんなジョーク前にも言ったっけ？まぁいいや、ここに暗号があるよ。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに6文字のキーワード、下のディスプレーに2桁の数字が表示される。</p>
                <p>ページ2には、上のディスプレーに別のキーワードが表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：ポルタ暗号</h3>
                <p>ここでは、ページ1の上部に表示された暗号化された単語とページ1の真ん中に表示された6文字のキーワード、そして以下のチャートが必要になる。</p>
                <p>暗号化された単語の各英字に対して、以下の処理を行う。</p>
                <ul>
                    <li>キーワードの各英字を、以下のチャートの段に使用する。</li>
                    <li>暗号化された単語のその英字がAからMの間である場合、チャートの列にその英字を使用する。そして、段と列の交点が新たな暗号化された英字となる。</li>
                    <li>そうでない場合、キーワードの英字を同じ段から見つける。その英字の列からチャートのA-M段を参照して示された英字が新たな暗号化された英字となる。</li>
                </ul>

                <p>これで、ステップ2で使用する新たな暗号化された単語が手に入る。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>

        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">紫色暗号</span>
            </div>
            <div class="page-content">
                <table>
                    <tr><th class='corner'></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th></tr>
                    <tr><th>AB</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                    <tr><th>CD</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th></tr>
                    <tr><th>EF</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th></tr>
                    <tr><th>GH</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th></tr>
                    <tr><th>IJ</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th></tr>
                    <tr><th>KL</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th></tr>
                    <tr><th>MN</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th></tr>
                    <tr><th>OP</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th></tr>
                    <tr><th>QR</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th></tr>
                    <tr><th>ST</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th></tr>
                    <tr><th>UV</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th></tr>
                    <tr><th>WX</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th></tr>
                    <tr><th>YZ</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th></tr>
                </table>

                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：KVUPEM<br>
                    キーワード：CENTER
                </p>
                <p class="centered">
                    C + K => Y<br>
                    E + V => G<br>
                    N + U => B<br>
                    T + P => G<br>
                    E + E => T<br>
                    R + M => U<br>
                    新たな暗号化された単語：YGBGTU
                </p>

                <h3>ステップ2：ルート転置</h3>
                <p>ここでは、ステップ1で獲得した暗号化された単語とページ1の下に表示された2桁の数字が必要になる。</p>
                <p>十の位は暗号のグリッドを定義し、一の位はグリッドの左上の数字を定義する。</p>
                <p>十の位が1の場合、上のグリッドを使用する。そうでない場合、下のグリッドを使用する。</p>
            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">紫色暗号</span>
            </div>
            <div class="page-content">
                <table>
                    <tr><th>#</th><th>#</th><th>#</th></tr>
                    <tr><th>#</th><th>#</th><th>#</th></tr>
                </table>
                <table>
                    <tr><th>#</th><th>#</th></tr>
                    <tr><th>#</th><th>#</th></tr>
                    <tr><th>#</th><th>#</th></tr>
                </table>

                <p>一の位の数字をグリッドの左上のマスに入力する。そして、グリッド上を時計回りに進み、数字を1ずつ増やしつつマスに入力する。数字が6を超える場合、それを1にする。</p>
                <p>暗号化された単語の一番目の英字を1と書かれたマスに配置する。その後、二番目の英字を2と書かれたマスに配置する。以降も同様に、暗号化された単語を配置する。</p>
                <p>最後に英字を読み順で取得し、新たな暗号化された単語を得る。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：YGBGTU<br>
                    1ページ目の下部のディスプレー：12
                </p>

                <table>
                    <tr><th>2</th><th>3</th><th>4</th></tr>
                    <tr><th>1</th><th>6</th><th>5</th></tr>
                </table>
                <table>
                    <tr><th>G</th><th>B</th><th>G</th></tr>
                    <tr><th>Y</th><th>U</th><th>T</th></tr>
                </table>
                <p class="centered">
                    YGBGTU => GBGYUT
                </p>

                <h3>ステップ3：クアグマイア暗号</h3>
                <p>ここでは、ステップ2で獲得した暗号化された単語、1ページ目の真ん中にある6文字のキーワード、2ページ目の上に表示された単語(4〜8文字)が必要になる。</p>
                <p>このステップでは、この暗号に必要な暗号鍵を作成することから始める。</p>
                <p>暗号鍵は7段の英字からなる。1段目は常に以下の配列になる。</p>
                <p class="centered"> ABCDEFGHIJKLMNOPQRSTUVWXYZ </p>
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">紫色暗号</span>
            </div>
            <div class="page-content">
                <p>上のディスプレーのキーワードを用いて作成するアルファキーが残りの6段になる。</p>
                <ul>
                    <li>重複する英字の2文字目以降を削除する。</li>
                    <li>アルファベット全体の文字列を取得し、キーワードに表示された英字を削除する。</li>
                    <li>キーワードの末尾にアルファベットの文字列を配置する。これがアルファキーとなる。</li>
                </ul>
                <p>アルファキーを1段目の真下に6回コピー&ペーストし、合計が7段になるようにする。</p>
                <p>最後に、左端の英字が真ん中のディスプレーの単語になるように、下6つの段をずらす。</p>

                <h4 class="centered">例</h4>
                <p class="centered">
                    真ん中のディスプレーの単語：CENTER<br>
                    上のディスプレーの単語：PRESSURE
                </p>

                <table class="alpha">
                    <tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                    <tr><th><em>C</em></th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>Q</th><th>T</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>P</th><th>R</th><th>E</th><th>S</th><th>U</th><th>A</th><th>B</th></tr>
                    <tr><th><em>E</em></th><th>S</th><th>U</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>Q</th><th>T</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>P</th><th>R</th></tr>
                    <tr><th><em>N</em></th><th>O</th><th>Q</th><th>T</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>P</th><th>R</th><th>E</th><th>S</th><th>U</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th></tr>
                    <tr><th><em>T</em></th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>P</th><th>R</th><th>E</th><th>S</th><th>U</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>Q</th></tr>
                    <tr><th><em>E</em></th><th>S</th><th>U</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>Q</th><th>T</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>P</th><th>R</th></tr>
                    <tr><th><em>R</em></th><th>E</th><th>S</th><th>U</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>Q</th><th>T</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>P</th></tr>
                </table>

                <p>暗号化された単語の各英字に対して、以下の手順に従う。</p>
                <ul>
                    <li>暗号化された単語の英字をその英字と同じ位置の段の中から探す(1段目は段としてカウントされない)。</li>
                    <li>その列の中にある最上段(A–Z)の英字に置き換えることで、復号された英字が得られる。</li>
                </ul>
                <p>これで、復号された単語が手に入る。</p>
            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>

        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">紫色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：GBGYUT<br>
                    復号処理は上の表を使用<br>
                </p>
                <p class="centered">
                    G => D<br>
                    B => E<br>
                    G => T<br>
                    Y => E<br>
                    U => C<br>
                    T => T<br>
                    復号された単語：DETECT
                </p>

                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>

                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>

                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>
</html>