<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Black Cipher — Keep Talking and Nobody Explodes Module</title>
    <meta name="viewport" content="initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
			border: none;
        }
		.empty {
			border: none;
		}
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
		.alpha {
            font-size: 13px;
        }
		.beta {
            font-size: 11px;
        }
		.tablea {
            font-size: 14px;
        }
		.tableb {
            font-size: 20px;
			width: 100%;
        }
		.rotor {
			font-size: 13px;
			width: 100%;
		}
		.reflector {
			font-size: 13px;
			width: 100%;
		}
    </style>
    <style>
        /* Interactive */
        .borderless {
            border: none;
        }

        #interactive {
            font-size: 12.5px;
        }
        
        #interactive td.borderless:first-child {
            padding: .3em;
        }

		button {
			font-family: Special Elite;
			background-color: white;
			color: black;
			padding: 1px 3px;
			border-radius: 5px;
			border: black 2px solid;
			transition: 0.3s;
		}

		button:hover {
			background-color: black;
			color: white;
		}
    </style>
    <script src="js/jquery.3.1.1.min.js"></script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Black Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>On the Subject of the Black Cipher</h2>
                <p class="flavour-text">Black as the world it came from, this cipher will be the end of you.</p>
                <p>On the module, you will see 3 screens, a keyboard, 2 arrows, and a submit button that displays the current page you’re on.</p>
                <p>Pressing the right arrow takes you to the next page. Pressing the left arrow takes you to the previous page. There is a total of 2 pages.</p>
                <p>On page 1, the top screen shows a 6 letter encrypted word, the middle and bottom screens shows a word.</p>
            <p>On page 2, the top screen shows a letter followed by 3 roman numerals, the middle screen shows 3 letters, and the bottom screen shows some letter pairs.</p>
        
        <h3>Step 1: Digrafid Cipher</h3>
        <p>For this, you’re going to need the encrypted word on the top screen, and the words on the middle and bottom screens.</p>
        <p>The middle and bottom screens will be used to make 2 keys.</p>
        <p>Using the middle screen word, removing any duplicate letters, removing all 2nd or more occurrences. Take the entire alphabet and remove all the letters shown in this word.</p>      
        <p>If alphanumeric position (A = 1,B = 2...Z = 26) of the first letter of the serial number is odd, put the alphabet at the end of the word.<br>Otherwise, put the alphabet in front of the word.</p>
        <p>This will be known as Key A.</p>     
        <p>Using the bottom screen word, removing any duplicate letters, removing all 2nd or more occurrences. Take the entire alphabet and remove all the letters shown in this word.</p>      
        <p>If alphanumeric position (A = 1,B = 2...Z = 26) of the last letter of the serial number is even, put the alphabet at the end of the word.<br>Otherwise, put the alphabet in front of the word.</p>
        <p>This will be known as Key B.</p>
        <p>Add a # to the end of each key.</p>
        <p>Split Key A into 3 equal rows of 9 letters, left to right, top to bottom.</p>
        <p>Split Key B into 3 equal columns of 9 letters, top to bottom, left to right.</p>
    </div>
            <div class="page-footer relative-footer">Page 1 of 6</div>
        </div>

        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Black Cipher</span>
            </div>
            <div class="page-content">
        <p>Finally, connect the 2 keys with a 3x3 grid of numbers, consisting of 1-9 in reading order. Label numbers 1-9 on top of Key A and to the right of Key B:</p>
        <h4 style="text-align:center">Example</h4>
        <p style="text-align:center">
        Key A: ACDFGHIJKLOPQTVWXYZNUMBERS<br>
        Key B: BROWSEDACFGHIJKLMNPQTUVXYZ
        </p>

        <table>
        <tbody>
        <tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr>
        <tr><th>A</th><th>C</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>1</th><th>2</th><th>3</th></tr>
        <tr><th>L</th><th>O</th><th>P</th><th>Q</th><th>T</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>4</th><th>5</th><th>6</th></tr>
        <tr><th>Z</th><th>N</th><th>U</th><th>M</th><th>B</th><th>E</th><th>R</th><th>S</th><th>#</th><th>7</th><th>8</th><th>9</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>B</th><th>F</th><th>P</th><th>1</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>R</th><th>G</th><th>Q</th><th>2</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>O</th><th>H</th><th>T</th><th>3</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>W </th><th>I</th><th>U</th><th>4</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>S</th><th>J</th><th>V</th><th>5</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>E</th><th>K</th><th>X</th><th>6</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>D</th><th>L</th><th>Y</th><th>7</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>A</th><th>M</th><th>Z</th><th>8</th></tr>
        <tr><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><th>C</th><th>N</th><th>#</th><th>9</th></tr>

        </tbody>
        </table>
        <p>Split the encrypted word from the top screen into 3 letter pairs. Do the following for each letter pair:</p>
        <ul>
        <li>1: Find the 1st letter in Key A.</li>
        <li>2: Find the 2nd letter in Key B.</li>
        <li>3: Use the column of the 1st letter to get the 1st number.</li>
        <li>4: Use the row of the 1st letter and the column of the 2nd letter to get the 2nd number.</li>
        <li>5: Use the row of the 2nd letter to get the 3rd number.</li>
        <li>6: Write the number top to bottom, to the right of any previous numbers.</li>
        </ul>
        <p>Now read the 3 number combinations in reading order to get new numbers. For each 3 number combination do the following:</p>
    </div>
            <div class="page-footer relative-footer">Page 2 of 6</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Black Cipher</span>
            </div>
            <div class="page-content">
        <ul>
        <li>1: Find the 1st number above Key A.</li>
        <li>2: Find the 2nd number in the 3x3 grid of numbers.</li>
        <li>3: Find the 3rd number to the right of Key B.</li>
        <li>4: Use the column of the 1st number and the row of the 2nd number to get the 1st letter.</li>
        <li>5: Use the column of the 2nd letter and the row of the 3rd number to get the 2nd letter.</li>
        </ul>
        <p>After all that, you should now have a new encrypted word.</p>
        <h4 style="text-align:center">Example</h4>
        <p style="text-align:center">
        Encrypted word: BQTBJI<br>
        Key: Use the table above for the decryption process.
        </p>
        <p style="text-align:center">
        BQ -> 592<br>
        TB -> 541<br>
        JI -> 824<br>
        </p>
        <p style="text-align:center">
        Rearranging numbers so it’s top to bottom, left to right.<br>
            558<br>
            942<br>
            214<br> 
        Read it, left to right, top to bottom.  
        </p>
        <p style="text-align:center">
        558 -> TM<br>
        942 -> YR<br>
        214 -> CW
        </p>
        <h3>Step 2: Railfence Transposition</h3>
        <p>For this, you will need the encrypted word you got from step 1.</p>
        <p>First determine how many rows will be used by taking the number of ports, modulo 4, plus 2.</p>
        <h4 style="text-align:center">Example</h4>
        <p style="text-align:center">
        Rows: 3 <br>
        &nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;5<br>
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 4 6<br>
          &nbsp;&nbsp;&nbsp;3
        </p>
        <p>For each encrypted letter, in reading order, replace the number with that letter.</p>
        <p>Finally read the letters in the same order you place the numbers, up and down, left to right.</p>
    </div>
            <div class="page-footer relative-footer">Page 3 of 6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Black Cipher</span>
            </div>
            <div class="page-content">
        <p>You should now have a new encrypted word.</p>
        <h4 style="text-align:center">Example</h4>
        <p style="text-align:center">
        Encrypted word: XZIOHT<br>
        &nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;Z<br>
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I O H<br>
          &nbsp;&nbsp;&nbsp;T<br>
        New Encrypted Word: XITOZH
        </p>
        <h3>Step 3: Enigma Cipher</h3>
        <p>For this, you’re going to need the encrypted word you got from step 2, and all 3 screens from page 2.</p>        
        <p>On page 2 of the module, you will see a configuration of the rotors/reflector, the rotors setup below that, and a plugboard setup on the bottom.</p>
        <h3>Step 3A: Configuration of the Rotors/Reflector/Plugboard</h3>
        <p>The screen at the top shows what type of rotors are used, the order they are in, and which reflector is used. Use the correct rotor charts and correct reflector chart to use to create an Enigma Decryptor.</p>
        <p>They are read in this order: Reflector-Bottom Rotor-Middle Rotor-Top Rotor. Above the top rotor, you will type A-Z to use as the plugboard.</p>
        <p>Use the schematic at the bottom to help you create the Enigma Decryptor.</p>
        <p>The rotors below the screen shows what letter each one is at. Shift the letters until the bottom left letter is equal to the letter on the rotor.</p>
        <p>For each pair of letters on the plugboard setup, switch the 2 letters positions on your plugboard.</p>
        
        <table id="interactive" class="borderless"></table>
    </div>
            <div class="page-footer relative-footer">Page 4 of 6</div>
        </div>

        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Black Cipher</span>
            </div>
            <div class="page-content">
    <h2>Enigma Schematic</h2>
    <p style='text-align: center'><img src="img/Black Cipher/EnigmaScheme.png" style="width: 16cm" /></p>
    <p>After you set it all up, you are ready to use it. First do step 3B to decrypt the first letter of the encrypted word. Then rotate the rotors shown in step 3C.</p>
    </ul>
        <h3>Step 3B: Using the Enigma Decryptor</h3>
        <ul>
        <li>1: Take the letter of your word and find it on the plugboard row of the decryptor.</li>
        <li>2: Go straight down to the top row of the top rotor to recieve a new letter.</li>
        <li>3: Find the new letter in the bottom row of the top rotor.</li>
        <li>4: Go straight down to the top row of the middle rotor to recieve a new letter.</li>
        <li>5: Find the new letter in the bottom row of the middle rotor.</li>
        <li>6: Go straight down to the top row of the bottom rotor to recieve a new letter.</li>
        <li>7: Find the new letter in the bottom row of the bottom rotor.</li>
        <li>8: Go straight down to the top row of the reflector to recieve a new letter.</li>
        <li>9: Find the new letter in the bottom row of the reflector.</li>
        <li>10: Go straight up to the bottom row of the bottom rotor to recieve a new letter.</li>
        <li>11: Find the new letter in the top row of the bottom rotor.</li>
        <li>12: Go straight up to the bottom row of the middle rotor to recieve a new letter.</li>
        <li>13: Find the new letter in the top row of the middle rotor.</li>
        <li>14: Go straight up to the bottom row of the top rotor to recieve a new letter.</li>
        <li>15: Find the new letter in the top row of the top rotor.</li>
        <li>16: Go straight up to the plugboard row to recieve your decrypted letter.</li>
        </ul>
    </div>
            <div class="page-footer relative-footer">Page 5 of 6</div>
        </div>

        <div class="page page-bg-06">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Black Cipher</span>
            </div>
            <div class="page-content">
    <p style='text-align: center'>The example below uses I as the letter which will decrypt it to F.</p>

        <p style='text-align: center'><img src="img/Black Cipher/DecryptSteps.png" style="width: 16cm" /></p>
        
        <h3>Step 3C: Rotor Turning Mechanics</h3>
        <p>This next section talks about how rotor turning mechanics work.</p>  
    
        <p>You will notice a couple letters on the bottom row of the rotors have an * next to them. Depending on which rotor it’s on will have different effects:</p>
        <ul>
        <li>If the asterisk is at the leftmost edge of the middle rotor, all 3 rotors will turn</li>
        <li>Otherwise, if the asterisk is at the left most edge of the right/top rotor, both the middle and top/right rotor will turn.</li>
        <li>Otherwise, only the right/top rotor will turn</li>
        <li>Each turn only goes up 1 step on the rotor (Ex: A -> B, G -> H, Z -> A, etc.)</li>
        </ul>

        <p>Repeat steps 3B and 3C for each letter of your word to get your decrypted word.</p>  

            <p>Once you finally have your decrypted word, you can submit it. Once you start typing, all the screens will go black and the bottom screen will show what you are typing.</p>

    <p>To clear it, just click one of the arrows. This goes to one of the pages and clears any input you put in. It will not let you go over 6 letters on input.</p>

    <p>Once you are satisfied with your input, press the button labeled “SUB” to submit your answer. On a strike, the module will go back to the first page of the module, but it does not regenerate.</p>
          </div>
            <div class="page-footer relative-footer">Page 6 of 6</div>
        </div>
            
        
        <script>
            const cyclers = {
                "Rotor I": [
                    ["E", "K", "M", "F", "L", "G", "D", "Q", "V", "Z", "N", "T", "O", "W", "Y", "H", "X", "U", "S", "P", "A", "I", "B", "R", "C", "J"],
                    ["A", "B", "C", "D*", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q*", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                ],
                "Rotor II": [
                    ["A", "J", "D", "K", "S", "I", "R", "U", "X", "B", "L", "H", "W", "T", "M", "C", "Q", "G", "Z", "N", "P", "Y", "F", "V", "O", "E"],
                    ["A", "B", "C", "D", "E*", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R*", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                ],
                "Rotor III": [
                    ["B", "D", "F", "H", "J", "L", "C", "P", "R", "T", "X", "V", "Z", "N", "Y", "E", "I", "W", "G", "A", "K", "M", "U", "S", "Q", "O"],
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I*", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V*", "W", "X", "Y", "Z"],
    
                ],
                "Rotor IV": [
                    ["E", "S", "O", "V", "P", "Z", "J", "A", "Y", "Q", "U", "I", "R", "H", "X", "L", "N", "F", "T", "G", "K", "D", "C", "M", "W", "B"],
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J*", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W*", "X", "Y", "Z"],
    
                ],
                "Rotor V": [
                    ["V", "Z", "B", "R", "G", "I", "T", "Y", "U", "P", "S", "D", "N", "H", "L", "X", "A", "W", "M", "J", "Q", "O", "F", "E", "C", "K"],
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M*", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z*"],
    
                ],
                "Rotor VI": [
                    ["J", "P", "G", "V", "O", "U", "M", "F", "Y", "Q", "B", "E", "N", "H", "Z", "R", "D", "K", "A", "S", "X", "L", "I", "C", "T", "W"],
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L*", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y*", "Z"],
    
                ],
                "Rotor VII": [
                    ["N", "Z", "J", "H", "G", "R", "C", "X", "M", "Y", "S", "W", "B", "O", "U", "F", "A", "I", "V", "L", "P", "E", "K", "Q", "D", "T"],
                    ["A", "B", "C", "D", "E", "F", "G", "H*", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U*", "V", "W", "X", "Y", "Z"],
    
                ],
                "Rotor VIII": [
                    ["F", "K", "Q", "H", "T", "L", "X", "O", "C", "B", "J", "S", "P", "D", "Z", "R", "A", "M", "E", "W", "N", "I", "U", "Y", "G", "V"],
                    ["A", "B", "C*", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P*", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
    
                ],
                "Reflector A": [
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                    ["L", "U", "S", "N", "P", "Q", "O", "M", "J", "I", "Y", "A", "H", "D", "G", "E", "F", "X", "C", "V", "B", "T", "Z", "R", "K", "W"],
    
                ],
                "Reflector B": [
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                    ["X", "Q", "U", "M", "F", "E", "P", "O", "W", "L", "T", "J", "D", "Z", "H", "G", "B", "V", "Y", "K", "C", "R", "I", "A", "S", "N"],
    
                ],
                "Reflector C": [
                    ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                    ["E", "S", "K", "O", "A", "Q", "M", "J", "Y", "H", "C", "P", "G", "T", "D", "L", "F", "U", "B", "N", "R", "X", "Z", "V", "I", "W"],
                ],
            };
            
            function mod26(n) {
                return ((n % 26) + 26) % 26;
            }
    
            const interactive = $("#interactive");
    
            // Make the keyboard
            const keyboard = $("<tr>").appendTo(interactive);
                
            $("<td>").addClass("borderless").appendTo(keyboard);
            // The top row of any reflector is just A-Z.
            for (let i = 0; i < 26; i++) {
                $("<td>").text(cyclers["Reflector A"][0][i]).appendTo(keyboard);
            }
    
            // Make the cyclers
            function makeCycler(names, controls = true) {
                let position = 0;
                let name = names[0];
    
                const update = () => {
                    for (let i = 0; i < 26; i++) {
                        topRow.children().eq(i + 1).text(cyclers[name][0][mod26(i + position)]);
                        bottomRow.children().eq(i).text(cyclers[name][1][mod26(i + position)]);
                    }
                };
                
                const selector = $("<select>");
                for (const name of names) {
                    $("<option>").attr("value", name).text(name).appendTo(selector);
                }
    
                selector.change(() => { name = selector.val(); update(); });
    
                const selectorRow = $("<tr>").appendTo(interactive);
                $("<td>").addClass("borderless").appendTo(selectorRow);
                $("<td colspan=26>").append(selector).appendTo(selectorRow);
    
                const topRow = $("<tr>").appendTo(interactive);
                if (controls) {
                    const shiftLeft = $("<button>").text("←").click(() => { position++; update(); });
                    $("<td rowspan=2>").addClass("borderless").append(shiftLeft).appendTo(topRow);
                } else {
                    $("<td rowspan=2>").addClass("borderless").appendTo(topRow);
                }
    
                const bottomRow = $("<tr>").appendTo(interactive);
    
                for (let i = 0; i < 26; i++) {
                    $("<td>").appendTo(topRow);
                    $("<td>").appendTo(bottomRow);
                }
    
                if (controls) {
                    const shiftRight = $("<button>").text("→").click(() => { position--; update(); });
                    $("<td rowspan=2>").addClass("borderless").append(shiftRight).appendTo(topRow);
                }
    
                update();
            }
    
            // Make the rotors
            const rotorNames = Object.keys(cyclers).filter(name => name.includes("Rotor"));
            for (let i = 0; i < 3; i++) {
                makeCycler(rotorNames);
            }
    
            // Make the reflector
            makeCycler(Object.keys(cyclers).filter(name => name.includes("Reflector")), false);
        </script>
</body>
</html>