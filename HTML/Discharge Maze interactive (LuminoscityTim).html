<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Discharge Maze â€” Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/jquery.3.1.1.min.js"></script>
    <script src="js/Utilities/svg-utils.js"></script>
    <script>
    $(function() {
        let mazeRotation = 0;
        let maze = $(".themaze");

        $("button.rotate-cc").click(function() {
            rotateMaze(false, false);
        });
        $("button.rotate-cw").click(function() {
            rotateMaze(true, false);
        });
        $("button.reset").click(function() {
            rotateMaze(false, true);
        });

        function rotateMaze(clockwise, reset) {
            if (clockwise) {
                mazeRotation += 1;
            } else if (!reset) {
                mazeRotation -= 1;
            } else {
                mazeRotation = 0;
            }

            maze.css("transform", `rotate(${mazeRotation * 90}deg)`);
        }

        let wd = 19.3;
        let ht = 18.55;
        for (let x = 0; x < 16; x++) {
            let line1 = MakeSvgElem("path", {
                d:`M${18} ${20 + ht*x}h290`, "stroke-width":1, stroke:"#000", "stroke-dasharray":"1.5,1.5"
            });
            let line2 = MakeSvgElem("path", {
                d:`M${19 + 19.2*x} ${20}v278`, "stroke-width":1, stroke:"#000", "stroke-dasharray":"1.5,1.5"
            });
            maze.append(line1);
            maze.append(line2);
        }
        for (let y = 0; y < 15; y++) {
            for (let x = 0; x < 15; x++) {
                let box = MakeSvgElem("rect", {
                    x:(18 + wd*x), y: (20 + ht*y), width:wd, height:ht, fill:"transparent", class:"highlightable"
                });
                maze.append(box);
            }
        }
    });
    </script>
    <script src="js/ktane-utils.js"></script>
    <style>
        .rotate-cc, .rotate-cw, .reset {
            font-size: 15px;
            height: 28.5px;
            width: 51px;
            background-position: 1px 0;
            background-repeat: no-repeat;
        }
        .rotate-cc {
            background-image: url('img/Common/ccw-arrow.svg');
        }
        .rotate-cw {
            background-image: url('img/Common/cw-arrow.svg');
        }

        .hstack {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
        }

        .buttons {
            display: flex;
            flex-direction: row;
            justify-content: center;
            padding: 2px;
            height: 0;
        }

        .themaze {
            width: 436px;
            transition: transform 0.5s;
        }
        ul.color {
            font-size: 15px;
            padding: 0;
        }
        ul.color li { margin-bottom:10px; }
        .dark svg path, .dark svg circle { stroke: #DDD; }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Discharge Maze</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Discharge Maze.svg" class="diagram">
                <h2>On the Subject of Discharge Mazes</h2>
                <p class="flavour-text">This seems to be some kind of maze, because otherwise this is some shoddy electronics work.</p>
                <ul style="font-size:15px">
                    <li>Find the 7&#x00d7;7 region of the maze with matching circular markings.<br>The maze may be rotated by a multiple of 90&deg;.</li>
                    <li>Flipping the switch will activate the module, turning on one of the lights in the maze and charging the capacitor by 10% per second.</li>
                    <li>Holding down a lever discharges the capacitor by 10% per second and releasing it moves the light in its direction.</li>
                    <li>With each move, the charge is measured. Each pair of consecutive measurements must meet the condition according to the colour of the fluid in the gauge.</li>
                    <li>The defuser must navigate the light out of the region, crossing the edge in the direction matching its colour.</li>
                    <li><b>Warning:</b>
                        <ul style="font-size:14px">
                            <li>Do not cross the solid lines in the maze, all lines are invisible on the module.</li>
                            <li>Do not allow the capacitor to overload or fully deplete while active.</li>
                        </ul>
                    </li>
                </ul>
                <div class="hstack">
                    <svg class="themaze" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 327 318">
                        <style>
                          .st4{fill:none;stroke-miterlimit:10}.st4,.st5{stroke:#000}.st5{fill:none;stroke-width:2.6;stroke-miterlimit:10}
                        </style>
                        <rect x="18.8" y="0" width="288.8" height="19.5" fill="#005fff"/>
                        <rect x="0" y="19.5" width="18.8" height="278.2" fill="red"/>
                        <rect x="307.5" y="19.5" width="327" height="278.2" fill="#f5ea00"/>
                        <rect x="18.8" y="297.8" width="288.8" height="318" fill="#0f0"/>
                        <circle class="st4" cx="67" cy="29.3" r="4.3"/>
                        <circle class="st4" cx="47.6" cy="121.9" r="4.3"/>
                        <circle class="st4" cx="105.4" cy="140.6" r="4.3"/>
                        <circle class="st4" cx="28.5" cy="178.2" r="4.3"/>
                        <circle class="st4" cx="124.2" cy="84.7" r="4.3"/>
                        <circle class="st4" cx="201.4" cy="66.4" r="4.3"/>
                        <circle class="st4" cx="240.1" cy="29.2" r="4.3"/>
                        <circle class="st4" cx="297.5" cy="84.9" r="4.3"/>
                        <circle class="st4" cx="259.1" cy="159.8" r="4.3"/>
                        <circle class="st4" cx="278" cy="214.8" r="4.3"/>
                        <circle class="st4" cx="163.2" cy="288.8" r="4.3"/>
                        <circle class="st4" cx="143.9" cy="233.7" r="4.3"/>
                        <circle class="st4" cx="86.2" cy="215" r="4.3"/>
                        <circle class="st4" cx="67" cy="288.7" r="4.3"/>
                        <circle class="st4" cx="220.1" cy="251.3" r="4.3"/>
                        <circle class="st4" cx="182.6" cy="196.2" r="4.3"/>
                        <path class="st5" d="M19.1 243v55.1h56.6M57.9 279.3h37.9v18.8h38.6M77 243v36.3m-20-18H37.9v18.4-54.4H19.1v-38.4h19.1"/>
                        <path class="st5" d="M56.6 243.8v-38.2h19.1-38.2m58.3 38.1v-19.4h19.1-38.2m58.1 19h-19.9v18H95.8m18.5 18h76.9M172.6 261v18.3M134.1 261v18.3m19.3-17.6v-18.4h39.3m-41.2 54.8h58.8V279m19.6 0v19.1h58.9M268.9 261v37.1m38 .3v-19.1h-18.6V243m-19.8-73.9h19.8v36.5h18.6v56.2m-18.1-37.5h-19.9v18h-39.4m19.8 37.5v-36.5"/>
                        <path class="st5" d="M190.5 224.3h39.7-19.8v37h19.8-39.7m39.4-92.5v36.8h19.4v20.1-20.1h19.6v-18.1"/>
                        <path class="st5" d="M306.9 188.3v-57.1 19.1h-57.5v38m20.8-56.7h-39.3v18.7h-19.6v19.1m0 17.1v19.1h-39v19.1-38.2M133 224.3h19.9v-56.2h19.9H133"/>
                        <path class="st5" d="M76.6 131.6h19.1v-18.7h18.8V75.3H95.7V56.2M133.6 186.8v19.1H95.3v-37.8 19.1H57.4"/>
                        <path class="st5" d="M114.9 188.3v-38h58.9-20.4v-19.7m38.4 57.7v-56.7h-19.6v-19.1m58-56.3v19.1h-19.6V132v-19.1h-19.8m39.1-19.1v19.1h58.4V132v-19.1h18.6V93.8M249 19.9h39.3V57"/>
                        <path class="st5" d="M288.7 94.1h-39.4V56.6h19.6V38.2m-39-18.7v19.1h19.9-39.5v18.3m-57.5-37h19.8V39 19.9H212"/>
                        <path class="st5" d="M76.3 169.4v-19.1h19.2-57 18.9l.2-37.4h19.1M307.9 19.5v55.8h-39.4M191.8 38.2v37.5-19.1h-38.4v-18H115V57"/>
                        <path class="st5" d="M134.3 19.9H95.7v18.7H76.9v37.1M134 56.2v38.2-19.1h39.3m19.5 18.8h-39.1v18.8h-19.8v18.7h-19.8"/>
                        <path class="st5" d="M57 169.1H19.1v-37.5h18.8V93.8m37.8-73.9H37.9V39m56.6 55.1H56.6V75.3H37.5h19.1V38.2M38.2 56.6H19.1V38.2v75.1"/>
                    </svg>

                    <div style="width:31%">
                        <div class="buttons">
                            <button class="rotate-cc floating"></button>
                            <button class="reset">0</button>
                            <button class="rotate-cw floating"></button>
                        </div>
                        <p style="margin-top:50px">Release conditions:</p>
                        <ul class="color">
                            <li><span style="color:#ff0000">Red:</span> More than <b>10% less</b> or <b>80% more</b> than the previous measurement.</li>
                            <li><span style="color:#cccc00">Yellow:</span> More than <b>60% less</b> or <b>30% more</b> than the previous measurement.</li>
                            <li><span style="color:#00cc00">Green:</span> Differs by more than <b>45% from</b> the previous measurement.</li>
                            <li><span style="color:#005fff">Blue:</span> Differs by between <b>20% and 40% from</b> the previous measurement.</li>
                        </ul>
                    </div>
                </div>
                <p><b>Exit condition:</b><br>The last move must be done when the capacitor is <b>over 90%</b> charged, in addition to meeting the release condition.</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
    </div>
</body>
</html>