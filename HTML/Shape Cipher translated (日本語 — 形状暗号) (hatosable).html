<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>形状暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .dark img.ondark {
            filter: invert(87%);
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">形状暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Shape Cipher.svg" class="diagram">
                <h2>モジュール詳細：形状暗号</h2>
                <p class="flavour-text">幾何学の先生から、あなたへの宿題だって。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で7ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーにキーワードが表示される。このキーワードをKW1とする。</p>
                <p>ページ2とページ3には、3つのディスプレーすべてに数字が表示される。各桁は円形暗号で使用する。</p>
                <p>ページ4には、上のディスプレーにキーワードが表示される。このキーワードをKW2とする。</p>
                <p>ページ4とページ5には、0~11の範囲の値が表示され、その真下のディスプレーに回転方向が表示される。</p>
                <p>ページ5には、下のディスプレーにある数字が表示される。この数字は正三角形暗号の十二角形キーの作成で使用する。</p>
                <p>ページ6とページ7には、ディスプレーに6文字の英字がモールス信号で表示されている。これをKW3とする。これは四角形暗号で使用する。</p>
                <p>暗号化された単語を取得し、以下のルールに従う。</p>

                <h3>ステップ1：円形暗号</h3>
                <p>このステップでは、KW1を使用して文字列を作成する。</p>
                <p>作成するには、キーワードの後ろにアルファベット全体の文字列を作成し、重複する英字を削除する(最初に出てきた英字は除外する)。</p>
                <p>文字列と円周率は、左端を0番目とする。</p>
                <p>2ページ目の上のディスプレーの数字を取得し、円周率の位置を得る。その桁の位置にある数字を取り、最初の文字からその数だけ左にシフトし、必要ならループする。この作業を6文字と数字すべてについて続ける。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">形状暗号</span>
            </div>
            <div class="page-content">
            <p>円周率の先頭120桁は、以下の通りである。</p>
            <p>31415926535897932384<br>62643383279502884197<br>16939937510582097494<br>45923078164062862089<br>98628034825342117067<br>98214808651328230664</p>
            <p>出来上がった英字が新しい暗号化された単語を形成する。</p>
            <h4 class="centered">例</h4>
            <p class="centered">
                暗号化された単語：LSXTFC<br>
                KW1：CARNIVAL<br>
                キー1：CARNIVLBDEFGHJKMOPQSTUWXYZ<br>
                数字：2, 12, 33, 44, 45, 62
            </p>

            <p class="centered">
                2番目：4, L->R<br>
                12番目：9, S->F<br>
                33番目：2, X->U<br>
                44番目：9, T->G<br>
                45番目：9, F->A<br>
                62番目：9, C->P<br>
                暗号化された単語：RFUGAP
            </p>
            <h3>ステップ2：正三角形暗号</h3>
            <p>このステップでは、KW2を使用して文字列を作成する。</p>
            <p>作成するには、キーワードの後ろにアルファベット全体の文字列を置き、重複する英字を削除する(最初に出てきた英字は除外する)。それから先頭の10文字を取得し、それを末尾に加える。これで、36文字の文字列ができるはずである。</p>
            <p>文字列の最初の文字を取得する。次に、5ページにある数字だけ右に進み、到達した英字を取得する。そのステップをもう一度繰り返し、もう一つ英字を取得する。この3文字の文字列が、最初の正三角形となる。この作業を、毎回未使用の一番左にある位置から始めて、合計12個の正三角形ができるまで繰り返す。各英字は正三角形の頂点に、反時計回りに配置されている。</p>
            <p>4ページと5ページにある時計回りと反時計回りのマークは、暗号化された単語を解読するために必要な回転を伝えている。各回転は、真上にあるディスプレーの各正三角形に対応している。</p>
            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">形状暗号</span>
            </div>
            <div class="page-content">
                <p>モジュール上で最初にリストアップされた正三角形(先頭は0番目)に最初の回転を使用し、その方向に60度だけ回転させて英字を変更する。変換元の英字があった位置にある英字が変換後の英字である。すべての英字が解読されるまでこれを繰り返す。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：RFUGAP<br>
                    KW2：FANFARE<br>
                    キー2：FANREBCDGHIJKLMOPQSTUVWXYZFANREBCDGH<br>
                    数字：9, 0, 6, 10, 9, 4<br>
                    正三角形：2<br>
                    回転：↻↻↻↻↻↺
                </p>
                <p class="centered">正三角形の文字列：</p>
                <p class="centered">
                    FNE<br>
                    ARB<br>
                    CGI<br>
                    DHJ<br>
                    KMP<br>
                    LOQ<br>
                    SUW<br>
                    TVX<br>
                    YFN<br>
                    ZAR<br>
                    ECG<br>
                    BDH
                </p>
                <p class="centered">復号：</p>
                <p class="centered">
                    R->Z<br>
                    F->N<br>
                    U->W<br>
                    G->E<br>
                    A->R<br>
                    P->M
                </p>

                <p class="centered">新たな暗号化された単語：ZNWERM</p>
                <h3>ステップ3：四角形暗号</h3>
                <p>このステップでは、<b>付録：モールス信号</b>を参照して、KW3を解読し復号したKW3を使用して行列を作成する。</p>
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">形状暗号</span>
            </div>
            <div class="page-content">
                <p>作成するには、Jがある場合はそれをIに変換し、KW3から重複する英字を削除する(最初に出てきた英字は除外する)。その後、Jを除くアルファベット全体の文字列を取得し、現在のキーに含まれるすべての英字を削除したら、キーの末尾にアルファベットを配置する。</p>
                <p>25文字の文字列を取得できたら、5×5の行列を作成していく。</p>
                <p>暗号化された単語を2文字のペアに分ける。各ペアに対し、</p>

                <ul>
                    <li>2つの英字が全く同じ場合、そのままにする。</li>
                    <li>そうでなければ、英字が行列内の同じ段にある場合、中央の段に対して線対称である位置の英字に置き換える。</li>
                    <li>そうでなければ、英字が行列内の同じ列にある場合、中央の列に対して線対称である位置の英字に置き換える。</li>
                    <li>そうでなければ、ペアの一方の英字と同じ列かつもう一方の英字と同じ段にある英字に置き換える。</li>
                </ul>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：ZNWERM<br>
                    KW3：VOLUME<br>
                    キー3：VOLUMEABCDFGHIKNPQRSTWXYZ
                </p>
                <table>
                    <tr><th>V</th><th>O</th><th>L</th><th>U</th><th>M</th></tr>
                    <tr><th>E</th><th>A</th><th>B</th><th>C</th><th>D</th></tr>
                    <tr><th>F</th><th>G</th><th>H</th><th>I</th><th>K</th></tr>
                    <tr><th>N</th><th>P</th><th>Q</th><th>R</th><th>S</th></tr>
                    <tr><th>T</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                </table>
                <p class="centered">
                    ZN -> ST<br>
                    WE -> AT<br>
                    RM -> US<br>
                    復号された単語：STATUS
                </p>
                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。 </p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">形状暗号</span>
            </div>
            <div class="page-content">
                <h2>付録：モールス信号</h2>
                <img class="ondark" src="img/Morse Code/morse-signals.svg">
            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>
</html>