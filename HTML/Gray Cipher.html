<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Gray Cipher — Keep Talking and Nobody Explodes Module</title>
    <meta name="viewport" content="initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
			border: none;
        }
		.corner {
			border: none;
		}
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
		.alpha {
            font-size: 13px;
        }
		.beta {
            font-size: 11px;
        }
		.tablea {
            font-size: 14px;
        }
		.tableb {
            font-size: 20px;
			width: 100%;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Gray Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>On the Subject of the Gray Cipher</h2>
                <p class="flavour-text">This cipher might seem gray and bleak and boring. Well, I must say... you’re not wrong.</p>
                <p>On the module, you will see 3 screens, a keyboard, 2 arrows, and a submit button that displays the current page you’re on.</p>
                <p>Pressing the right arrow takes you to the next page. Pressing the left arrow takes you to the previous page. There is a total of 1 page.</p>
                <p>On page 1, the top screen shows a 6 letter encrypted word, the middle screen shows a word, the bottom screen shows a 6 digit binary string.</p>
      		<p>Follow the mechanics down below to decrypt your word:</p>
		
		<h3>Step 1: Ragbaby Cipher</h3>
		<p>For this, you’re going to need the encrypted word on the top screen, and the word on the middle screen.</p>
		<p>Using the word from the middle screen, remove any duplicate letters from it, getting rid of all 2nd or more occurrences. Next, take the entire alphabet and remove all the letters that are shown in the key.</p>
		<p>If the number of unlit indicators is even, put the alphabet at the end of the key.<br>Otherwise, place it in front of the key. This will be your Ragbaby key.</p>		
		<p>Starting with an offset of 1, follow the directions below for each letter:</p>
		<ul>
		<li>1: Find the letter in the Ragbaby key.</li>
		<li>2: Go to the left a X number of times where X is the offset.</li>
		<li>3: Replace that letter with the letter you end up on.</li>
		<li>4: Add 1 to the offset.</li>
		</ul>
		<p>After that you should now have a new encrypted word.</p>
		<h4 style="text-align:center">Example</h4>
		<p style="text-align:center">
		Encrypted Word: QJAGVI<br>
		Ragbaby Key: WAXYBCDEFGHIJKLMNOPQRSTUVZ (Unlit is even)
		</p>
		<p style="text-align:center">
		Q -> P<br>
		J -> H<br>
		A -> V<br>
		G -> C<br>
		V -> Q<br>
		I -> C		
		</p>
	</div>
            <div class="page-footer relative-footer">Page 1 of 4</div>
        </div>

        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Gray Cipher</span>
            </div>
            <div class="page-content">
			
		<h3>Step 2: Bit Switch Cipher</h3>
		<p>For this, you will need the encrypted word you got from step 1, and the 6 digit binary string on the bottom screen.</p>
		<p>First determine the scrambler that will be used by using the first character of the serial number:</p>
		<table>
                    <tbody>
			<tr><th>0</th><th>21453</th><th>9</th><th>23154</th><th>I</th><th>24513</th><th>R</th><th>24531</th></tr>
			<tr><th>1</th><th>21534</th><th>A</th><th>25134</th><th>J</th><th>25413</th><th>S</th><th>25431</th></tr>
			<tr><th>2</th><th>31524</th><th>B</th><th>24153</th><th>K</th><th>34512</th><th>T</th><th>34521</th></tr>
			<tr><th>3</th><th>31452</th><th>C</th><th>34152</th><th>L</th><th>35214</th><th>U</th><th>35421</th></tr>
			<tr><th>4</th><th>41523</th><th>D</th><th>35124</th><th>M</th><th>35412</th><th>V</th><th>43251</th></tr>
			<tr><th>5</th><th>41532</th><th>E</th><th>45123</th><th>N</th><th>43512</th><th>W</th><th>43521</th></tr>
			<tr><th>6</th><th>51234</th><th>F</th><th>45132</th><th>O</th><th>45213</th><th>X</th><th>45231</th></tr>
			<tr><th>7</th><th>51423</th><th>G</th><th>54123</th><th>P</th><th>53412</th><th>Y</th><th>53421</th></tr>
			<tr><th>8</th><th>51432</th><th>H</th><th>54132</th><th>Q</th><th>54213</th><th>Z</th><th>54231</th></tr>							
                    </tbody>
                </table>
		<p>Next turn each letter of the encrypted word you have so far into it’s alphanumeric position (A = 1, B = 2...Z = 26). If the binary bit (bottom screen) at the letter’s position is a 1, add 26 to the number. Then turn each number into it’s binary sequence using the table below:</p>
		<table>
                    <tbody>
			<tr>
				<th>1</th><th>00001</th><th>8</th><th>01000</th><th>15</th><th>01111</th><th>22</th><th>10110</th><th>29</th><th>11101</th>
			</tr>
                        <tr>
				<th>2</th><th>00010</th><th>9</th><th>01001</th><th>16</th><th>10000</th><th>23</th><th>10111</th><th>30</th><th>11110</th>
			</tr>
                        <tr>
				<th>3</th><th>00011</th><th>10</th><th>01010</th><th>17</th><th>10001</th><th>24</th><th>11000</th><th>31</th><th>11111</th>
			</tr>
			<tr>
				<th>4</th><th>00100</th><th>11</th><th>01011</th><th>18</th><th>10010</th><th>25</th><th>11001</th>
			</tr>
			<tr>
				<th>5</th><th>00101</th><th>12</th><th>01100</th><th>19</th><th>10011</th><th>26</th><th>11010</th>
			</tr>
			<tr>
				<th>6</th><th>00110</th><th>13</th><th>01101</th><th>20</th><th>10100</th><th>27</th><th>11011</th>
			</tr>
			<tr>
				<th>7</th><th>00111</th><th>14</th><th>01110</th><th>21</th><th>10101</th><th>28</th><th>11100</th>
			</tr>									
                    </tbody>
                </table>
		<p>For each binary sequence, run it through the scrambler so that the number in each position turns into that position of that number in the binary. Ex: 35124: 10011 -> 01101. Convert each binary sequence back into its number using the table above.</p>
		<p>Finally turn each number back into a letter by treating the number as its alphanumeric position.</p>
	</div>
            <div class="page-footer relative-footer">Page 2 of 4</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Gray Cipher</span>
            </div>
            <div class="page-content">
			
		<h4 style="text-align:center">Example</h4>
		<p style="text-align:center">
		Encrypted Word: PHVCQC<br>
		Scrambler Used: 24153<br>
		Bottom Screen Binary: 000100
		</p>
		<p style="text-align:center">
		P -> 16 + 0 -> 16 -> 10000 + 24153 -> 00100 -> 4 -> D<br>
		H -> 8 + 0 -> 8 -> 01000 + 24153 -> 10000 -> 16 -> P <br>
		V -> 22 + 0 -> 22 -> 10110 + 24153 -> 01101 -> 13 -> M <br>
		C -> 3 + 1 -> 29 -> 11101 + 24153 -> 10111 -> 23 -> W <br>
		Q -> 17 + 0 -> 17 -> 10001 + 24153 -> 00110 -> 6 -> F<br>
		C -> 3 + 0 -> 3 -> 00011 + 24153 -> 01010 -> 10 -> J 
		</p>

		
		<h3>Step 3: Portax Cipher</h3>
		<p>For this, you’re going to need the encrypted word you got from step 2.</p>		
		<p>Below, you will see 4 rows of letters, divided into 2 subgroups of 2 rows:</p>
		<p style="text-align:center">
		ABCDEFGHIJKLM<br>
		NOPQRSTUVWXYZNOPQRSTUVWXY<br>
		-------------------------<br>
		ACEGIKMOQSUWYACEGIKMOQSUW<br>
		BDFHJLNPRTVXZBDFHJLNPRTVX
		<p>
		<p>The top row of this mechanism can be shifted to create a key. Shift the top row so that the letter A aligns with the letter on the 3rd/4th row that is the same letter as the second letter of the serial number.</p>
		<p>You can get rid of the excess letters that doesn’t fall under the top row for they won’t be used. Any letters that fall under the top row will be used to decrypt the encrypted word.</p>	
		<p>Split the encrypted word in half so you have 2 3 letter strings. Place the 2nd half under the 1st half. Each column is treated like a letter pair reading top to bottom. For each letter pair, do the following:</p>
		<ul>
		<li>Find the 1st letter in the pair in the 1st/2nd row.</li>
		<li>Find the 2nd letter in the pair in the 3rd/4th row.</li>
		<li>If the 2 letters are in the same column, the 1st letter will be replaced with the letter in the 1st/2nd row and the 2nd letter will be replaced with the letter in the 3rd/4th row.</li>
		<li>Otherwise, replace the 1st letter with the letter in the same row as the 1st but in the same column as the 2nd. And replace the 2nd letter with the letter in the same row as the 2nd but in the same column as the 1st.</li>
		</ul>
	</div>
            <div class="page-footer relative-footer">Page 3 of 4</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Gray Cipher</span>
            </div>
            <div class="page-content">
			
		<p>Read the letters by taking the 1st letter in each letter pair in reading order, then the 2nd letter to get your decrypted word.</p>
		<p style="text-align:center">
		Encrypted Word: DPMWFJ -> DW-PF-MJ<br>
		2nd Letter in SN: E
		</p>
		<table class="alpha">
		<tbody>
		<tr><th class='corner' colspan='2'></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th class='corner' colspan='10'></th>
		<tr><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th></tr>
		<tr><th class='corner' colspan='25'></th></tr>
		<tr><th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th><th>Y</th><th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th></tr>
		<tr><th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th><th>Z</th><th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th></tr>
		</tbody>
		</table>
		<p style="text-align:center">
		DW -> JK<br>
		PF -> AE<br>
		MJ -> CD<br>
		JK - AE - CD -> J A C K E D
		</p>
		

	</div>
            <div class="page-footer relative-footer">Page 4 of 4</div>
        </div>
</body>
</html>
