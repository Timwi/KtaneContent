<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Unfair Cipher — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .key-b-table {
            width: 100%;
        }
        .key-b-table th, .key-b-table td {
            padding: .1em .1em 0;
            text-align: center;
        }
        .floating-table {
            float: right;
            margin: .5em 0 0 1em;
        }
        ol, ul {
            padding-left: 2em;
        }
        ul.spaced li {
            margin: 1em 0;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Unfair Cipher.svg" class="diagram">
                <h2>On the Subject of Unfair Cipher</h2>
                <p class="flavour-text">It doesn’t play that fair anymore.</p>
                <p>This module has two displays. The display on top shows the encrypted message. There’s also a strip of LEDs which will light up to show the current stage.</p>
                <p>The display on the right can be clicked to toggle between showing the Module ID, in white, or strikes the module is keeping track of, in red. Both of these are shown in Roman numerals.</p>
                <p><strong><span style="color:red">For all operations involving STRIKES, always refer to the number in red on the module itself.</span></strong></p>
                <p>The module encrypts a string of four three-letter-long <em>instructions</em> with two <strong>Playfair Ciphers</strong>, using different <strong>keys</strong> for each. Enter the correct combination of inputs to disarm the module.</p>
                <ul><li>The order of encryptions is the following: <strong>Original -> Key A Encrypted -> Key C Encrypted -> Caesar Ciphered</strong>. Reverse the order to obtain the <strong>original</strong> instruction string.</li></ul>
                <h3>Key A</h3>
                <ol>
                    <li>Start with the bomb’s serial number.</li>
                    <li>
                        Transform each letter into its numerical equivalent (A=1, B=2, etc.).
                        <ul>
                            <li>Make a single string of digits.</li>
                            <li>Ignore the first character if its numerical equivalent is 20 or above.</li>
                        </ul>
                    </li>
                    <li>
                        Remove the last digit if either the 4th or the 5th characters of the serial are <strong>vowels.</strong>
                        <ul><li>You should only do this once, even in the case both characters are vowels.</li></ul>
                    </li>
                    <li>Convert this number into <strong><em>hexadecimal</em></strong>. Refer to <i>Appendix D3K2H3X</i> for instructions.</li>
                    <li>Now read the string of hexadecimal digits as a string of decimal digits and letters. Going from left to right, for every digit:
                        <ul>
                            <li>If the digit is followed by another digit and they form a number in the range 10–26, convert the pair into its alphabetical equivalent.</li>
                            <li>Otherwise, convert the single digit into its alphabetical equivalent, or skip it if it is a zero.</li>
                        </ul>
                    </li>
                    <li>Transform the Module ID, the number of port plates and the number of battery holders into their alphabetical equivalents.</li>
                    <li>Append these three characters at the end of the result of the previous conversion.</li>
                    <li><strong>This is Key A.</strong></li>
                </ol>
            </div>
            <div class="page-footer relative-footer">Page 1 of 4</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher</span>
            </div>
            <div class="page-content">
                <h3>Key B</h3>
                <p>Obtain Key B from the following table:</p>
                <table class='key-b-table'>
                    <tr><td style="background: #101010" colspan="2" rowspan="2"></td>
                        <th colspan="12" style="background: #303030; color: white">Month</th></tr>
                    <tr><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th></tr>
                    <tr><th rowspan="7" style="background: #303030; color: white">Day</th>
                        <th>Mon</th><td>ABDA</td><td>FEV</td><td>DBHC</td><td>BLD</td><td>DBIE</td><td>AFEF</td><td>AFCG</td><td>CQH</td><td>DEAI</td><td>FEAA</td><td>EFAB</td><td>DECC</td></tr>
                    <tr><th>Tue</th><td>ABDB</td><td>FEW</td><td>DBHD</td><td>BLE</td><td>DBIF</td><td>AFEG</td><td>AFCH</td><td>CQI</td><td>DEAA</td><td>FEAB</td><td>EFAC</td><td>DECD</td></tr>
                    <tr><th>Wed</th><td>ABDC</td><td>FEX</td><td>DBHE</td><td>BLF</td><td>DBIG</td><td>AFEH</td><td>AFCI</td><td>CQA</td><td>DEAB</td><td>FEAC</td><td>EFAD</td><td>DECE</td></tr>
                    <tr><th>Thu</th><td>ABDD</td><td>FEY</td><td>DBHF</td><td>BLG</td><td>DBIH</td><td>AFEI</td><td>AFCA</td><td>CQB</td><td>DEAC</td><td>FEAD</td><td>EFAE</td><td>DECF</td></tr>
                    <tr><th>Fri</th><td>ABDE</td><td>FEZ</td><td>DBHG</td><td>BLH</td><td>DBII</td><td>AFEA</td><td>AFCB</td><td>CQC</td><td>DEAD</td><td>FEAE</td><td>EFAF</td><td>DED</td></tr>
                    <tr><th>Sat</th><td>ABDF</td><td>FEBG</td><td>DBHH</td><td>BLI</td><td>DBIA</td><td>AFEB</td><td>AFCC</td><td>CQD</td><td>DEAE</td><td>FEAF</td><td>EFB</td><td>DEDA</td></tr>
                    <tr><th>Sun</th><td>ABDG</td><td>FEBH</td><td>DBHI</td><td>BLA</td><td>DBIB</td><td>AFEC</td><td>AFCD</td><td>CQE</td><td>DEAF</td><td>FET</td><td>EFBA</td><td>DEDB</td></tr>
                </table>
                <h3>Key C</h3>
                <p>Use a Playfair Cipher to encode Key A using Key B as the keyword. <strong>This is Key C.</strong></p>
                <p>Refer to <i>Appendix PL4YF4112 101</i> for instructions.</p>

                <h3>Solving — Step 1: Caesar Cipher</h3>
                <table class='floating-table'>
                    <tr>
                        <th style="background: #303030; color: white">Condition</th>
                        <th style="background: #303030; color: white">Operation</th>
                    </tr>
                    <tr>
                        <td>For every <strong>port type</strong></td>
                        <th>− 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>port plate</strong></td>
                        <th>+ 1</th>
                    </tr>
                    <tr>
                        <td>For every <strong>consonant</strong> in the serial number</td>
                        <th>+ 1</th>
                    </tr>
                    <tr>
                        <td>For every <strong>vowel</strong> in the serial number</td>
                        <th>− 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>lit</strong> indicator</td>
                        <th>+ 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>unlit</strong> indicator</td>
                        <th>− 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>battery</strong></td>
                        <th>− 1</th>
                    </tr>
                    <tr>
                        <td>No batteries</td>
                        <th>+ 10</th>
                    </tr>
                    <tr>
                        <td>No ports</td>
                        <th>× 2</th>
                    </tr>
                    <tr>
                        <td>31 or more modules</td>
                        <th>÷ 2</th>
                    </tr>
                </table>
                <p>Calculate an offset used for the Caesar Cipher. Start with 0 and perform all operations in the following table for each matching condition.</p>
                <p>In the division operation, drop any remainders.</p>
                <p>To <em>decipher</em> the message, shift every letter on the screen forwards by this many letters if the offset is negative, backwards if positive. Wrap back to the other side of the alphabet if you have to go backwards from <strong>A</strong> or forwards from <strong>Z</strong>.</p>
            </div>
            <div class="page-footer relative-footer">Page 2 of 4</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher</span>
            </div>
            <div class="page-content">
                <h3>Solving — Step 2: Playfair Ciphers</h3>
                <p>Use a Playfair cipher with Key C as the keyword to decrypt the string you just deciphered.</p>
                <p>Repeat this process once more, but with Key A as the keyword.</p>
                <p><strong>You now have the original message.</strong></p>

                <h3>Solving — Step 3: Executing the Instructions</h3>
                <p>The message consists of 4 instructions. Execute the instructions left to right.</p>
                <p>Tap the small screen on the right to toggle between showing Module ID or strikes. Strikes are shown in red. Both of these are in Roman numerals.</p>
                <h4>Instructions:</h4>
                <p>
                    ‘%’ refers to the modulo (remainder) operation.<br>
                    <strong>Inner Center</strong> refers to the white button in the middle.<br>
                    <strong>Outer Center</strong> refers to the grey triangular frame around the colored buttons.<br>
                    Refer to <i>Appendix PR1M3</i> for a list of prime numbers.
                </p>
                <ul>
                    <li><strong><em>PCR</em></strong>: Press the Red button.</li>
                    <li><strong><em>PCG</em></strong>: Press the Green button.</li>
                    <li><strong><em>PCB</em></strong>: Press the Blue button.</li>
                    <li><strong><em>SUB</em></strong>: Press <strong>Outer Center</strong> when the seconds digits on the timer match.</li>
                    <li>
                        <strong><em>MIT</em></strong>: Press <strong>Inner Center</strong> when the last digit on the timer matches <i>(m + c + s) % 10</i>, with <i>m</i> being the Module ID, <i>c</i> being the number of times a colored (R, G, B) button has been pressed since the last strike on this module <i>(or since the beginning if there are no strikes)</i> and <i>s</i> being the current stage, starting with 1.
                    </li>
                    <li><strong><em>PRN</em></strong>: Press <strong>Inner Center</strong> if Module ID % 20 is a prime number; otherwise, press Outer Center.</li>
                    <li><strong><em>CHK</em></strong>: Press <strong>Outer Center</strong> if Module ID % 20 is a prime number; otherwise, press Inner Center.</li>
                    <li>
                        <strong><em>BOB</em></strong>: Press <strong>Inner Center.</strong>
                        <ul>
                            <li>If there is a lit BOB as the only indicator on the bomb and two batteries in total, this <strong>instantly solves the module!</strong></li>
                        </ul>
                    </li>
                    <li>
                        <strong><em>REP</em></strong> or <strong><em>EAT</em></strong>: Repeat the last input, or press <strong>Inner Center</strong> if this is the first instruction.</li>
                    </li>
                    <li>
                        <strong><em>STR</em></strong> or <strong><em>IKE</em></strong>: Starting from <span style="color:red">Red</span> (0) at the top, count as many colored buttons clockwise as there are strikes and press the resulting button.
                    <ul>
                    <li>For these instructions, refer to the <span style="color:red">Strike Counter</span> on the small screen of the module itself.</li>
                    </ul>
                    </li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 3 of 4</div>
        </div>
        <div class="page page-bg-06">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher</span>
            </div>
            <div class="page-content">
                <table class='floating-table'>
                    <tr>
                        <th>DEC</th>
                        <th>HEX</th>
                    </tr>
                    <tr>
                        <th>0 - 9</th>
                        <th>0 - 9</th>
                    </tr>
                    <tr>
                        <th>10</th>
                        <th>A</th>
                    </tr>
                    <tr>
                        <th>11</th>
                        <th>B</th>
                    </tr>
                    <tr>
                        <th>12</th>
                        <th>C</th>
                    </tr>
                    <tr>
                        <th>13</th>
                        <th>D</th>
                    </tr>
                    <tr>
                        <th>14</th>
                        <th>E</th>
                    </tr>
                    <tr>
                        <th>15</th>
                        <th>F</th>
                    </tr>
                    <tr>
                        <th>16</th>
                        <th>10</th>
                    </tr>
                    <tr>
                        <th>26</th>
                        <th>1A</th>
                    </tr>
                    <tr>
                        <th>...</th>
                        <th>...</th>
                    </tr>
                </table>
                <h3>Appendix — D3K2H3X</h3>
                <p>Follow these steps to convert an integer to hexadecimal:</p>
                <ol>
                    <li>Divide the number by 16. Obtain the remainder and quotient.</li>
                    <li>Convert the remainder into a hexadecimal digit (see table).</li>
                    <li>Repeat these steps with the quotient as the new number. Keep repeating until the quotient is zero.</li>
                    <li>Reverse the order of the hexadecimal digits obtained.</li>
                    <li>Remove any leading zeroes.</li>
                </ol>

                <h3>Appendix — PR1M3</h3>
                <ul>
                    <li>Prime numbers (to 20): 2, 3, 5, 7, 11, 13, 17, 19</li>
                </ul>

                <h3>Appendix — PL4YF4112 101</h3>
                <ul class='spaced'>
                    <li>
                        Create a 5×5 matrix of letters. Start with your <b>keyword</b>
                        and fill the rest with the unused letters of the alphabet.
                        Each letter must occur only <b>once</b> in the matrix, so only add the first occurrence.
                        ‘J’ and ‘I’ are interchangeable.
                    </li>
                    <li>In the following text, use the instructions marked (d) when <em>decrypting</em> and those marked (e) when <em>encrypting</em>.</li>
                    <li>Split the <b>message</b> into character pairs. <em>If you cannot form a pair, add an <strong>‘X’</strong></em>. If the characters are the <em><strong>same</strong>, transform the second character into an <strong>‘X’</strong></em>. For each pair:
                        <ul>
                            <li>If the letters appear on the same row of your matrix, replace them with the letters to their immediate <em>left</em> (d)/<em>right</em> (e) respectively, wrapping around to the other side of the row if necessary.</li>
                            <li>If the letters are on the same column of your matrix, replace them with the letters immediately <em>above</em> (d)/<em>below</em> (e), wrapping to the other side if necessary.</li>
                            <li>If the letters are on different rows and columns, replace each of them with the letter on the same row but in the column of the other letter in the original pair.</li>
                        </ul>
                    </li>
                    <li>Drop any final X’s that don’t make sense and locate any I’s that should be J’s.</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 4 of 4</div>
        </div>
    </div>
</body>
</html>
