<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Rubik’s Cube — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/jquery.3.7.0.min.js"></script>
    <script>
        $(function() {
            let table = $(".interactive");
            let vstack = $("<div>").addClass("vstack").appendTo(table);
            let row1 = $("<div>").addClass("hstack").appendTo(vstack);
            let row2 = $("<div>").addClass("hstack").appendTo(vstack);
            let row3 = $("<div>").addClass("hstack").appendTo(vstack);
            const buttonText = ["▲", "▼", "0"];
            const U = ["0", "3", "6", "9", "C", "F", "I", "L", "O", "R", "U", "X"];
            const L = ["1", "4", "7", "A", "D", "G", "J", "M", "P", "S", "V", "Y"];
            const R = ["2", "5", "8", "B", "E", "H", "K", "N", "Q", "T", "W", "Z"];
            const col = [U,L,R];
            let offset = [0,0,0];
            let cell = $(".interactive table")[0].getElementsByTagName("td");

            function writeOffsetColumn(c) {
                for (r = 0; r < U.length; r++)
                    cell[r*5 + c].innerText = col[c][ (r + (U.length - offset[c])) % U.length ];
            }

            for (let c = 0; c < 3; c++) {
                $("<button>").text(buttonText[0]).appendTo(row1).click(function() {
                    offset[c] = Math.max(0, offset[c] - 1);
                    writeOffsetColumn(c);
                });
            }
            for (let c = 0; c < 3; c++) {
                $("<button>").text(buttonText[1]).appendTo(row2).click(function() {
                    offset[c] = Math.min(U.length, offset[c] + 1);
                    writeOffsetColumn(c);
                });
            }
            for (let c = 0; c < 3; c++) {
                $("<button>").text(buttonText[2]).appendTo(row3).click(function() {
                    offset[c] = 0;
                    writeOffsetColumn(c);
                });
            }

        });
    </script>
    <link rel="stylesheet" type="text/css" href="css/Modules/Rubik'sCube.css">
    <style>
        table.rubiks-cube { width: 50mm; }
        .hstack {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }
        .vstack {
            display: flex;
            flex-direction: column;
            align-items: start;
            justify-content: center;
        }
        button {
            font-size: 12px;
            font-weight: bold;
            width: 34px;
            margin: 1px;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Rubik’s Cube</span>
            </div>
            <div class="page-content">
                <img class="diagram" src="img/Component/Rubik's Cube.svg">

                <div class="float interactive">
                    <p class="caption">Table 1</p>
                    <table class="rubiks-cube">
                        <tr><th>U</th><th>L</th><th>F</th><th class="bar" colspan="2">Moves</th></tr>
                        <tr><td>0</td><td>1</td><td>2</td><td class="bar">L’</td><td>F’</td></tr>
                        <tr><td>3</td><td>4</td><td>5</td><td class="bar">D’</td><td>U’</td></tr>
                        <tr><td>6</td><td>7</td><td>8</td><td class="bar">U</td><td>B’</td></tr>
                        <tr><td>9</td><td>A</td><td>B</td><td class="bar">F</td><td>B</td></tr>
                        <tr><td>C</td><td>D</td><td>E</td><td class="bar">L</td><td>D</td></tr>
                        <tr><td>F</td><td>G</td><td>H</td><td class="bar">R’</td><td>U</td></tr>
                        <tr><td>I</td><td>J</td><td>K</td><td class="bar">U’</td><td>F</td></tr>
                        <tr><td>L</td><td>M</td><td>N</td><td class="bar">B’</td><td>L’</td></tr>
                        <tr><td>O</td><td>P</td><td>Q</td><td class="bar">B</td><td>R</td></tr>
                        <tr><td>R</td><td>S</td><td>T</td><td class="bar">D</td><td>L</td></tr>
                        <tr><td>U</td><td>V</td><td>W</td><td class="bar">R</td><td>D’</td></tr>
                        <tr><td>X</td><td>Y</td><td>Z</td><td class="bar">F’</td><td>R’</td></tr>
                    </table>
                </div>

                <div class="float">
                    <p class="caption">Table 2</p>
                    <table class="rubiks-cube">
                        <tr><th>Color</th><th class="bar">Number</th></tr>
                        <tr><td>Yellow</td><td class="bar">1</td></tr>
                        <tr><td>Blue</td><td class="bar">2</td></tr>
                        <tr><td>Red</td><td class="bar">3</td></tr>
                        <tr><td>Green</td><td class="bar">4</td></tr>
                        <tr><td>Orange</td><td class="bar">5</td></tr>
                        <tr><td>White</td><td class="bar">6</td></tr>
                    </table>
                </div>

                <h2>On the Subject of Rubik’s Cube</h2>
                <p class="flavour-text">Remember this impossible thing? Now it’s on a bomb. Have fun.</p>

                <p>
                    The bomb presents an unsolved Rubik’s cube. To disarm the module, solve the Rubik’s
                    cube. The following steps can be used to determine the sequence of moves necessary
                    to solve it. If you get lost, press the Reset button to return the cube to its original state.
                </p>

                <ul>
                    <li>Start with Table 1 on the right. Observe the color of the U, L, and F faces on the cube. Cycle each corresponding column down a number of rows as specified in Table 2.</li>
                    <li>Take the serial number, but eliminate the character at the position corresponding to the color of the D face (again, using Table 2).</li>
                    <li>Look up each remaining character of the serial number in the modified Table 1 to obtain two moves per character, or a total of 10 moves.</li>
                    <li>If the R face is red, green or blue, take both moves for each serial number character in order. Otherwise, first take every first move for each serial number character, then every second move for each character.</li>
                    <li>If the R face is red or yellow, change the first five moves to their opposites.</li>
                    <li>If the R face is green or white, reverse the order of all the moves.</li>
                    <li>Finally, perform the resulting sequence of moves on the cube.</li>
                </ul>

                <p>Clarifications:</p>

                <ul>
                    <li>F is the face with the Reset button. The faces visible from a direct view at the module are U, L and F.</li>
                    <li>The “color” of a face is the color of the sticker in the middle of that face.</li>
                    <li>A move is performed by rotating the corresponding face clockwise. A prime (’) indicates the opposite move (i.e. counter-clockwise).</li>
                </ul>

                <div class="footnote">
                    <hr>
                    <p>Faces: U = up, D = down, L = left, R = right, F = front, B = back</p>
                </div>
            </div>
            <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
    </div>
</body>
</html>
