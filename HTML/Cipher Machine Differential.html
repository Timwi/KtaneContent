<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Differential CM — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Differential CM</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Cipher Machine.svg" class="diagram">
                <h2>On the Subject of the Differential CM</h2>
                <p class="flavour-text">A machine that knows no bounds when it comes to ciphers.</p>
                <p>Turn the letter on screen A to a Value via the Value Table, modulo it by the length of the encrypted word. This is your Shift Offset.</p>
                <p>Shift the encrypted word to the left a number of times equal to the Shift Offset.</p>
                <p>If the Submit Button is white, follow the instructions under Encrypt Instructions. Otherwise follow the instructions under Decrypt Instructions.</p>
                <h4 class="centered">Encrypt Instructions</h4>
                <ul>
                    <li>1: Take the Nth digit on screen 1 and multiply it by 26.</li>
                    <li>2: Then take the alphabetic position (A1Z26) of the (N + 1)th letter of the encrypted word and subtract from it the alphabetic position (A1Z26) of the Nth letter of the encrypted word, modulo 26.</li>
                    <li>3: Sum the 2 numbers you got from steps 1 and 2 to get a 2 digit number. Append this number to any previous digits.</li>
                    <li>4: Repeat steps 1 - 3 for each digit displayed on screen 1.</li>
                    <li>5: Split the string of digits into 2 equal halves, placing the 2nd half of digits under the 1st half.</li>
                    <li>6: Let D be a string of letters, containing only the first letter of the encrypted word.</li>
                    <li>7: Read the Nth column top-to-bottom as a two-digit number.</li>
                    <li>8: Sum the alphabetic position (A1Z26) of the last letter of D and the number you got from step 7, modulo 26, and turn the resulting number into a letter (A1Y25Z0). Append this letter to D.</li>
                    <li>9: Repeat steps 7 - 8 for each column in the digit string.</li>
                    <li>10: Finally, shift the letters in D to the right by the Shift Offset to get your decrypted word.</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 1 of 3</div>
        </div>
         <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Differential CM</span>
            </div>
            <div class="page-content">
                <h4 class="centered">Decrypt Instructions</h4>
                <ul>
                    <li>1: Take the Nth digit on screen 1 and multiply it by 26.</li>
                    <li>2: Then take the alphabetic position (A1Z26) of the (N + 1)th letter of the encrypted word and subtract from it the alphabetic position (A1Z26) of the Nth letter of the encrypted word, modulo 26.</li>
                    <li>3: Sum the 2 numbers you got from steps 1 and 2 to get a 2 digit number. Write this number top to bottom, to the right of any previous numbers.</li>
                    <li>4: Repeat steps 1 - 3 for each digit displayed on screen 1.</li>
                    <li>5: Concatenate the top and bottom digits in that order to get a new digit string. Split this digit string into pairs of numbers.</li>
                    <li>6: Let D be a string of letters, containing only the first letter of the encrypted word.</li>
                    <li>7: Sum the alphabetic position (A1Z26) of the last letter of D and the Nth number pair, modulo 26, and turn the resulting number into a letter (A1Y25Z0). Append this letter to D.</li>
                    <li>8: Repeat step 7 for each number pair you got in step 5.</li>
                    <li>9: Finally, shift the letters in D to the right by the Shift Offset to get your decrypted word.</li>
                </ul>
                <h4 class="centered">Example 1</h4>
                <p class="centered">Encrypted Word: JOHMGBGE<br>Shift Offset: V → 87 → 7<br>Screen 1: 1023311<br>Using Encrypt Rules</p>
                <p class="centered">JOHMGBGE + 7 → EJOHMGBG</p>
                <p class="centered">
                    (26 * 1) + ((J - E) MOD 26) → 31<br>
                    (26 * 0) + ((O - J) MOD 26) → 05<br>
                    (26 * 2) + ((H - O) MOD 26) → 71<br>
                    (26 * 3) + ((M - H) MOD 26) → 83<br>
                    (26 * 3) + ((G - M) MOD 26) → 98<br>
                    (26 * 1) + ((B - G) MOD 26) → 47<br>
                    (26 * 1) + ((G - B) MOD 26) → 31
                </p>
                <table>
                    <tr><td>3</td><td>1</td><td>0</td><td>5</td><td>7</td><td>1</td><td>8</td></tr>
                    <tr><td>3</td><td>9</td><td>8</td><td>4</td><td>7</td><td>3</td><td>1</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 2 of 3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Differential CM</span>
            </div>
            <div class="page-content">
            <p class="centered">
                (E + 33) MOD 26 → 12 → L<br>
                (L + 19) MOD 26 → 5 → E<br>
                (E + 08) MOD 26 → 13 → M<br>
                (M + 54) MOD 26 → 15 → O<br>
                (O + 77) MOD 26 → 14 → N<br>
                (N + 13) MOD 26 → 1 → A<br>
                (A + 81) MOD 26 → 4 → D
            </p>
            <p class="centered">ELEMONAD + 7 → LEMONADE</p>
            <h4 class="centered">Example 2</h4>
            <p class="centered">Encrypted Word: KMVVSF<br>Shift Offset: R → 7 → 1<br>Screen 1: 01030<br>Using Decrypt Rules</p>
            <p class="centered">KMVVSF + 1 → MVVSFK</p>
            <p class="centered">
                (26 * 0) + ((V - M) MOD 26) → 09<br>
                (26 * 1) + ((V - V) MOD 26) → 26<br>
                (26 * 0) + ((S - V) MOD 26) → 23<br>
                (26 * 3) + ((F - S) MOD 26) → 91<br>
                (26 * 0) + ((K - F) MOD 26) → 05
            </p>
            <table>
                <tr><td>0</td><td>2</td><td>2</td><td>9</td><td>0</td></tr>
                <tr><td>9</td><td>6</td><td>3</td><td>1</td><td>5</td></tr>
            </table>
            <p class="centered">
                (M + 02) MOD 26 → 15 → O<br>
                (O + 29) MOD 26 → 18 → R<br>
                (R + 09) MOD 26 → 1 → A<br>
                (A + 63) MOD 26 → 12 → L<br>
                (L + 15) MOD 26 → 1 → A
            </p>
            <p class="centered">MORALA + 1 → AMORAL</p>    
            </div>
            <div class="page-footer relative-footer">Page 3 of 3</div>
        </div>
    </div>
</body>
</html>