<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>黄色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
        }
        .dark img.ondark {
            filter: invert(87%);
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">黄色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：黄色暗号</h2>
                <p class="flavour-text">「黄色い歓声が聞こえてくるよ！」 - そんなこと暗号は決して言わない。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中と下のディスプレーに暗号化された数字が表示される。</p>
                <p>ページ2には、上のディスプレーに別の暗号化された数字、真ん中のディスプレーに8文字の単語、下のディスプレーにダッシュ(-)で区切られた4つの数字が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：モービット暗号</h3>
                <p>最初に必要なことは、ページ1の真ん中と下及びページ2の上のディスプレーに表示された、3つの暗号化された数字を復号化することである。3つの数字を記載された順に連結させる。</p>
                <p>次にページ2の真ん中のディスプレーに表示された単語を取得し、単語の下に、アルファベットの昇順になるように1から8の番号を記入する。同率の英字がある場合、更にそれを読み順で振る。例：OPTIMISM -> 56813274</p>
                <p>そして、8桁のキーの真下に以下の文字列を記入する。</p>
                <p class="centered">
                    ...---xx<br>
                    .-x.-x.-
                </p>
                <p>今あるはずのものは、それぞれの数字がその下の記号に変換されて示されるキーである。</p>
                <p>暗号化された数字の全体を取得し、鍵を使用してドットとダッシュとXに変換する。これをモールス信号として読む。Xは英字同士のスペースを示す。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">黄色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">モールス信号表</h4>
                <img class="ondark" src="img/Morse Code/morse-signals.svg" style="width: 90%">
                <p>これで復号化された単語が手に入るはずである。これは、次のステップで使用するキーワードとなる。</p>
                <h4 class="centered">例</h4>
                <table style="text-align:center">
                    <tr><th>O</th><th>P</th><th>T</th><th>I</th><th>M</th><th>I</th><th>S</th><th>M</th></tr>
                    <tr><th>5</th><th>6</th><th>8</th><th>1</th><th>3</th><th>2</th><th>7</th><th>4</th></tr>
                    <tr><th>.</th><th>.</th><th>.</th><th>-</th><th>-</th><th>-</th><th>X</th><th>X</th></tr>
                    <tr><th>.</th><th>-</th><th>X</th><th>.</th><th>-</th><th>X</th><th>.</th><th>-</th></tr>
                </table>
                <p class="centered">
                    6 8 8 6 4 6 8 2 5 4 3 4 8 | . - . x . x . - x - . - . x - x . . x - - - x - . x | R E A C T I O N
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">黄色暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ2：トライフィド暗号</h3>
                <p>まずキーを作成する必要がある。そのためには、ステップ1の復号化されたキーワードを取得し重複する英字の2文字目以降を削除する。アルファベット全体の文字列を取得し、キーワードに表示された英字を削除する。</p>
                <p>バッテリーの本数が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>最後に、キーの真下に以下の段を配置する。</p>
                <p class="centered">
                    11111111122222222233333333<br>
                    11122233311122233311122233<br>
                    12312312312312312312312312
                </p>
                <p>ページ1の上のディスプレーにある暗号化された単語に対して、上記の先程作成したキーを用いて各英字を3桁の数字に変換する。その後、各段に6つの数字が入るようにその数字を分割する。</p>
                <p>数字を上から下、左から右へに読むことで新たな数列を獲得する。それから、先程作成したキーを用いて各3桁ごとにそれを英字に戻す。</p>
                <p>結果の文字列が新たな暗号化された単語となる。</p>
                <h4 class="centered">例</h4>
                <table class = "alpha">
                    <tr><th>B</th><th>D</th><th>F</th><th>G</th><th>H</th><th>J</th><th>K</th><th>L</th><th>M</th><th>P</th><th>Q</th><th>S</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>R</th><th>E</th><th>A</th><th>C</th><th>T</th><th>I</th><th>O</th><th>N</th></tr>
                    <tr><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th></tr>
                    <tr><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th><th>3</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th><th>3</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th></tr>
                    <tr><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th></tr>
                </table>
                <p class="centered">EEKZPE -> 312 312 131 233 211 312</p>
                <table style="text-align:center">
                    <tr><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th></tr>
                    <tr><th>1</th><th>3</th><th>1</th><th>2</th><th>3</th><th>3</th></tr>
                    <tr><th>2</th><th>1</th><th>1</th><th>3</th><th>1</th><th>2</th></tr>
                </table>
                <p class="centered">312 131 211 323 131 232 -> EKPIKY</p>
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">黄色暗号</span>
            </div>
            <div class="page-content">
                <h3>Step 3: ヒル暗号</h3>
                <p>ここでは、ステップ2の復号化された暗号化された単語とページ2の下のディスプレーにある4つの数字が必要になる。数字は「A-B-C-D」のように読む。</p>
                <p>まず、方程式の逆数Nを求める必要がある。方程式は次の通りとする：N((AD - BC) % 26) % 26 = 1</p>
                <p>Nを求めたら、4桁の数字を次のように配置する。</p>
                <table style="text-align:center">
                    <tr><th>D</th><th>-B</th></tr>
                    <tr><th>-C</th><th>A</th></tr>
                </table>
                <p>各数字にNを掛け、モジュロ26を求める(0から25の範囲になるまで、26を繰り返し引く)。</p>
                <p>暗号化された単語をペアに分割する。各ペアに対して以下の手順に従う。</p>
                <ul>
                <li>両方の英字を、アルファベット上の位置の数字に変換する。</li>
                    <li>一つ目の数字に左上の数字を掛ける。 </li>
                    <li>二つ目の数字に右上の数字を掛ける。</li>
                    <li>二つの数字を合計し、モジュロ26を求め、それを英字に戻すと最初の英字を獲得できる(Z = 0)。</li>
                    <li>一つ目の元の値(乗算する前の値)に左下の数字を掛ける。</li>
                    <li>二つ目の元の値(乗算する前の値)に右下の数字を掛ける。</li>
                    <li>二つの数字を合計し、モジュロ26を求め、それを英字に戻すと二番目の英字を獲得できる(Z = 0)。</li>
                </ul>
                <p>結果の文字列が、復号化された単語となる。</p>
                <h4 class="centered">例</h4>
                <table style="text-align:center">
                    <tr><th>7</th><th>4</th></tr>
                    <tr><th>25</th><th>21</th></tr>
                </table>
                <p class="centered"> N((7 * 21) - (4 * 25)) % 26 = 1 => N(47) % 26 = 1 => N(21) % 26 = 1 => 5(21) % 26 = 1</p>
                <table>
                    <tr><th>21</th><th>-4</th><th>* 5 =</th><th>105</th><th>-20</th><th>% 26 =</th><th>1</th><th>6</th></tr>
                    <tr><th>-25</th><th>7</th><th>* 5 =</th><th>-125</th><th>35</th><th>% 26 =</th><th>5</th><th>9</th></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">黄色暗号</span>
            </div>
            <div class="page-content">

                <p class="centered">
                    EK -> 5 11 <br>
                    PI -> 16 9 <br>
                    KY -> 11 25 <br>
                    (1 * 5) + (6 * 11) % 26 = 19 => S <br>
                    (5 * 5) + (9 * 11) % 26 = 20 => T <br>
                    (1 * 16) + (6 * 9) % 26 = 18 => R <br>
                    (5 * 16) + (9 * 9) % 26 = 5 => E <br>
                    (1 * 11) + (6 * 25) % 26 = 5 => E <br>
                    (5 * 11) + (9 * 25) % 26 = 20 => T <br>
                </p>

                <p>復号化された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>
</html>