<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>3×3 Yellow Cipher — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .page-footer::before { content: "Page "; }
        .page-footer::after { content: " of 4"; }
        table { text-align: center; }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">3×3 Yellow Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate%20Cipher.svg" class="diagram">
                <h2>On the Subject of 3×3 Yellow Ciphers</h2>
                <p class="flavour-text">This yellow is not mellow, as it will try to give you 2 threes and X you.</p>
                <p>This module contains 3 screens, a keyboard, 2 arrows, and a submit button that displays the current page you’re on.</p>
                <p>Pressing the left or right arrow takes the defuser to the previous or next page, wrapping around the last page. There are 3 pages.</p>
                <p>To disarm the module, decrypt a word using the following steps. Once you have the decrypted word, type it in using the keyboard. When you start typing, the screens go blank and the bottom screen will show what you are typing.</p>
                <p>
                    To clear your input, click one of the arrows.<br>
                    Once you are satisfied with your input, press the button labeled “SUB” to submit your answer. An incorrect submission will cause a strike but NOT reset the module.
                </p>
                <p>When the instructions say to modulo a value by N, repeatedly add or subtract N to that value to keep the value within the range of 0 to (N - 1).</p>
                <h3>Step 1: 3×3 Matrix Inverse Calculation</h3>
                <p>
                    Depending on what screen(s) are shown in white, you will need to calculate the inverse of exactly one of the matrices.
                    In the order of top to bottom on pages 2 and 3, the displayed numbers correspond to 2 separate matrices, with elements labeled a-i in reading order.
                    On page 1, the middle and bottom screens display the determinants of the matrices from pages 2 and 3 respectively.<br>
                    <strong>You do NOT need to calculate the determinant of a 3×3 matrix.</strong>
                </p>
                <p>If on page 2, all the screens are white, or the middle screen of page 1 is white, the inverse of the second matrix MUST be calculated. Otherwise, the inverse of the first matrix MUST be calculated.</p>
                <p>Using the determinant of the matrix needed to be inversed, modulo 26, as E, calculate for D. <i>Instructions to calculate for D can be found on page 4.</i></p>
                <p>Then calculate the following 9 values in THIS order:</p>
                <ol style="column-count: 3">
                    <li>(e * i) - (f * h)</li>
                    <li>(f * g) - (d * i)</li>
                    <li>(d * h) - (e * g)</li>
                    <li>(c * h) - (b * i)</li>
                    <li>(a * i) - (c * g)</li>
                    <li>(b * g) - (a * h)</li>
                    <li>(b * f) - (c * e)</li>
                    <li>(c * d) - (a * f)</li>
                    <li>(a * e) - (b * d)</li>
                </ol>
            </div>
            <div class="page-footer relative-footer">1</div>
        </div>
        <div class="page page-bg-07">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">3×3 Yellow Cipher</span>
            </div>
            <div class="page-content">
                <p>
                    Multiply those 9 values by D, and modulo all of them by 26.
                    Write the results of this top to bottom, left to right to obtain the inverse matrix.<br>
                    <i>An example to obtain the inverse matrix can be found on page 3.</i>
                </p>
                <p>For the next step, if you have the inverse matrix of the matrix mentioned on the module via page numbers, use the <strong>THAT</strong> inverse matrix instead to decrypt. Otherwise, use the matrix displayed on that page.</p>
                <h3>Step 2: 3×3 Hill Cipher, The Actual Calculation</h3>
                <p>Using the matrices, start by splitting the top display of page 1 into sets of 3 letters. Convert these sets of 3 letters into their alphabetic positions, with Z equating to 0.</p>
                <p>If the last digit of the serial number is greater than 4, calculate using the matrix on page 3, then the matrix on page 2. Otherwise, calculate using the matrix on page 2, then the matrix on page 3.</p>
                <p>For each set, to use the 3×3 matrix, multiply the values of the first column in that matrix by the first value of the set of 3. Repeat this with the second column and the second value of the set of 3, and again with the third column and the third value of the set of 3. Add the multiplied values, row by row to get 3 new values. Modulo each of the 3 new values by 26 and then if this is the last matrix calculated, convert these back to their alphabetic counterparts, with 0 equating to Z.</p>
                <h3>Example: Multiplying With A 3×3 Matrix</h3>
                <p class="centered">Obtained Matrix:</p>
                <table class="centered">
                    <tr><td>1</td><td>17</td><td>7</td></tr>
                    <tr><td>16</td><td>19</td><td>16</td></tr>
                    <tr><td>0</td><td>24</td><td>17</td></tr>
                </table>
                <p class="centered">Set of 3 values: <strong>12, 1, 2</strong></p>
                <p class="centered">
                    12*1 + 1*17 + 2*7 = 43<br>
                    12*16 + 1*19 + 2*16 = 243<br>
                    12*0 + 1*24 + 2*17 = 58
                </p>
                <p class="centered">New set of 3 values, after modulo 26: <strong>17, 9, 6</strong></p>
            </div>
            <div class="page-footer relative-footer">2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">3×3 Yellow Cipher</span>
            </div>
            <div class="page-content">
                <h3>Example: Calculating The Inverse Matrix</h3>
                <p class="centered">Obtained Matrix:</p>
                <table class="centered">
                    <tr><td>19</td><td>24</td><td>15</td></tr>
                    <tr><td>21</td><td>1</td><td>15</td></tr>
                    <tr><td>9</td><td>2</td><td>14</td></tr>
                </table>
                <p class="centered">Determinant of Matrix: -3625</p>
                <p class="centered">E = -3625 mod 26 = 15; D = 7</p>
                <p class="centered">
                    (1 * 14) - (15 * 2) = -16, (-16 * 7) mod 26 = 18<br>
                    (15 * 9) - (21 * 14) = -159, (-159 * 7) mod 26 = 5<br>
                    (21 * 2) - (1 * 9) = 33, (33 * 7) mod 26 = 23<br>
                    (15 * 2) - (24 * 14) = -306, (-306 * 7) mod 26 = 16<br>
                    (19 * 14) - (15 * 9) = 131, (131 * 7) mod 26 = 7<br>
                    (24 * 9) - (19 * 2) = 178, (178 * 7) mod 26 = 24<br>
                    (24 * 15) - (15 * 1) = 345, (345 * 7) mod 26 = 23<br>
                    (15 * 21) - (19 * 15) = 30, (30 * 7) mod 26 = 2<br>
                    (19 * 1) - (24 * 21) = -485, (-485 * 7) mod 26 = 11
                </p>
                <p class="centered">Inverse Matrix:</p>
                <table class="centered">
                    <tr><td>18</td><td>16</td><td>23</td></tr>
                    <tr><td>5</td><td>7</td><td>2</td></tr>
                    <tr><td>23</td><td>24</td><td>11</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">3</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">3×3 Yellow Cipher</span>
            </div>
            <div class="page-content">
                <h3>Determining D - Logic Way</h3>
                <ol>
                    <li>Set up 7 variables: A, B, Q, R, T1, T2, T3.</li>
                    <li>Set A equal to 26.</li>
                    <li>Set B equal to E.</li>
                    <li>Q is equal to A / B, rounded down.</li>
                    <li>R is equal to A modulo B.</li>
                    <li>Set T1 equal to 0.</li>
                    <li>Set T2 equal to 1.</li>
                    <li>T3 is equal to T1 - (T2 * Q).</li>
                    <li>Set A equal to B.</li>
                    <li>Set B equal to R.</li>
                    <li>Q is equal to A / B, rounded down.</li>
                    <li>R is equal to A modulo B.</li>
                    <li>Set T1 equal to T2.</li>
                    <li>Set T2 equal to T3.</li>
                    <li>T3 is equal to T1 - (T2 * Q).</li>
                    <li>Repeat steps 9 - 15 until R is equal to 0, stopping at step 12.</li>
                    <li>Your D is equal to T3 mod 26.</li>
                </ol>
                <h3>Determining D - Brute Force Way</h3>
                <ol>
                    <li>Find I in this equation: ((I * 26) + 1) modulo E = 0</li>
                    <li>D is equal to: ((I * 26) + 1) / E
                        <ul><li>A. This can be used as well: (D * E) modulo 26 = 1</li></ul>
                    </li>
                </ol>
                <h3>Determining D - Look Up Way</h3>
                <p>
                    Doing inverse calculations can take a while, so here’s this table to help<br>
                    (You’re going to need this... Right?):
                </p>
                <table class="centered">
                    <tr><th>E</th><td>3</td><td>5</td><td>7</td><td>9</td><td>11</td><td>15</td><td>17</td><td>19</td><td>21</td><td>23</td><td>25</td></tr>
                    <tr><th>D</th><td>9</td><td>21</td><td>15</td><td>3</td><td>19</td><td>7</td><td>23</td><td>11</td><td>5</td><td>17</td><td>25</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">4</div>
        </div>
    </div>
</body>
</html>