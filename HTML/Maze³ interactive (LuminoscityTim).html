<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Maze³ — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/jquery.3.1.1.min.js"></script>
    <script>

    $(function() {
        let mazeGroup = document.getElementById("themaze");
        var mazeRotation = 0;

        let mazesvg = $(".mazesvg");

        $("button.rotate-left").click(function() {
            rotateMaze(false);
        });
        $("button.rotate-right").click(function() {
            rotateMaze(true);
        });

        function makeSVG(tag, attrs) {
            var el= document.createElementNS('http://www.w3.org/2000/svg', tag);
            for (var k in attrs)
                el.setAttribute(k, attrs[k]);
            return el;
        }

        for (let r = 0; r < 12; r++) {
            for (let c = 3; c < 6; c++) {
                let ring = makeSVG("circle", {
                    class: "dot", cx:(50 + c*100), cy:(50 + r*100),
                    r:13.5, fill: "none", stroke: "#000", "stroke-width": 2
                });
                mazesvg[0].appendChild(ring);
                if (c != 4 || r % 3 != 1) {
                    let dot = makeSVG("circle", {
                        class: "dot", cx:(50 + c*100), cy:(50 + r*100),
                        r:10.5, fill: "#000"
                    });
                    mazesvg[0].appendChild(dot);
                }
            }
        }
        for (let r = 3; r < 6; r++) {
            for (let c = 0; c < 12; c++) {
                if (c >= 3 && c < 6) { continue; }
                let ring = makeSVG("circle", {
                    class: "dot", cx:(50 + c*100), cy:(50 + r*100),
                    r:13.5, fill: "none", stroke: "#000", "stroke-width": 2
                });
                mazesvg[0].appendChild(ring);
                if (r != 4 || c % 3 != 1) {
                    let dot = makeSVG("circle", {
                        class: "dot", cx:(50 + c*100), cy:(50 + r*100),
                        r:10.5, fill: "#000"
                    });
                    mazesvg[0].appendChild(dot);
                }
            }
        }
        mazesvg[0].appendChild(makeSVG("circle", { class: "cdot", cx:450, cy:150, r:11, fill: "#00F" }));
        mazesvg[0].appendChild(makeSVG("circle", { class: "cdot", cx:150, cy:450, r:11, fill: "#FF0" }));
        mazesvg[0].appendChild(makeSVG("circle", { class: "cdot", cx:450, cy:450, r:11, fill: "#F00" }));
        mazesvg[0].appendChild(makeSVG("circle", { class: "cdot", cx:750, cy:450, r:11, fill: "#0F0" }));
        mazesvg[0].appendChild(makeSVG("circle", { class: "cdot", cx:450, cy:750, r:11, fill: "#F0F" }));
        mazesvg[0].appendChild(makeSVG("circle", { class: "cdot", cx:450, cy:1050, r:11, fill: "#F70" }));

        for (let r = 0; r < 12; r++) {
            for (let c = 3; c < 6; c++) {
                let cell = makeSVG("rect", {
                    class: "highlightable mcell", x:(c*100), y:(r*100 + (r == 0 ? 2 : 0)),
                    width:100, height:(r == 0 ? 98 : 100), fill:"transparent"
                });
                mazesvg[0].appendChild(cell);
            }
        }
        for (let r = 3; r < 6; r++) {
            for (let c = 0; c < 12; c++) {
                if (c >= 3 && c < 6) { continue; }
                let cell = makeSVG("rect", {
                    class: "highlightable mcell", x:(c*100 + (c == 0 ? 2 : 0)),
                    y:(r*100),
                    width:(c == 0 ? 98 : 100), height:100, fill:"transparent"
                });
                mazesvg[0].appendChild(cell);
            }
        }

        function rotateMaze(clockwise) {
            if (clockwise) {
                mazeRotation += 1;
            } else {
                mazeRotation -= 1;
            }

            mazeGroup.style.transform = `rotate(${mazeRotation * 90}deg)`;
            console.log(mazeGroup.style.transform, mazeRotation);
        }
    });
    </script>
    <style>
        table {
            margin: 1em auto;
            width: 80%;
            border: none;
        }

        td {
            width: 25%;
        }
        .dark svg path, .dark circle.dot {
            filter: invert(100%) contrast(90%);
        }

        .empty {
            border: none;
        }

        .mazeimg {
            width: 90%;
            margin: 0 auto;
            display: block;
            margin-top: .5cm;
        }

        .bold {
            font-weight: bold;
        }
        .underline {
            text-decoration: underline;
        }
        .italics {
            font-style: italic;
        }

        img.center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        img.example-image {
            width: 60%;
        }
        .appendix-reference {
            font-style: italic;
        }

        .solid {
            border-color: black;
            border: 1px solid black;
        }

        .rotate-left, .rotate-right {
            font-size: 30px;
            height: 38px;
            width: 68px;
            background-size: 60px 110px;
            background-position: 2px -38px;
            background-repeat: no-repeat;
        }
        .rotate-left {
            background-image: url('data:image/svg+xml,<svg viewBox="-1 -1.4 24.6 13.3" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="black" stroke-width="2.8" stroke-linecap="round"><path d="M0.6 5.2l2.1 4.5 4.8-3.1M3.2 7.8s1.2-7 9.5-6.8c8.1 0 8.9 8.1 8.9 7.5"/></svg>');
        }
        .rotate-right {
            background-image: url('data:image/svg+xml,<svg viewBox="-2 -.5 25.6 12.2" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="black" stroke-width="2.8" stroke-linecap="round"><path d="M21.6 4.7l-3.2 5-4.2-3.3m4.2 1.4S18 .8 10 1C2 1 1.1 9.1 1.1 9.1"/></svg>');
        }
        .maze-wall {
            fill: none;
            stroke: #000;
            stroke-width: 6;
        }
        .maze-fold {
            fill: none;
            stroke: #000;
            stroke-width: 3;
        }
        .themaze {
            transition: 0.5s;
        }

    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Maze³</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Maze³.svg" class="diagram">
                <h2>On the Subject of Mazes³</h2>
                <p class="flavour-text">It’s like the original, but on a whole ’nother scale!</p>

                <p class="appendix-reference" id="appendix-reference">See Appendix A for indicator identification reference.<br>See Appendix B for battery identification reference.<br>See Appendix C for port identification reference.</p>

                <ul>
                    <li>This module consists of a cube with nine
                        dots on each face and a circular
                        ENTER button in the top left corner of
                        the module.</li>
                    <li>To disarm the module, move the white light by pressing the edges of the front-facing side of the cube
                        without hitting any walls,
                        pressing ENTER when its position coincides with three correct central
                        dots. Hitting a wall or pressing ENTER at an incorrect dot will
                        cause a strike.</li>
                    <li>Look at the table below to determine which dots are required to be submitted to disarm the module. The dots must be entered in the order that they appear on
                        the table, from top to bottom. Note that not all colored dots are shown as colored
                        in the module.
                    </li>
                    <li>
                        To find where the walls are, use the
                        colored dots visible in the module and their location and
                        match those to the maze
                        printed below. Note that the maze may be rotated.
                    </li>
                </ul>

                <br>

                <table class="solid">
                    <tr class="solid">
                        <td class="empty"></td>
                        <th>1 OR LESS</th>
                        <th>2, 3 or 4</th>
                        <th>5 OR MORE </th>
                    </tr>
                    <tr class="solid">
                        <th>Batteries</th>
                        <td class="solid">Magenta</td>
                        <td class="solid">Orange</td>
                        <td class="solid">Blue</td>
                    </tr>
                    <tr class="solid">
                        <th>Indicators</th>
                        <td class="solid">Red</td>
                        <td class="solid">Yellow</td>
                        <td class="solid">Green</td>
                    </tr>
                    <tr class="solid">
                        <th>Ports</th>
                        <td class="solid">Blue</td>
                        <td class="solid">Magenta</td>
                        <td class="solid">Orange</td>
                    </tr>
                </table>
            </div>
           <div class="page-footer relative-footer">Page 1 of 2</div>
        </div>
        <div class="page page-bg-03" style="width: 260mm; height: 250mm">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Maze³</span>
            </div>
            <div class="page-content">
                <button class="rotate-left floating"></button>
                <button class="rotate-right floating"></button>
                <div class="themaze" id="themaze" style="width: 170mm; margin: auto">
                    <svg class="mazesvg" viewbox="0 0 900 1200" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-miterlimit="5.5">
                        <path class="maze-fold" stroke-dasharray="4,4" d="M300 4v1194h300V4z"/>
                        <path class="maze-fold" stroke-dasharray="4,4" d="M4 300h894v300H4z"/>
                        <path class="maze-fold" stroke-dasharray="4,4" d="M300 900h300"/>
                        <path class="maze-wall" d="M300 2v100h200v-100"/>
                        <path class="maze-wall" d="M300 100v100h300"/>
                        <path class="maze-wall" d="M300 300h100v-100"/>
                        <path class="maze-wall" d="M600 100v200h200"/>
                        <path class="maze-wall" d="M4 400v-100h200"/>
                        <path class="maze-wall" d="M500 300v100h300"/>
                        <path class="maze-wall" d="M500 400v100"/>
                        <path class="maze-wall" d="M700 400v100h200"/>
                        <path class="maze-wall" d="M600 500h100v100"/>
                        <path class="maze-wall" d="M800 500v100h100"/>
                        <path class="maze-wall" d="M4 600h96v-100h100v-100"/>
                        <path class="maze-wall" d="M100 400h300"/>
                        <path class="maze-wall" d="M300 500h100v300h-100v100"/>
                        <path class="maze-wall" d="M200 600h100v100h100"/>
                        <path class="maze-wall" d="M500 600v100h100"/>
                        <path class="maze-wall" d="M400 800h200v100"/>
                        <path class="maze-wall" d="M400 900v100h200"/>
                        <path class="maze-wall" d="M300 1000h100v200"/>
                        <path class="maze-wall" d="M500 1000v100h100"/>
                        <path class="maze-wall" d="M300 1100v100"/>
                    </svg>
                </div>
            </div>
           <div class="page-footer relative-footer">Page 2 of 2</div>
        </div>
    </div>
</body>
</html>