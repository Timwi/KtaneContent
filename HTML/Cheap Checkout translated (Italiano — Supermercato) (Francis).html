<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Supermercato — Keep Talking and Nobody Explodes Mod</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/Modules/Cheap Checkout.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/ruleseed.js"></script>
    <script>
        let Prices = [
            // Original 34 items
            "Bast. di Zucc.,3.51,Dolciumi",
            "Calzini,6.97,Altro",
            "Lozione,7.97,Prodotti da Bagno",
            "Formaggio,4.49,Latticini",
            "Mentine,6.39,Dolciumi",
            "Gelat. d'Uva,2.98,Dolciumi",
            "Miele,8.25,Dolciumi",
            "Zucchero,2.08,Dolciumi",
            "Soda,2.05,Dolciumi",
            "Fazzoletti,3.94,Prodotti da Bagno",
            "Pane Bianco,2.43,Cereali",
            "Ol. di Canola,2.28,Olii",
            "Senape,2.36,Altro",
            "Deodorante,3.97,Prodotti da Bagno",
            "Latte Bianco,3.62,Latticini",
            "Pass. di Pom.,2.30,Verdura",
            "Leccalecca,2.61,Dolciumi",
            "Biscotti,2.00,Dolciumi",
            "Tovaglioli di Carta,9.46,Prodotti da Bagno",
            "Tè,2.35,Acqua",
            "Ch. di Caffè,7.85,Altro",
            "Maionese,3.99,Olii",
            "Latte al Cioccolato,5.68,Latticini",
            "Punch alla F.,2.08,Dolciumi",
            "Patatine,3.25,Olii",
            "Shampoo,4.98,Prodotti da Bagno",
            "Dentifricio,2.50,Prodotti da Bagno",
            "Burro d'Arachidi,5.00,Proteinee",
            "Gomma,1.12,Dolciumi",
            "Bottigliette d'Acqua,9.37,Acqua",
            "Spaghetti,2.92,Cereali",
            "Barra di Cioccolato,2.10,Dolciumi",
            "Ketchup,3.59,Altro",
            "Cereali,4.19,Cereali",

            // New rule seed items
            "Uova,2.67,Proteinee",
            "Fagioli Stufati,1.14,Proteine",
            "Noccioline,5.98,Proteine",
            "Yogurt,2.72,Latticini",
            "Yogurt Greco,3.47,Latticini",
            "Burro,5.86,Latticini",
            "Spazzolino,2.24,Prodotti da Bagno",
            "Medicina,3.73,Prodotti da Bagno",
            "Zuppa,1.99,Altro",
            "Sapone,3.97,Prodotti da Bagno",
            "Pretzel,2.98,Cereali",
            "Popcorn,2.50,Cereali",
            "Avena,7.98,Cereali",
            "Riso,2.02,Cereali",
            "Farina,3.49,Cereali",
            "Liquirizia,1.98,Dolciumi",
            "Crostata,3.98,Dolciumi",
            "Torta,9.98,Dolciumi",
            "Orsi di Gomma,7.98,Dolciumi",
            "Relish,2.74,Verdura",
            "Tovaglioli,1.09,Prodotti da Bagno",
            "Cerotti,1.11,Prodotti da Bagno",
            "Carte Francesi,2.13,Altro",
            "Carne Secca,1.23,Altro",
            "Gelato,4.99,Latticini",
            "Insalata Mista,2.47,Verdura",
            "Bagel,4.20,Cereali",
            "Olio Vegetale,2.89,Olii",
            "Batterie,4.49,Other",
            "Gusci di Taco,5.01,Grain",
            "Candeggina,6.90,Other",
            "Bicarbonato di Sodio,0.33,Other",
            "Buste di Carta,1.07,Other",
            "Fogli da Stampante,4.49,Other",
            "Pannolini,6.96,Care Product",
            "Gel Doccia,1.63,Care Product",
            "Struccante,1.02,Care Product",
            "DVD Vuoti,9.00,Other",
            "Smalto per Unghie ,3.13,Care Product",
            "Fusilli,2.92,Grain",
            "Tagliatelle,2.92,Grain",
            "Spirelli,2.92,Grain",
            "Penne,2.92,Grain",
            "Olio Motore,3.36,Olii",
            "Prezzemolo,0.69,Spice",
            "Salvia,1.75,Spice",
            "Rosmarino,3.19,Spice",
            "Timo,2.89,Spice",
            "Pepe Bianco,2.49,Spice",
            "Coriandolo,0.99,Spice",
            "Origano,1.59,Spice",
            "Curcuma,3.45,Spice",
            "Masala,4.99,Spice",
            "Zafferano,12.79,Spice",
            "Cannella,2.40,Spice",
            "Pepe di Caienna,11.27,Spice",
            "Radice di Zenzero,1.00,Spice",
            "Sale,3.98,Spice",
            "Sesamo,3.19,Spice",
            "Estratto di Vaniglia,11.82,Spice",
            "Vino Rosso,20.90,Acqua",
            "Vino Bianco,18.60,Acqua",
            "Birra in Pacco da 12,10.49,Acqua",
            "Birra in Pacco da 6,5.79,Acqua",
            "Aceto,2.50,Other",
        ];

        let PricesLB = [
            // Original 12 weight based items
            "Tacchino,2.98,Proteine",
            "Pollo,1.99,Proteine",
            "Stèk,4.97,Proteine",
            "Carne di Maiale,4.14,Proteine",
            "Lattuga,1.10,Verdura",
            "Potatoes,0.68,Verdura",
            "Pomodori,1.80,Frutta",
            "Broccoli,1.39,Verdura",
            "Arance,0.80,Frutta",
            "Limoni,1.74,Frutta",
            "Banane,0.87,Frutta",
            "Pompelmo,1.08,Frutta",

            // New rule seed weight based items
            "Cipolle,1.82,Verdura",
            "Pancetta,5.52,Proteine",
            "Mele,1.32,Frutta",
            "Uva,2.98,Frutta",
            "Pesce,9.99,Proteine",
            "Angurie,0.32,Frutta",
            "Carote,0.77,Verdura",
            "Ciliegie,3.21,Frutta",
            "Prugne,1.99,Frutta",
            "Zucche,1.38,Frutta",
            "Avocado,2.23,Frutta",
            "Prosciutto,2.88,Proteine",
            "Salsiccie,3.88,Proteine",
            "Mais,1.14,Verdura",
            "Pere,1.74,Frutta",
            "Finocchio,3.17,Verdura",
            "Salame,1.69,Proteine",
            "Carne Macinata,2.36,Proteine",
            "Aglio,0.97,Verdura",
            "Tofu,3.11,Proteine",
            "Salmone,21.55,Proteine",
        ];

        let SundayValue = 215;
        let MondayPercent = 85;
        let TuesdayExcludedDigit = -1;
        let WednesdayLargeOrSmall = true;
        let WednesdayViceVersa = true;
        let ThursdayOddItems = true;
        let ThursdayPercent = 50;
        let FridayPercent = 125;
        let SaturdayPercent = 65;

        function toDollars(intDollars) {
            const stringDollars = intDollars.toString();
            if (intDollars < 100) return "0." + intDollars;
            else return stringDollars.substring(0, stringDollars.length - 2) + "." + stringDollars.substring(stringDollars.length - 2);
        }

        function toRelativePercent(absolutePercent) {
            if (absolutePercent > 100) return `costano il ${absolutePercent - 100}% in più`;
            else if (absolutePercent == 50) return "sono a metà prezzo";
            else return `costano il ${100 - absolutePercent}% in meno`;
        }

        function setDefaultRules(rng) {
            setRules(rng);
        }

        function setRules(rng) {
            var prices, pricesLB;
            if (rng.seed == 1)
            {
                prices = Prices.slice(0, 34);
                pricesLB = PricesLB.slice(0, 12);
            }
            else
            {
                prices = rng.shuffleFisherYates(Prices.slice(0)).slice(0, 34);
                pricesLB = rng.shuffleFisherYates(PricesLB.slice(0)).slice(0, 12);

                for (var [index, item] of prices.entries()) {
                    var split = item.split(",");
                    var intDollars = parseInt(split[1].replace(".", ""));
                    intDollars += rng.next(-10, 11);
                    split[1] = toDollars(intDollars);
                    prices[index] = split.join(",");
                }

                for (var [index, item] of pricesLB.entries()) {
                    var split = item.split(",");
                    var intDollars = parseInt(split[1].replace(".", ""));
                    intDollars += rng.next(-10, 11);
                    split[1] = toDollars(intDollars);
                    pricesLB[index] = split.join(",");
                }

                SundayValue = rng.next(50, 301);
                MondayPercent = rng.next(10, 100);
                TuesdayExcludedDigit = rng.next(-1, 3);
                WednesdayLargeOrSmall = rng.next(0, 2) == 1;
                WednesdayViceVersa = rng.next(0, 2) == 1;
                ThursdayOddItems = rng.next(0, 2) == 1;
                ThursdayPercent = rng.next(25, 76);
                FridayPercent = rng.next(50, 201);
                SaturdayPercent = rng.next(50, 201);
            }

            const seededStrings = [
                toDollars(SundayValue),
                toRelativePercent(MondayPercent),
                TuesdayExcludedDigit == -1 ? "" : ` esclusa la cifra nelle ${["unità", "decine", "centinaia"][TuesdayExcludedDigit]} place`,
                WednesdayLargeOrSmall ? "più grande" : "più piccola",
                WednesdayLargeOrSmall ? "più piccola" : "più grande",
                WednesdayViceVersa ? " e viceversa" : "",
                ThursdayOddItems ? "dispari" : "pari",
                toRelativePercent(ThursdayPercent),
                toRelativePercent(FridayPercent),
                toRelativePercent(SaturdayPercent)
            ];

            const seededSpans = document.querySelectorAll("span.rule-seeded");
            for (const [index, seededSpan] of seededSpans.entries()) {
                seededSpan.textContent = seededStrings[index];
            }

            const rows = Array.from(document.querySelectorAll(".page-bg-02 tr:nth-child(n+2), .page-bg-03 tr"));
            for (const [index, itemString] of prices.concat(pricesLB).sort().entries()) {
                const children = rows[index % rows.length].children;
                const item = itemString.split(",");

                children[0].textContent = item[0];
                children[1].textContent = `$${item[1]}${pricesLB.includes(itemString) ? " a lb" : "" }`;
                children[2].textContent = item[2];
            }
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Supermercato</span>
            </div>
            <div class="page-content">
                <img class="diagram" src="img/Component/Cheap Checkout.svg">
                <h2>A proposito di Supermercati</h2>
                <p class="flavour-text">Chi diamine fa la spesa in un momento come questo?</p>
                <ul>
                    <li>Vi è una lista della spesa con dei prodotti da acquistare, si possono vedere con i tasti freccia.</li>
                    <li>Sopra la lista, si trova il totale pagato dal cliente.</li>
                    <li>Aggiungi i prezzi di tutti i prodotti nella lista, applicando i saldi in base all'attuale giorno della settimana.</li>
                    <li>A certi prodotti va applicato il loro peso prima del saldo.</li>
                    <li>Se il cliente ha pagato abbastanza denaro, devi solo inserire la quantità giusta di resto che deve ricevere il cliente utilizzando i tasti sul modulo e poi premere "invia".</li>
                    <li>Altrimenti, se il cliente ha sottopagato, premi invia senza resto per avvisare il cliente. Aspetta che il cliente offra un nuovo totale poi calcola il resto da dare.</li>
                    <li>Dopo che hai premuto il tasto invia, il resto sarà azzerato.</li>
                </ul>
                <h3>Glossario</h3>
                <ul>
                    <li>Il prezzo di un prodotto è il suo prezzo prima che siano applicati saldi.</li>
                    <li>I prodotti a prezzo fisso non variano il loro prezzo in base al peso.</li>
                    <li>Una radice numerica si calcola sommando tutte le cifre di un numero e iterando il processo sul nuovo numero finché non hai una sola cifra.</li>
                    <li>Nell'arrotondamento commerciale, se la cifra usata per arrotondare è 5 o maggiore, il numero è arrotondato per eccesso, altrimenti lo è per difetto.</li>
                </ul>

                <h3>Saldi:</h3>
                <div style="font-style: italic; font-size: 13px">Il giorno della settimana è la data sul computer del disinnescatore quando si attiva il modulo.</div>

                <em>Domenica Dorata</em>
                <div class="sale">Tutti i prodotti a prezzo fisso contenenti una S nei loro nomi costano $<span class="rule-seeded">2.15</span> n più.</div>

                <em>Lunedì Lunatico</em>
                <div class="sale">Il primo, terzo e sesto prodotto nella lista della spesa <span class="rule-seeded">costano il 15% in meno</span>.</div>

                <em>Martedì Malleabile</em>
                <div class="sale">Calcola la radice numerica del prezzo del prodotto senza le cifre decimali<span class="rule-seeded"></span>. Aggiungi quella quantità di dollari al prezzo del prodotto. Fallo solo per prodotti a prezzo fisso.</div>

                <em>Mercoledì Meraviglioso</em>
                <div class="sale">Cambia ogni occorrenza della cifra <span class="rule-seeded">più grande</span> digit in the price to the <span class="rule-seeded">più piccola</span> nel prezzo a quella<span class="rule-seeded"> e viceversa</span>.</div>

                <em>Giovedì Gioioso</em>
                <div class="sale">Tutti i prodotti in posizioni <span class="rule-seeded">dispari</span> nella lista della spesa <span class="rule-seeded">sono a metà prezzo</span>.</div>

                <em>Venerdì Verace</em>
                <div class="sale">Tutti i frutti <span class="rule-seeded">25% more</span> per pound.</div>

                <em>Sabato Sdolcinato</em>
                <div class="sale">Tutti i dolciumi <span class="rule-seeded">35% off</span>.</div>
            </div>
            <div class="page-footer relative-footer">Pagina 1 di 3</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Supermercato</span>
            </div>
            <div class="page-content">
                <h3>Prezzi:</h3>
                <div style="font-style: italic; font-size: 14px">I prezzi vanno sempre mantenuti in dollari, ad esempio, $0.68 anziché 68¢. Tutti i prezzi vanno arrotondati alla seconda cifra decimale. Arrotonda commercialmente dopo il calcolo del prezzo e dopo l'applicazione del saldo. (N.B.: i prodotti non sono in ordine alfabetico.)</div>
                <div class="hstack">
                    <table>
                        <tr><th>Item</th><th>Price</th><th>Category</th></tr>
                        <tr><td>Bananas</td><td>$0.87 a lb</td><td>Frutta</td></tr>
                        <tr><td>Broccoli</td><td>$1.39 a lb</td><td>Verdura</td></tr>
                        <tr><td>Bast. di Zucc.</td><td>$3.51</td><td>Dolciumi</td></tr>
                        <tr><td>Canola Olii</td><td>$2.28</td><td>Olii</td></tr>
                        <tr><td>Cereali</td><td>$4.19</td><td>Cereali</td></tr>
                        <tr><td>Formaggio</td><td>$4.49</td><td>Latticini</td></tr>
                        <tr><td>Pollo</td><td>$1.99 a lb</td><td>Proteine</td></tr>
                        <tr><td>Barra di Cioccolato</td><td>$2.10</td><td>Dolciumi</td></tr>
                        <tr><td>Latte al Cioccolato</td><td>$5.68</td><td>Latticini</td></tr>
                        <tr><td>Ch. di Caffè</td><td>$7.85</td><td>Altro</td></tr>
                        <tr><td>Biscotti</td><td>$2.00</td><td>Dolciumi</td></tr>
                        <tr><td>Deodorante</td><td>$3.97</td><td>Prodotti da Bagno</td></tr>
                        <tr><td>Punch alla F.</td><td>$2.08</td><td>Dolciumi</td></tr>
                        <tr><td>Gelat. d'Uva</td><td>$2.98</td><td>Dolciumi</td></tr>
                        <tr><td>Pompelmo</td><td>$1.08 a lb</td><td>Frutta</td></tr>
                        <tr><td>Gomma</td><td>$1.12</td><td>Dolciumi</td></tr>
                        <tr><td>Miele</td><td>$8.25</td><td>Dolciumi</td></tr>
                    </table>
                    <table>
                        <tr><th>Item</th><th>Price</th><th>Category</th></tr>
                        <tr><td>Mentine</td><td>$6.39</td><td>Dolciumi</td></tr>
                        <tr><td>Senape</td><td>$2.36</td><td>Altro</td></tr>
                        <tr><td>Arance</td><td>$0.80 a lb</td><td>Frutta</td></tr>
                        <tr><td>Tovaglioli di Carta</td><td>$9.46</td><td>Prodotti da Bagno</td></tr>
                        <tr><td>Pass. di Pom.</td><td>$2.30</td><td>Verdura</td></tr>
                        <tr><td>Burro d'Arachidi</td><td>$5.00</td><td>Proteine</td></tr>
                        <tr><td>Carne di Maiale</td><td>$4.14 a lb</td><td>Proteine</td></tr>
                        <tr><td>Patatine</td><td>$3.25</td><td>Olii</td></tr>
                        <tr><td>Potatoes</td><td>$0.68 a lb</td><td>Verdura</td></tr>
                        <tr><td>Shampoo</td><td>$4.98</td><td>Prodotti da Bagno</td></tr>
                        <tr><td>Calzini</td><td>$6.97</td><td>Altro</td></tr>
                        <tr><td>Soda</td><td>$2.05</td><td>Dolciumi</td></tr>
                        <tr><td>Spaghetti</td><td>$2.92</td><td>Cereali</td></tr>
                        <tr><td>Stèk</td><td>$4.97 a lb</td><td>Proteine</td></tr>
                        <tr><td>Zucchero</td><td>$2.08</td><td>Dolciumi</td></tr>
                        <tr><td>Tè</td><td>$2.35</td><td>Acqua</td></tr>
                        <tr><td>Fazzoletti</td><td>$3.94</td><td>Prodotti da Bagno</td></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Pagina 2 di 3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Supermercato</span>
            </div>
            <div class="page-content">
                <div class="hstack">
                    <table>
                        <tr><td>Ketchup</td><td>$3.59</td><td>Altro</td></tr>
                        <tr><td>Limoni</td><td>$1.74 a lb</td><td>Frutta</td></tr>
                        <tr><td>Lattuga</td><td>$1.10 a lb</td><td>Verdura</td></tr>
                        <tr><td>Leccalecca</td><td>$2.61</td><td>Dolciumi</td></tr>
                        <tr><td>Lozione</td><td>$7.97</td><td>Prodotti da Bagno</td></tr>
                        <tr><td>Maionese</td><td>$3.99</td><td>Olii</td></tr>
                    </table>
                    <table>
                        <tr><td>Pomodori</td><td>$1.80 a lb</td><td>Frutta</td></tr>
                        <tr><td>Dentifricio</td><td>$2.50</td><td>Prodotti da Bagno</td></tr>
                        <tr><td>Tacchino</td><td>$2.98 a lb</td><td>Proteine</td></tr>
                        <tr><td>Bottigliette d'Acqua</td><td>$9.37</td><td>Acqua</td></tr>
                        <tr><td>Pane Bianco</td><td>$2.43</td><td>Cereali</td></tr>
                        <tr><td>Latte Bianco</td><td>$3.62</td><td>Latticini</td></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Pagina 3 di 3</div>
        </div>
    </div>
</body>
</html>
