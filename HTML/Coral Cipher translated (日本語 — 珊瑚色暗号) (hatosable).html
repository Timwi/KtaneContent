<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>珊瑚色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
        }
        .tablea {
            font-size: 14px;
        }
        .tableb {
            font-size: 20px;
            width: 100%;
        }
        p.center { text-align:center; }
    </style>
</head>
<body>
<div class="section">
    <div class="page page-bg-01">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：珊瑚色暗号</h2>
            <p class="flavour-text">コーラルにより、この暗号は強化されています。 - エア</p>

            <p>モジュールは、3つのディスプレー、キーボード、左右の矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
            <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
            <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーにキーワード、下のディスプレーには数字が表示される。</p>
            <p>ページ2には、上のディスプレーに別のキーワードが表示される。</p>
            <p>以下のルールに従って単語を解読する。</p>
            <h3>ステップ1：プリッシー暗号</h3>
            <p>1ページ目の真ん中のディスプレーからキーワードを取り出し、重複する文字を削除する。アルファベット全体を取り出し、キーワードに表示されている文字をすべて削除する。</p>
            <p>ポートの個数が奇数である場合、キーワードの末尾にアルファベットを配置する。そうでない場合、キーワードの先頭にアルファベットを配置する。その後、そのキーを半分に分割し、後半のキーを前半のキーの真下に配置する。</p>
            <p>シリアルナンバーの四番目の文字(A = 1,B = 2...Z = 26)を13で割った余りをオフセットとして開始し、暗号化された単語の各文字ごとに以下の処理を実行する。</p>
            <ul>
                <li>キーの中から暗号化された単語のN番目の文字を見つける。</li>
                <li>その場所からオフセットの値だけ左に移動する。左端は同じ段の右端と繋がっている。</li>
                <li>到達した英字の真上/真下にある英字が新たな暗号化された英字である。</li>
                <li>オフセットと結果の英字の和を13で割った余りを求める。これが新しいオフセットである。</li>
            </ul>
            <h4 style="text-align:center">例</h4>
            <p class="center">
                暗号化された単語：NKUICV<br>
                真ん中のディスプレー：EARNEST<br>
                ポートの個数：2<br>
                キー：EARNSTBCDFGHIJKLMOPQUVWXYZ<br>
                オフセット：V -> 22 -> 9
            </p>

        </div>
        <div class="page-footer relative-footer">ページ 1/4</div>
    </div>

    <div class="page page-bg-02">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <p class="center" style="font-family: 'Special Elite'">
             EARNSTBCDFGHI<br>
             JKLMOPQUVWXYZ
         </p>
            <p class="center">
                N -> C -> U オフセット：9 + 21 -> 30 -> 4<br>
                K -> X -> G オフセット：4 + 7 -> 11<br>
                U -> W -> F オフセット：11 + 6 -> 17 -> 4<br>
                I -> D -> V オフセット：4 + 22 -> 26 -> 0<br>
                C -> C -> U オフセット：0 + 21 -> 21 -> 8<br>
                V -> J -> E
            </p>
            <p class="center">
                新たな暗号化された単語：UGFVUE
            </p>
            <h3>ステップ2：AMSCO転置</h3>
            <p>1ページ目の下のディスプレーにある数字キーを取り、キーの列に収まるように、その真下に読み順で4つの「セル」を置く。</p>
            <p>シリアルナンバーの一番目の文字(A = 10,B = 11...Z = 35)が奇数の場合、各セル内に入れられる文字列の長さは読み順で{1, 2, 1, 2}である。そうでない場合、各セル内に入れられる文字列の長さは読み順で{2, 1, 2, 1}である。</p>
            <p>各セルを文字列の長さと同じ長さのダッシュで埋める。数字の昇順で、その真下にあるセル内の各ダッシュを、ステップ1で取得した暗号化された単語の各文字に置き換えて配置する。その後、文字を読み順で読み、新しい暗号化された単語を取得する。</p>
            <h4 style="text-align:center">例</h4>
            <p class="center">
                暗号化された単語：UGFVUE<br>
                キー：231<br>
                文字列の長さ：1212
            </p>
            <table>
                <tr>
                    <td>2</td>
                    <td>3</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>-</td>
                    <td>--</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>--</td>
                    <td class='empty'></td>
                    <td class='empty'></td>
                </tr>
            </table>
            <table>
                <tr>
                    <td>2</td>
                    <td>3</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>G</td>
                    <td>UE</td>
                    <td>U</td>
                </tr>
                <tr>
                    <td>FV</td>
                    <td class='empty'></td>
                    <td class='empty'></td>
                </tr>
            </table>
            <p class="center">
                新たな暗号化された単語：GUEUFV
            </p>
        </div>
        <div class="page-footer relative-footer">ページ 2/4</div>
    </div>
    <div class="page page-bg-03">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">珊瑚色暗号</span>
        </div>
        <div class="page-content">

            <h3>ステップ3：GROMARK暗号</h3>
            <p>ここでは、ステップ2で取得した暗号化された単語と2ページ目の上のディスプレーに表示されたキーが必要になる。</p>
            <p>キーワードの下に、アルファベットの昇順で数字を記入する。同じ英字がある場合、それらは読み順で数字を記入する。これが数字キーである。</p>
            <p>キーワードを取得し、最初に出現した英字以外の重複する英字を削除する。アルファベットの文字列全体を取り出し、キーワードに表示されている英字をすべて削除する。</p>
            <p>ポートの個数を4で割った余りが2以上の場合、キーワードの末尾にアルファベットを配置する。そうでない場合、キーワードの先頭にアルファベットを配置する。これがアルファベットキーである。</p>
            <p>キーの列が合うように、ステップ3の数字キーの真下にアルファベットキーを読み順で記入する。アルファベットキーを数字の昇順で縦に読み、最終的なアルファベットキーを取得する。アルファベットキーの真下に通常のアルファベットの文字列を記入する。</p>
            <p>新しい数字キーを作成する。この数字キーは、先頭3桁が元の数字キーであり、その末尾にある3桁が追加される。その3桁は数字キーの先頭2桁の和を10で割った余り、先頭から2番目の2桁の和を10で割った余り…のようにして求める。</p>
            <p>暗号化された単語の各英字に対して、以下の処理を行う。</p>
            <ul>
                <li>暗号化された単語のN番目の文字を上段から探す。</li>
                <li>数字キーのN番目の数字だけ左に移動する。</li>
                <li>その真下にある英字が、復号された英字である。</li>
            </ul>
            <h4 style="text-align:center">例</h4>
            <p class="center">
                暗号化された単語：GUEUFV
                キーワード：IMAGINED
                ポートの個数：2
            </p>
            <p class="center" style="font-family: 'Special Elite'">
                IMAGINED<br>
                57146832
            </p>

        </div>
        <div class="page-footer relative-footer">ページ 3/4</div>
    </div>
    <div class="page page-bg-04">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <table>
                <tr><td>5</td><td>7</td><td>1</td><td>4</td><td>6</td><td>8</td><td>3</td><td>2</td></tr>
                <tr><td>B</td><td>C</td><td>F</td><td>H</td><td>J</td><td>K</td><td>L</td><td>O</td></tr>
                <tr><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td></tr>
                <tr><td>X</td><td>Y</td><td>Z</td><td>I</td><td>M</td><td>A</td><td>G</td><td>N</td></tr>
                <tr><td>E</td><td>D</td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td><td class='empty'></td></tr>
            </table>
            <p class="center">
                最終的なアルファベットキー：FRZOWNLVGHSIBPXEJTMCQYDKUA
            </p>
            <p class="center">
                数字キー：571 -> 571283
            </p>
            <p class="center" style="font-family: 'Special Elite'">
             FRZOWNLVGHSIBPXEJTMCQYDKUA<br>
             ABCDEFGHIJKLMNOPQRSTUVWXYZ
         </p>
            <p class="center">
                G, 5 -> O -> D<br>
                U, 7 -> T -> R<br>
                E, 1 -> X -> O<br>
                U, 2 -> D -> W<br>
                F, 8 -> M -> S<br>
                V, 3 -> W -> E<br>
            </p>
            <p class="center">
             復号された単語：DROWSE
            </p>
            <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>

            <p>入力を消去するには、いずれかの英字をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>

            <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>

        </div>
        <div class="page-footer relative-footer">ページ 4/4</div>
    </div>
</div>
</body>
</html>