<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>IKEA — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script>

    const mazeGroups = [];
    const mazeRotations = {};
    function setupAnimations() {
        var mazeID = [ "mazeA", "mazeB", "mazeC", "mazeD", "mazeE" ]
        for (let i = 0; i < 5; i++) {
            const maze = document.getElementById(mazeID[i]);
            mazeGroups[i] = maze;
            maze.addEventListener("click", () => clickMaze(i));
            // maze.style.transformOrigin = `${2 + 145 * (i % 5) + 62.5}px ${21 + 150 * Math.floor(i / 5) + 62.5}px`
            mazeRotations[i] = 0;
        }
    }

    function clickMaze(index) {
        if (document.querySelector("#rotate-left").checked) {
            mazeRotations[index]--;
        } else {
            mazeRotations[index]++;
        }

        const maze = mazeGroups[index];
        maze.style.transform = `rotate(${mazeRotations[index] * 90}deg)`;
        console.log(maze.style.transform, mazeRotations[index]);
    }

    function resetRotations() {
        for (let i = 0; i < 5; i++) {
            mazeRotations[i] = 0;
            const maze = mazeGroups[i];
            maze.style.transform = `rotate(${mazeRotations[i] * 90}deg)`;
            console.log(maze.style.transform, mazeRotations[i]);
        }
    }
    </script>
    <style>
        table {
            margin: 1em auto;
        }
        img.maze-image {
            width: 30%;
            transition: transform 0.5s;
        }
        .dark .maze-image { filter: invert(85%) hue-rotate(180deg) saturate(500%); }
        img.start_stop {
            width: 5.5mm;
            position: relative;
            top: -1mm;
        }
        div.maze_label {
            position: relative;
            height: 1.5mm;
            font-size: 6mm;
        }
    </style>
</head>
<body onload="setupAnimations()">
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">IKEA</span>
            </div>
            <div class="page-content">
                <img src="img/Component/IKEA.svg" class="diagram">
                <h2>On the Subject of IKEA</h2>
                <p class="flavour-text">I came in for a table, and left with a lamp, a mattress, and a bomb...</p>
                <ul>
                <li>Four buttons are Brand Buttons, and one is the Product Button; use the Product Button with Table 1 to determine which Direction Order to use.</li>
                <li>Assign Brand Buttons directions using Table 2 below. The first button found on the word list gets the first direction in Direction Order, the second on the list gets the second direction, etc. The Product Button does not get a direction.</li>
                <li>Assign Brand Buttons a bit value of 1 if its background is yellow and a 0 if its background is blue.</li>
                <li>Create a number in binary using the bits from the Brand Buttons, with the first in Direction Order being the most significant digit and the last being the least sigificant, then translate it to decimal.</li>
                <li>Use the created number with Table 3 to determine which store you are in,
                    then defuse the module by going from <img class="start_stop" src="img/IKEA/mazeStart.svg"/>(green circle)
                    to <img class="start_stop" src="img/IKEA/mazeStop.svg"/>(red square) using the Brand Buttons.</li>
                <li>You may press the Swedish flag to reset your position back to <img class="start_stop" src="img/IKEA/mazeStart.svg"/>.</li>
                <li>Hitting a wall or pressing the Product Button will cause a strike and reset
                    your position back to <img class="start_stop" src="img/IKEA/mazeStart.svg"/>.</li></ul>
                <h3>Table 1</h3>
                <table><tr>
                <th>Product</th><th>Direction Order</th></tr><tr>
                <td>Bed</td><td>N, E, W, S</td></tr><tr>
                <td>Cabinet</td><td>S, E, W, N</td></tr><tr>
                <td>Chair</td><td>N, E, S, W</td></tr><tr>
                <td>Curtains</td><td>W, N, S, E</td></tr><tr>
                <td>Desk</td><td>N, W, E, S</td></tr><tr>
                <td>Fan</td><td>E, N, S, W</td></tr><tr>
                <td>Quilt</td><td>W, E, N, S</td></tr><tr>
                <td>Towel</td><td>S, W, E, N</td></tr></table>
            </div>
           <div class="page-footer relative-footer">Page 1 of 3</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">IKEA</span>
            </div>
            <div class="page-content">
                <h3>Table 2</h3>
                <table><tr>
                <th>Product Button Background Color</th><th>Word List</th></tr><tr>
                <th>Blue</th><td>Meatball, Bowl, Cheese, Wizard, Shoe, Boot, Candy, Puppy, Headphones, Shirt, Paint, Color, Unicorn, Raccoon, Octagon, Dragon</td></tr><tr>
                <th>Yellow</th><td>Color, Candy, Octagon, Meatball, Dragon, Wizard, Cheese, Shoe, Raccoon, Unicorn, Paint, Shirt, Puppy, Boot, Headphones, Bowl</td></tr></table>
                <h3>Table 3</h3>
                <table><tr>
                <th>Button Number</th><th>Store</th></tr><tr>
                <td>0</td><td>Store A, rotated 180°</td></tr><tr>
                <td>1</td><td>Store C, rotated 90° clockwise</td></tr><tr>
                <td>2</td><td>Store D, rotated 90° counterclockwise</td></tr><tr>
                <td>3</td><td>Store A, rotated 90° clockwise</td></tr><tr>
                <td>4</td><td>Store E</td></tr><tr>
                <td>5</td><td>Store B, rotated 180°</td></tr><tr>
                <td>6</td><td>Store E, rotated 90° clockwise</td></tr><tr>
                <td>7</td><td>Store B, rotated 90° counterclockwise</td></tr><tr>
                <td>8</td><td>Store C, rotated 180°</td></tr><tr>
                <td>9</td><td>Store D, rotated 90° clockwise</td></tr><tr>
                <td>10</td><td>Store A, rotated 90° counterclockwise</td></tr><tr>
                <td>11</td><td>Store E, rotated 180°</td></tr><tr>
                <td>12</td><td>Store C, rotated 90° counterclockwise</td></tr><tr>
                <td>13</td><td>Store E, rotated 90° counterclockwise</td></tr><tr>
                <td>14</td><td>Store B, rotated 90° clockwise</td></tr><tr>
                <td>15</td><td>Store D, rotated 180°</td></tr></table>
            </div>
           <div class="page-footer relative-footer">Page 2 of 3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">IKEA</span>
            </div>
            <div class="page-content">
                <h3>Stores</h3>
                <div style="position: relative; height: 0; left:25mm; top: -6mm">(Click to rotate)</div>
                <div style="position: relative; height: 0; left:85mm; top: 1.5mm">
                    <button onclick="resetRotations()">Reset Rotations</button>
                </div>
                <div>
                    <input type="radio" id="rotate-left" name="rotate" value="left">
                    <label for="rotate-left">Rotate 90° Counterclockwise</label>
                </div>
                <div>
                    <input type="radio" id="rotate-right" name="rotate" value="right" checked>
                    <label for="rotate-right">Rotate 90° Clockwise</label>
                </div>
                <div class="maze_label" style="left: 26mm">A</div>
                <div class="maze_label" style="left: 82mm; top: -1.5mm">B</div>
                <div class="maze_label" style="left: 139mm; top: -3mm">C</div>
                <img id="mazeA" src="img/IKEA/mazeA_rot.svg" class="maze-image" />
                &nbsp;
                <img id="mazeB" src="img/IKEA/mazeB_rot.svg" class="maze-image" />
                &nbsp;
                <img id="mazeC" src="img/IKEA/mazeC_rot.svg" class="maze-image" />

                <div style="height: 7mm"></div>
                <div class="maze_label" style="left: 26mm; top: -4mm">D</div>
                <div class="maze_label" style="left: 82mm; top: -5.5mm">E</div>
                <img id="mazeD" src="img/IKEA/mazeD_rot.svg" class="maze-image" />
                &nbsp;
                <img id="mazeE" src="img/IKEA/mazeE_rot.svg" class="maze-image" />

                <p style="position: relative; left: 130mm; top: -40mm; height: 0">
                    <img class="start_stop" src="img/IKEA/mazeStart.svg"/> = Start. <br>
                    <img class="start_stop" src="img/IKEA/mazeStop.svg"/> = End.
                </p>
                <h2>English-to-Swedish Dictionary</h2>
                <p>Here are some helpful words to know when traveling:</p>

                <table>
                    <tr><th>English</th><th>Swedish</th><th>English</th><th>Swedish</th></tr>
                    <tr><td>Bed</td><td>SÄNG</td><td>Headphones</td><td>HÖRLURAR</td></tr>
                    <tr><td>Boot</td><td>KÄNGA</td><td>Meatball</td><td>KÖTTBULLE</td></tr>
                    <tr><td>Bowl</td><td>SKÅL</td><td>Octagon</td><td>ÅTTAHÖRNING</td></tr>
                    <tr><td>Cabinet</td><td>SKÅP</td><td>Paint</td><td>MÅLA</td></tr>
                    <tr><td>Candy</td><td>GODIS</td><td>Puppy</td><td>VALP</td></tr>
                    <tr><td>Chair</td><td>STOL</td><td>Quilt</td><td>TÄCKE</td></tr>
                    <tr><td>Cheese</td><td>OST</td><td>Raccoon</td><td>TVÄTTBJÖRN</td></tr>
                    <tr><td>Color</td><td>FÄRG</td><td>Shirt</td><td>SKJORTA</td></tr>
                    <tr><td>Curtains</td><td>GARDINER</td><td>Shoe</td><td>SKO</td></tr>
                    <tr><td>Desk</td><td>SKRIVBORD</td><td>Towel</td><td>HANDDUK</td></tr>
                    <tr><td>Dragon</td><td>DRAKE</td><td>Unicorn</td><td>ENHÖRNING</td></tr>
                    <tr><td>Fan</td><td>FLÄKT</td><td>Wizard</td><td>TROLLKARL</td></tr>
                </table>
                <p>Fun fact: The Swedish flag features a yellow Nordic cross on a blue background!</p>
            </div>
            <div class="page-footer relative-footer">Page 3 of 3</div>
        </div>
    </div>
</body>
</html>
