<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>鳥子色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
            font-family:'Special Elite';
        }
        .alpha th{
         color:orangered;
        }
        .tablea {
            font-size: 14px;
        }
        .tableb {
            font-size: 20px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">鳥子色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：鳥子色暗号</h2>
                <p class="flavour-text">この暗号を解くことができる者だけが「とりのこ」されている。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で4ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中と下のディスプレーに数字が表示される。</p>
                <p>ページ2には、上と真ん中と下のディスプレーに6文字の単語が表示される。ページ3も同様の内容である。</p>
                <p>ページ4には、上と真ん中のディスプレーに暗号化された文字列が表示され、下のディスプレーに7桁の数字が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>
                <h3>ステップ1：グランプレ暗号</h3>
                <p>2ページ目の上、真ん中、下、3ページ目の上、真ん中、下の順にキーワードを取り出し、それぞれの真下に書き込み、
                 6×6の行列を作る。この行列の上と左に1~6の数字を記入する。</p>
                <p>1ページ目の真ん中のディスプレーと下のディスプレーの数字は暗号化されたキーワードである。真ん中のディスプレーの各数字を行、下のディスプレーの各数字を列として扱い、行列の各数字のペアの交点を使用して、復号されたキーワードを取得する。これをキーワードAと呼ぶ。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    真ん中のディスプレー：3265<br>
                    下のディスプレー：3325
                </p>

            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">鳥子色暗号</span>
            </div>
            <div class="page-content">
                <table>
                    <tr><td class="corner"></td><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr>
                    <tr><th>1</th><td>C</td><td>O</td><td>N</td><td>V</td><td>E</td><td>X</td></tr>
                    <tr><th>2</th><td>F</td><td>R</td><td>O</td><td>Z</td><td>E</td><td>N</td></tr>
                    <tr><th>3</th><td>J</td><td>U</td><td>M</td><td>P</td><td>E</td><td>D</td></tr>
                    <tr><th>4</th><td>S</td><td>Q</td><td>U</td><td>A</td><td>W</td><td>K</td></tr>
                    <tr><th>5</th><td>L</td><td>I</td><td>G</td><td>H</td><td>T</td><td>S</td></tr>
                    <tr><th>6</th><td>B</td><td>A</td><td>K</td><td>E</td><td>R</td><td>Y</td></tr>
                </table>

                <p class="centered">
                    33 -> M<br>
                    23 -> O<br>
                    62 -> A<br>
                    55 -> T
                </p>
                <p class="centered">
                    キーワードA：MOAT
                </p>
                <h3>ステップ2：VIC電話暗号</h3>
                <p>4ページ目の上のディスプレーと真ん中のディスプレーを順に連結する。この表を使って、各文字を一連の数字に変換する。</p>
                <table>
                    <tr class="centered">
                        <td>1<br>ABC</td>
                        <td>2<br>DEF</td>
                        <td>3<br>GHI</td>
                    </tr>
                    <tr class="centered">
                        <td>4<br>JKL</td>
                        <td>5<br>MNO</td>
                        <td>6<br>PQR</td>
                    </tr>
                    <tr class="centered">
                        <td>7<br>ST</td>
                        <td>8<br>UV</td>
                        <td>9<br>WX</td>
                    </tr>
                    <tr class="centered">
                        <td class="corner"></td>
                        <td>0<br>YZ</td>
                        <td class="corner"></td>
                    </tr>
                </table>
                <p>変換するには、表からその英字を見つけ、その真上にある数字をX回繰り返すことで置き換える。Xはその英字が属するグループ内の位置である。これを各英字に行い、暗号化された数字を取得する。</p>
            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">鳥子色暗号</span>
            </div>
            <div class="page-content">
                <p>4ページ目の下のディスプレーの末尾3桁を取得し、先程のステップで取得した暗号化された数字と同じ長さになるまで3桁の数字を繰り返す。これがキー文字列である。</p>
                <p>暗号化された数字とキー文字列の各桁について、暗号化された数字からキーの数字を減算し、10で割った余りを求め、新しい暗号化された数字を取得する。</p>
                <p>ステップ1で書き留めたキーワードを取得して読み順に連結し、アルファベットキーを作成する。最初に出現したものを除き、重複する英字を削除する。</p>
                <p>空の3段10列チェッカーボードを作成する。列に0~9のラベルをつける。4ページ目の下のディスプレーにある先頭4桁に含まれるラベルの列の1段目のセルを除外する。4ページの下のディスプレーにある先頭2桁を2段目のラベルに追加する。4ページ目の下のディスプレーにある3桁目と4桁目を3段目のラベルに追加する。
                残りの26個のセルにアルファベットキーを読み順で配置する。</p>
                <p>暗号化された数字を英字に戻す。最初の数字が4ページ目の下のディスプレーの先頭4桁のいずれかにある場合、数字をペアで使用し、「1桁目が段で2桁目が列」とみなして使用し、英字を取得する。そうでない場合、そのまま1段目から対応する位置にある英字を使用する。</p>
                <p>求めた英字は別のキーワードとなる。これをキーワードBと呼ぶ。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化されたキーワード：GYUGDW JYMXMU<br>
                    下のディスプレー：2037325<br>
                    アルファベットキー：CONVEXFRZJUMPDSQAWKLIGHTBY
                </p>
                <p class="centered">
                    GYUGDWJYMXMU -> 3083294059958
                </p>
                <table>
                    <tr><td>3</td><td>0</td><td>8</td><td>3</td><td>2</td><td>9</td><td>4</td><td>0</td><td>5</td><td>9</td><td>9</td><td>5</td><td>8</td></tr>
                    <tr><td>3</td><td>2</td><td>5</td><td>3</td><td>2</td><td>5</td><td>3</td><td>2</td><td>5</td><td>3</td><td>2</td><td>5</td><td>3</td></tr>
                    <tr><td>0</td><td>8</td><td>3</td><td>0</td><td>0</td><td>4</td><td>1</td><td>8</td><td>0</td><td>6</td><td>7</td><td>0</td><td>5</td></tr>
                </table>
                <p class="centered">
                 新たな暗号化された数字：0830041806705
             </p>
               
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">鳥子色暗号</span>
            </div>
            <div class="page-content">
                <table>
                    <tr><td class="corner"></td><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr>
                    <tr><th class="corner"></th><td> </td><td>C</td><td> </td><td> </td><td>O</td><td>N</td><td>V</td><td> </td><td>E</td><td>X</td></tr>
                    <tr><th>20</th><td>F</td><td>R</td><td>Z</td><td>J</td><td>U</td><td>M</td><td>P</td><td>D</td><td>S</td><td>Q</td></tr>
                    <tr><th>37</th><td>A</td><td>W</td><td>K</td><td>L</td><td>I</td><td>G</td><td>H</td><td>T</td><td>B</td><td>Y</td></tr>
                </table>
                <p class="centered">
                    08 -> S<br>
                    30 -> A<br>
                    04 -> U<br>
                    1 -> C<br>
                    8 -> E<br>
                    06 -> P<br>
                    70 -> A<br>
                    5 -> N
                </p>
                <p class="centered">
                    キーワードB: SAUCEPAN
                </p>
                <h3>ステップ3：カオス暗号</h3>
                <p>キーワードAを取得し、最初に出現したものを除き、重複する英字を削除する。アルファベットの文字列全体を取り出し、キーワードAに存在する英字をすべて取り除く。ポートの個数とポートプレートの個数の偶奇性が一致している場合、アルファベットの文字列をキーワードの末尾に置く。そうでない場合、アルファベットの文字列をキーワードの先頭に置く。これをキーAと呼ぶ。</p>
                <p>キーワードBを取得し、最初に出現したものを除き、重複する英字を削除する。アルファベットの文字列全体を取り出し、キーワードBに存在する英字をすべて取り除く。シリアルナンバーの三番目の文字と六番目の文字の偶奇性が一致していない場合、アルファベットの文字列をキーワードの末尾に置く。そうでない場合、アルファベットの文字列をキーワードの先頭に置く。これをキーBと呼ぶ。</p>
                <p>キーBの上にキーAを記し、キーの14文字目の上にアスタリスクを1つ置く。</p>
                <p>1ページ目の上のディスプレーにある暗号化された単語の各文字ごとに、以下の処理を行う。</p>
                <ul>
                    <li>キーBからN番目の英字を探す。これを文字Bと呼ぶ。</li>
                    <li>その英字を、同じ列にあるキーAの文字に置き換える。これを文字Aと呼ぶ。これが復号された英字である。</li>
                    <li>キーAを、キーの末尾の文字が文字Aになるようにずらす。キーAの3文字目を取り出し、それをアスタリスクのある位置に戻す。</li>
                    <li>キーBを、キーの先頭の文字が文字Bになるようにずらす。キーBの2文字目を取り出し、それをアスタリスクのある位置に戻す。</li>
                </ul>

            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">鳥子色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：MRPAGW<br>
                    表記上、アスタリスクのある列を赤色で示している。
                </p>
                <table class="alpha">
                    <tr>
                        <td>M</td><td>O</td><td>A</td><td>T</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td>
                        <th>K</th><td>L</td><td>N</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td>
                    </tr>
                    <tr>
                        <td>S</td><td>A</td><td>U</td><td>C</td><td>E</td><td>P</td><td>N</td><td>B</td><td>D</td><td>F</td><td>G</td><td>H</td><td>I</td>
                        <th>J</th><td>K</td><td>L</td><td>M</td><td>O</td><td>Q</td><td>R</td><td>T</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td>
                    </tr>
                </table>
                <p class="centered">M -> P</p>
                <table class="alpha">
                    <tr>
                        <td>Q</td><td>R</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>M</td><td>O</td><td>A</td><td>T</td><td>B</td>
                        <th>S</th><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>N</td><td>P</td>
                    </tr>
                    <tr>
                        <td>M</td><td>Q</td><td>R</td><td>T</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>S</td><td>A</td><td>U</td><td>C</td>
                        <th>O</th><td>E</td><td>P</td><td>N</td><td>B</td><td>D</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td>
                    </tr>
                </table>
                <p class="centered">R -> U</p>
                <table class="alpha">
                    <tr>
                        <td>V</td><td>W</td><td>Y</td><td>Z</td><td>M</td><td>O</td><td>A</td><td>T</td><td>B</td><td>S</td><td>C</td><td>D</td><td>E</td>
                        <th>X</th><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>N</td><td>P</td><td>Q</td><td>R</td><td>U</td>
                    </tr>
                    <tr>
                        <td>R</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>S</td><td>A</td><td>U</td><td>C</td><td>O</td><td>E</td><td>P</td>
                        <th>T</th><td>N</td><td>B</td><td>D</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td><td>Q</td>
                    </tr>
                </table>
                <p class="centered">P -> E</p>
                <table class="alpha">
                    <tr>
                        <td>X</td><td>F</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>N</td><td>P</td><td>Q</td><td>R</td><td>U</td><td>V</td>
                        <th>G</th><td>W</td><td>Y</td><td>Z</td><td>M</td><td>O</td><td>A</td><td>T</td><td>B</td><td>S</td><td>C</td><td>D</td><td>E</td>
                    </tr>
                    <tr>
                        <td>P</td><td>N</td><td>B</td><td>D</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td><td>Q</td>
                        <th>T</th><td>R</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>S</td><td>A</td><td>U</td><td>C</td><td>O</td><td>E</td>
                    </tr>
                </table>
                <p class="centered">A -> B</p>
                <table class="alpha">
                    <tr>
                        <td>S</td><td>C</td><td>E</td><td>X</td><td>F</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>N</td><td>P</td><td>Q</td>
                        <th>D</th><td>R</td><td>U</td><td>V</td><td>G</td><td>W</td><td>Y</td><td>Z</td><td>M</td><td>O</td><td>A</td><td>T</td><td>B</td>
                    </tr>
                    <tr>
                        <td>A</td><td>C</td><td>O</td><td>E</td><td>P</td><td>N</td><td>B</td><td>D</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td>
                        <th>U</th><td>K</td><td>L</td><td>M</td><td>Q</td><td>T</td><td>R</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>S</td>
                    </tr>
                </table>
                <p class="centered">G -> L</p>
                <table class="alpha">
                    <tr>
                        <td>N</td><td>P</td><td>D</td><td>R</td><td>U</td><td>V</td><td>G</td><td>W</td><td>Y</td><td>Z</td><td>M</td><td>O</td><td>A</td>
                        <th>Q</th><td>T</td><td>B</td><td>S</td><td>C</td><td>E</td><td>X</td><td>F</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td>
                    </tr>
                    <tr>
                        <td>G</td><td>I</td><td>J</td><td>U</td><td>K</td><td>L</td><td>M</td><td>Q</td><td>T</td><td>R</td><td>V</td><td>W</td><td>X</td>
                        <th>H</th><td>Y</td><td>Z</td><td>S</td><td>A</td><td>C</td><td>O</td><td>E</td><td>P</td><td>N</td><td>B</td><td>D</td><td>F</td>
                    </tr>
                </table>
                <p class="centered">W -> O</p>
                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>

                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>

                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>

            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>
</html>