<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Simon Stores — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .clarification {
            font-size: smaller;
            font-weight: bold;
        }

            .clarification p {
                margin-bottom: 0;
            }

            .clarification ul {
                margin-top: 0;
            }

        .smaller {
            font-size: smaller;
        }

        table {
            border: none;
        }

        .corner {
            border: none;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Simon Stores</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Simon Stores.svg" class="diagram">
                <h2>On the Subject of Simon Stores</h2>
                <p class="flavour-text">Calculators at the ready...</p>

                <p>This module consists of nine buttons, six of which have the colours: (R)ed, (G)reen, (B)lue, (C)yan, (M)agenta, and (Y)ellow.</p>
                <p>These buttons will flash in an increasing sequence, starting with the centre button, in which each flashing colour corresponds to an operator in the tables below.</p>
                <p>Apply each operation successively until the end of the sequence and use the result to determine the sequence of coloured buttons to press for each stage.</p>
                <div class='clarification'>
                    <p>If at any point an operator yields-</p>
                    <ul>
                        <li>a value greater than 364, then subtract 365 from the value until it is less than 365.</li>
                        <li>a value less than -364, then add 365 to the value until it is greater than -365.</li>
                    </ul>
                </div>

                <h3>Section 1: Determining Initial Values</h3>
                <p>To determine the number to be entered into the sequence of operators, interpret the following pairs of digits in the serial number as <em>two-digit base-36 numbers</em> and take them modulo 365:</p>
                <ul class='smaller'>
                    <li>For stage 1, a<sub>0</sub> is obtained by using the 3rd and 4th digits.</li>
                    <li>For stage 2, b<sub>0</sub> is obtained by using the 5th and 6th digits.</li>
                    <li>For stage 3, c<sub>0</sub> is obtained by using the 1st and 2nd digits.</li>
                </ul>

                <h3>Section 2: Operation Tables</h3>
                <p>In each stage, each color is associated with an operation, expressed here as a function:</p>
                <ul class='smaller'>
                    <li>n is the current step of the sequence.</li>
                    <li>D is the sum of the individual base-36 digits of the serial number.</li>
                </ul>
                <table>

                    <tr>
                        <th class='corner'></th>
                        <th>Stage 1</th>
                        <th>Stage 2</th>
                        <th>Stage 3</th>
                    </tr>

                    <tr>
                        <th>R</th>
                        <td>R(x) = x + D</td>
                        <td>R(x) = x + a<sub>n-1</sub> + n<sup>2</sup></td>
                        <td>R(x) = x + b<sub>n-1</sub> - a<sub>n-1</sub></td>
                    </tr>

                    <tr>
                        <th>G</th>
                        <td>G(x) = x - D</td>
                        <td>G(x) = 2x - a<sub>n-1</sub></td>
                        <td>G(x) = x - 2b<sub>n-1</sub></td>
                    </tr>

                    <tr>
                        <th>B</th>
                        <td>B(x) = 2x - D</td>
                        <td>B(x) = 2x - a<sub>0</sub> - 4n<sup>2</sup></td>
                        <td>B(x) = x + b<sub>0</sub> - a<sub>3</sub></td>
                    </tr>

                    <tr>
                        <th>C</th>
                        <td>C(x) = D - x - 8n</td>
                        <td>C(x) = x + a<sub>1</sub></td>
                        <td>C(x) = x - b<sub>n-1</sub> + a<sub>n-1</sub></td>
                    </tr>

                    <tr>
                        <th>M</th>
                        <td>M(x) = 3n<sup>3</sup> - 2x</td>
                        <td>M(x) = x + a<sub>2</sub> - D</td>
                        <td>M(x) = x - 2a<sub>n-1</sub></td>
                    </tr>

                    <tr>
                        <th>Y</th>
                        <td>Y(x) = x + D - 6n</td>
                        <td>Y(x) = x + a<sub>3</sub> - a<sub>n-1</sub></td>
                        <td>Y(x) = x + b<sub>4</sub> - a<sub>0</sub></td>
                    </tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 1 of 4</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Simon Stores</span>
            </div>
            <div class="page-content">
                <h4>Single-Colour Flashes</h4>
                <p>For single-colour flashes, simply apply the function for the colour that flashed: <small>a<sub>n</sub> = F(a<sub>n-1</sub>), b<sub>n</sub> = F(b<sub>n-1</sub>), c<sub>n</sub> = F(c<sub>n-1</sub>)</small></p>

                <h4>Two-Colour Flashes</h4>
                <p>
                    The operators here depend on whether the flashing colours are (P)rimary or (S)econdary with respect to additive colour mixing.<br>
                    P and S refer to the functions associated with the individual flashing colours.
                </p>
                <table>
                    <tr>
                        <th class='corner'></th>
                        <th>Stage 1</th>
                        <th>Stage 2</th>
                        <th>Stage 3</th>
                    </tr>
                    <tr>
                        <th>2P</th>
                        <td><small>a<sub>n</sub> = <br>max(P<sub>1</sub>(a<sub>n-1</sub>), P<sub>2</sub>(a<sub>n-1</sub>))</small></td>
                        <td><small>b<sub>n</sub> = <br>abs(P<sub>1</sub>(b<sub>n-1</sub>) - P<sub>2</sub>(b<sub>n-1</sub>))</small></td>
                        <td><small>c<sub>n</sub> = <br>P<sub>3</sub>(c<sub>n-1</sub>) + P<sub>3</sub>(b<sub>n-1</sub>) + P<sub>3</sub>(a<sub>n-1</sub>)</small></td>
                    </tr>

                    <tr>
                        <th>1P, 1S</th>
                        <td><small>a<sub>n</sub> = <br>P(a<sub>n-1</sub>) + S(a<sub>n-1</sub>) - 2D</small></td>
                        <td><small>b<sub>n</sub> = <br>4D - abs(P(b<sub>n-1</sub>) - S(b<sub>n-1</sub>))</small></td>
                        <td><small>c<sub>n</sub> = <br>min(P(c<sub>n-1</sub>), S(c<sub>n-1</sub>), -abs(P(c<sub>n-1</sub>) - S(c<sub>n-1</sub>)))</small></td>
                    </tr>

                    <tr>
                        <th>2S</th>
                        <td><small>a<sub>n</sub> = <br>min(S<sub>1</sub>(a<sub>n-1</sub>), S<sub>2</sub>(a<sub>n-1</sub>))</small></td>
                        <td><small>b<sub>n</sub> = <br>max(S<sub>3</sub>(b<sub>n-1</sub>), S<sub>3</sub>(a<sub>n-1</sub>))</small></td>
                        <td><small>c<sub>n</sub> = <br>S<sub>3</sub>(c<sub>n-1</sub>) - S<sub>1</sub>(c<sub>n-1</sub>) - S<sub>2</sub>(c<sub>n-1</sub>)</small></td>
                    </tr>
                </table>
                <p>Note: P<sub>3</sub> and S<sub>3</sub> refer to the functions corresponding to the respective primary and secondary colours that <strong>did not</strong> flash at this step of the sequence.</p>

                <h4>Three-Colour Flashes</h4>
                <table>
                    <tr>
                        <th class='corner'></th>
                        <th>Stage 1</th>
                        <th>Stage 2</th>
                        <th>Stage 3</th>
                    </tr>
                    <tr>
                        <th>3P</th>
                        <td><small>a<sub>n</sub> = <br>a<sub>n-1</sub> + a<sub>0</sub></small></td>
                        <td><small>b<sub>n</sub> = <br>b<sub>n-1</sub> + (b<sub>n-1</sub> mod 4)b<sub>0</sub> - a<sub>3</sub></small></td>
                        <td><small>c<sub>n</sub> = <br>c<sub>n-1</sub> + (c<sub>n-1</sub> mod 3)c<sub>0</sub> - <br>(b<sub>n-1</sub> mod 3)b<sub>0</sub> + (a<sub>n-1</sub> mod 3)a<sub>0</sub></td>
                    </tr>
                    <tr>
                        <th>2P, 1S</th>
                        <td><small>a<sub>n</sub> = <br>max(P<sub>1</sub>(a<sub>n-1</sub>),P<sub>2</sub>(a<sub>n-1</sub>), S(a<sub>n-1</sub>))</small></td>
                        <td><small>b<sub>n</sub> = <br>b<sub>n-1</sub> +  P<sub>1</sub>(b<sub>n-1</sub>) + <br>P<sub>2</sub>(b<sub>n-1</sub>) - S(a<sub>n-1</sub>)</small></td>
                        <td><small>c<sub>n</sub> = <br>P<sub>1</sub>(c<sub>n-1</sub>) + P<sub>2</sub>(c<sub>n-1</sub>) - S(b<sub>n-1</sub>) - S(a<sub>n-1</sub>)</small></td>
                    </tr>
                    <tr>
                        <th>1P, 2S</th>
                        <td><small>a<sub>n</sub> = <br>min(S<sub>1</sub>(a<sub>n-1</sub>),S<sub>2</sub>(a<sub>n-1</sub>), P(a<sub>n-1</sub>))</small></td>
                        <td><small>b<sub>n</sub> = <br>b<sub>n-1</sub> +  S<sub>1</sub>(a<sub>n-1</sub>) + <br>S<sub>2</sub>(a<sub>n-1</sub>) - P(b<sub>n-1</sub>)</small></td>
                        <td><small>c<sub>n</sub> = <br>S<sub>1</sub>(c<sub>n-1</sub>) + S<sub>2</sub>(c<sub>n-1</sub>) - P(b<sub>n-1</sub>) - P(a<sub>n-1</sub>)</small></td>
                    </tr>
                    <tr>
                        <th>3S</th>
                        <td><small>a<sub>n</sub> = <br>a<sub>n-1</sub> - a<sub>0</sub></small></td>
                        <td><small>b<sub>n</sub> = <br>b<sub>n-1</sub> + (b<sub>0</sub> mod 4)b<sub>n-1</sub> - a<sub>3</sub></small></td>
                        <td><small>c<sub>n</sub> = <br>c<sub>n-1</sub> + (c<sub>0</sub> mod 3)c<sub>n-1</sub> - <br>(b<sub>0</sub> mod 3)b<sub>n-1</sub> + (a<sub>0</sub> mod 3)a<sub>n-1</sub></td>
                    </tr>
                </table>
                <p>Note: a<sub>4</sub> is equal to zero.</p>
            </div>
            <div class="page-footer relative-footer">Page 2 of 4</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Simon Stores</span>
            </div>
            <div class="page-content">
                <h3>Section 3: Converting Results</h3>
                <p>Once a result of the sequence of operations has been obtained, it must be converted into <strong>balanced ternary</strong>, a base-3 number system in which the digits have the values 1, 0, and -1. Find a sequence of these values such that multiplying them with each power of 3 from 3<sup>0</sup> = 1 (the “least significant”) to 3<sup>5</sup> = 243 (the “most significant”), and adding that up, results in the desired number.</p>

                <h3>Section 4: Entry and Submission</h3>
                <p>To work out which buttons need to be pressed, first apply the list of conditions on the positions of buttons on the module to each row of the initial correspondences table, starting from the top of the list and working down.</p>
                <table>
                    <tr><th>Initial Correspondences</th><th>3<sup>0</sup></th><th>3<sup>1</sup></th><th>3<sup>2</sup></th><th>3<sup>3</sup></th><th>3<sup>4</sup></th><th>3<sup>5</sup></th></tr>
                    <tr><th>Stage 1</th><td>R</td><td>G</td><td>B</td><td>C</td><td>M</td><td>Y</td></tr>
                    <tr><th>Stage 2</th><td>Y</td><td>B</td><td>G</td><td>M</td><td>C</td><td>R</td></tr>
                    <tr><th>Stage 3</th><td>B</td><td>M</td><td>R</td><td>Y</td><td>G</td><td>C</td></tr>
                </table>
                <p></p>
                <table>
                    <tr><td>If...</td><td>..., then...</td></tr>
                    <tr><td>the top right button is yellow</td><td>cycle each colour one space to the right.</td></tr>
                    <tr><td>the red button is diametrically opposite the cyan button</td><td>swap each colour with its complementary (R ↔ C, G ↔ M, B ↔ Y).</td></tr>
                    <tr><td>the green button is adjacent to the white button</td><td>cycle the primary colours<br>(R → G, G → B, B → R).</td></tr>
                    <tr><td>the magenta button is adjacent to the black button</td><td>cycle the secondary colours<br>(C → M, M → Y, Y → C).</td></tr>
                    <tr><td>the blue and yellow buttons are on the same side of the module</td><td>swap B with the colour opposite in the sequence.</td></tr>
                    <tr><td>the red button is on the right side of the module</td><td>swap R and Y.</td></tr>
                    <tr><td>the blue button is on the left side of the module</td><td>swap G and C.</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 3 of 4</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Simon Stores</span>
            </div>
            <div class="page-content">
                <p>Once a balanced ternary number and the buttons corresponding to powers of 3 for the current stage have both been determined, follow the instructions below:</p>
                <ol>
                    <li>Press the centre button. This will cause the sequence to stop flashing and light the white button.</li>
                    <li>
                        Using the coloured buttons, enter the non-zero balanced ternary digits in order of <strong>least to most significant</strong>:
                        <ul>
                            <li>Pressing the white and black buttons will toggle which of the two are lit.</li>
                            <li>Pressing a coloured button while the white button is lit will enter a ‘+1’ in the corresponding digit.</li>
                            <li>Pressing a coloured button while the black button is lit will enter a ‘-1’ in the corresponding digit.</li>
                        </ul>
                    <li>Press the centre button again to submit the sequence of inputs.</li>
                </ol>
                <p>Submitting the correct sequence of inputs will advance the module to the next stage.</p>
                <p>Submitting an incorrect balanced ternary number, or submitting the coloured buttons in the wrong order will result in a strike.</p>
            </div>
            <div class="page-footer relative-footer">Page 4 of 4</div>
        </div>
    </div>
</body>
</html>
