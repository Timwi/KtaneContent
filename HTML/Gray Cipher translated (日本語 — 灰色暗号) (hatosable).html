<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>灰色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
        }
        .beta {
            font-size: 11px;
        }
        .tablea {
            font-size: 14px;
        }
        .tableb {
            font-size: 20px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">灰色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：灰色暗号</h2>
                <p class="flavour-text">この暗号は灰色で殺風景で退屈に見えるかもしれない。まあ、言わせてもらうと...間違ってはいない。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに6桁の二進数、下のディスプレーには数字が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：ビットスイッチ暗号</h3>
                <p>ここでは、ページ1にある上のディスプレーの暗号文と真ん中のディスプレーにある6桁の二進数を使用する。</p>
                <p>まず、シリアルナンバーの最初の文字を使用して変換器を特定する。</p>
                <table>
                    <tr><th>0</th><th>21453</th><th>9</th><th>23154</th><th>I</th><th>24513</th><th>R</th><th>24531</th></tr>
                    <tr><th>1</th><th>21534</th><th>A</th><th>25134</th><th>J</th><th>25413</th><th>S</th><th>25431</th></tr>
                    <tr><th>2</th><th>31524</th><th>B</th><th>24153</th><th>K</th><th>34512</th><th>T</th><th>34521</th></tr>
                    <tr><th>3</th><th>31452</th><th>C</th><th>34152</th><th>L</th><th>35214</th><th>U</th><th>35421</th></tr>
                    <tr><th>4</th><th>41523</th><th>D</th><th>35124</th><th>M</th><th>35412</th><th>V</th><th>43251</th></tr>
                    <tr><th>5</th><th>41532</th><th>E</th><th>45123</th><th>N</th><th>43512</th><th>W</th><th>43521</th></tr>
                    <tr><th>6</th><th>51234</th><th>F</th><th>45132</th><th>O</th><th>45213</th><th>X</th><th>45231</th></tr>
                    <tr><th>7</th><th>51423</th><th>G</th><th>54123</th><th>P</th><th>53412</th><th>Y</th><th>53421</th></tr>
                    <tr><th>8</th><th>51432</th><th>H</th><th>54132</th><th>Q</th><th>54213</th><th>Z</th><th>54231</th></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">灰色暗号</span>
            </div>
            <div class="page-content">
                <p>次に、暗号文の各文字を以下の表を用いて二進数に変換する。</p>
                <table>
                    <tr><th>A</th><th>00001</th><th>H</th><th>01000</th><th>O</th><th>01111</th><th>V</th><th>10110</th></tr>
                    <tr><th>B</th><th>00010</th><th>I</th><th>01001</th><th>P</th><th>10000</th><th>W</th><th>10111</th></tr>
                    <tr><th>C</th><th>00011</th><th>J</th><th>01010</th><th>Q</th><th>10001</th><th>X</th><th>11000</th></tr>
                    <tr><th>D</th><th>00100</th><th>K</th><th>01011</th><th>R</th><th>10010</th><th>Y</th><th>11001</th></tr>
                    <tr><th>E</th><th>00101</th><th>L</th><th>01100</th><th>S</th><th>10011</th><th>Z</th><th>11010</th></tr>
                    <tr><th>F</th><th>00110</th><th>M</th><th>01101</th><th>T</th><th>10100</th></tr>
                    <tr><th>G</th><th>00111</th><th>N</th><th>01110</th><th>U</th><th>10101</th></tr>
                </table>
                <p>各二進数に対して、その文字の位置にあるビット(真ん中のディスプレー)が1であれば、その二進数の各ビットを反転させる。そして、変換器を適用して、変換器のそれぞれの位置にある数字をその数字の位置にある二進数の数字にする。</p>
                <h4 class="centered">例<br>(シリアルナンバーの二番目の英字に対して)</h4>
                <p class="centered">
                    変換器：35124<br>
                    二進数：10011<br>
                    10011の3番目 → 0<br>
                    10011の5番目 → 1<br>
                    10011の1番目 → 1<br>
                    10011の2番目 → 0<br>
                    10011の4番目 → 1<br>
                    10011 → 01101
                </p>
                <p>最後に二進数を同じ表を用いて英字に変換する。</p>

                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：HMCDCC<br>
                    使用変換器：54123<br>
                    下のディスプレーの二進数：011010
                </p>
                <p class="centered">
                    H → 01000 + 0 → 01000 + 54123 → 00010 → B<br>
                    M → 01101 + 1 → 10010 + 54123 → 01100 → L <br>
                    C → 00011 + 1 → 11100 + 54123 → 00111 → G <br>
                    D → 00100 + 0 → 00100 + 54123 → 00001 → A <br>
                    C → 00011 + 1 → 11100 + 54123 → 00111 → G<br>
                    C → 00011 + 0 → 00011 + 54123 → 11000 → X<br>
                    新たな暗号化された単語：BLGAGX
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>

        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">灰色暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ2：円柱転置</h3>
                <p>ここでは、ステップ1で獲得した暗号化された単語とページ1にある下のディスプレーの数字を使用する。</p>
                <p>その数字を取得し、その下に、読み順で数字の列に収まるように6本のダッシュを入れる。</p>
                <table>
                    <tr>
                        <th>1</th><th>2</th><th class='empty'></th><th>1</th><th>2</th><th>3</th><th class='empty'></th><th>1</th><th>2</th><th>3</th><th>4</th>
                        <th class='empty'></th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th class='empty'></th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th>
                    </tr>
                    <tr>
                        <th>-</th><th>-</th><th class='empty'></th><th>-</th><th>-</th><th>-</th><th class='empty'></th><th>-</th><th>-</th><th>-</th><th>-</th>
                        <th class='empty'></th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th class='empty'></th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th><th>-</th>
                    </tr>
                    <tr>
                        <th>-</th><th>-</th><th class='empty'></th><th>-</th><th>-</th><th>-</th><th class='empty'></th><th>-</th><th>-</th><th class='empty'></th>
                        <th class='empty'></th><th class='empty'></th><th>-</th><th class='empty'></th><th class='empty'></th><th class='empty'></th><th class='empty'></th>
                    </tr>
                    <tr><th>-</th><th>-</th></tr>
                </table>
                <p>暗号化された単語を取得し、昇順でその数字の下のダッシュをすべて文字に置き換える。
                </p>
                <p>最後に、読み順で英字を取得し新たな英字の並びを得る。</p>
                <h4 class="centered"> 例</h4>
                <p class="centered">
                    暗号化された単語：BLGAGX<br>
                    数字：321
                </p>
                <table>
                    <tr><th>3</th><th>2</th><th>1</th></tr>
                    <tr><th>G</th><th>G</th><th>B</th></tr>
                    <tr><th>X</th><th>A</th><th>L</th></tr>
                </table>
                <p class="centered">
                    新たな暗号化された単語：GGBXAL
                </p>
                <h3>ステップ3：ポルタックス暗号</h3>
                <p>ここでは、ステップ2で獲得した暗号化された単語とページ2にある上のディスプレーの3文字の鍵を使用する。</p>
                <p>更に、2段ずつの2グループ、合計4段からなるこの暗号表を使用する。</p>
                <p style="text-align:center;font-family:'Special Elite'">
                    ABCDEFGHIJKLM<br>
                    NOPQRSTUVWXYZNOPQRSTUVWXY<br>
                    -------------------------<br>
                    ACEGIKMOQSUWYACEGIKMOQSUW<br>
                    BDFHJLNPRTVXZBDFHJLNPRTVX
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">灰色暗号</span>
            </div>
            <div class="page-content">
                <p>暗号文を二分割し、2つの3文字の文字列を取得する。前半の文字列の下に後半の文字列を配置する。各列は上から下に読む文字列のペアとして扱う。各ペアに対して、以下を実行する。</p>
                <ul>
                    <li>Aという文字が、3/4段目にあるN番目の鍵の文字と同じ位置になるように最上段をずらす。Nは左から右に数えたペアの位置である。</li>
                    <li>最上段の長さの範囲で、1/2段目の中からペアの最初の文字を探す。</li>
                    <li>最上段の長さの範囲で、3/4段目の中からペアの二番目の文字を探す。</li>
                    <li>2つの文字が同じ列にある場合、ペアの最初の文字を1/2段目の文字に置き換え、ペアの二番目の文字を3/4段目の文字に置き換える。</li>
                    <li>そうでない場合、ペアの最初の文字をそれと同じ段にあるかつペアの二番目の文字と同じ列にある文字に置き換える。ペアの二番目の文字をそれと同じ段にあるかつペアの最初の文字と同じ列にある文字に置き換える。</li>
                </ul>
                <p>ペアの最初の文字で取得した文字の次に、ペアの二番目の文字で取得した文字を読むことで、復号された単語を得られる。</p>
                <p class="centered">
                    暗号化された単語：GGBXAL<br>
                    鍵：JSK
                </p>
                <table>
                    <tr><th>G</th><th>G</th><th>B</th></tr>
                    <tr><th>X</th><th>A</th><th>L</th></tr>
                </table>
                <table class="alpha">
                    <tr>
                        <th class='corner' colspan='4'></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th>
                        <th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th class='corner' colspan='8'></th>
                    </tr>
                    <tr>
                        <th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th>
                        <th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th>
                    </tr>
                    <tr><th class='corner' colspan='25'></th></tr>
                    <tr>
                        <th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th><th>Y</th>
                        <th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th>
                    </tr>
                    <tr>
                        <th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th><th>Z</th>
                        <th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th>
                    </tr>
                </table>
                <p class="centered">
                    GX→ HV
                </p>
                <table class="alpha">
                    <tr>
                        <th class='corner' colspan='9'></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th>
                        <th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th class='corner' colspan='3'></th>
                    </tr>
                    <tr>
                        <th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th>
                        <th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th>
                    </tr>
                    <tr><th class='corner' colspan='25'></th></tr>
                    <tr>
                        <th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th><th>Y</th>
                        <th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th>
                    </tr>
                    <tr>
                        <th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th><th>Z</th>
                        <th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th>
                    </tr>
                </table>
                <p class="centered">
                    GA→ EE
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">灰色暗号</span>
            </div>
            <div class="page-content">
                <table class="alpha">
                    <tr>
                        <th class='corner' colspan='5'></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th>
                        <th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th class='corner' colspan='7'></th>
                    </tr>
                    <tr>
                        <th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th>
                        <th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th>
                    </tr>
                    <tr><th class='corner' colspan='25'></th></tr>
                    <tr>
                        <th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th><th>Y</th>
                        <th>A</th><th>C</th><th>E</th><th>G</th><th>I</th><th>K</th><th>M</th><th>O</th><th>Q</th><th>S</th><th>U</th><th>W</th>
                    </tr>
                    <tr>
                        <th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th><th>Z</th>
                        <th>B</th><th>D</th><th>F</th><th>H</th><th>J</th><th>L</th><th>N</th><th>P</th><th>R</th><th>T</th><th>V</th><th>X</th>
                    </tr>
                </table>
                <p class="centered">
                    BL→ AN
                </p>
                <table>
                    <tr><th>H</th><th>E</th><th>A</th></tr>
                    <tr><th>V</th><th>E</th><th>N</th></tr>
                </table>
                <p class="centered">
                    復号された単語：HEAVEN
                </p>
                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>
</html>