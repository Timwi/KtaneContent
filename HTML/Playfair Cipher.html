<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Playfair Cipher — Keep Talking and Nobody Explodes Module</title>
    <meta name="viewport" content="initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src='js/ktane-utils.js'></script>
    <style>
        table.table {
            border: none;
        }

            table.table td {
                text-align: center;
                border-collapse: collapse;
            }

                table.table td.no-border {
                    border: none;
                }

        .centertable {
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-07">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Playfair Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Playfair Cipher.svg" class="diagram">
                <h2>On the Subject of Playfair Cipher</h2>
                <p class="flavour-text">
                    Encrypting secrets since 1854, exploding bombs since 2018.
                </p>

                <p>Your purpose is to decrypt an encrypted message. Find the key, decrypt the message and press the correct button sequence. Easy, right?</p>
                <h3>Obtaining the Key</h3>
                <p>Find the two key parts using the following two tables. In each table, stop at the first rule that applies.</p>
                <h4>Part 1</h4>
                <table class="table">
                    <tbody>
                        <tr>
                            <th>It’s Monday*</th>
                            <td>PLAY</td>
                        </tr>
                        <tr>
                            <th>It’s Tuesday</th>
                            <td>HIDDEN</td>
                        </tr>
                        <tr>
                            <th>It’s Wednesday*</th>
                            <td>SECRET</td>
                        </tr>
                        <tr>
                            <th>It’s Thursday</th>
                            <td>CIPHER</td>
                        </tr>
                        <tr>
                            <th>It’s Friday*</th>
                            <td>FAIL</td>
                        </tr>
                        <tr>
                            <th>It’s Saturday</th>
                            <td>PARTYHARD</td>
                        </tr>
                        <tr>
                            <th>It’s Sunday</th>
                            <td>BECOZY</td>
                        </tr>
                        <tr>
                            <td colspan="2" align="center">
                                * If a <strong>lit BOB</strong> indicator is present on the bomb, use the following day. BOB hates odd-numbered days (except Sunday).
                            </td>
                        </tr>
                    </tbody>
                </table>

                <h4>Part 2</h4>
                <table class="table">
                    <tbody>
                        <tr>
                            <td class="no-border"></td>
                            <th colspan="4">Screen Color</th>
                        </tr>
                        <tr>
                            <td class="no-border"></td>
                            <th>Magenta</th>
                            <th>Blue</th>
                            <th>Orange</th>
                            <th>Yellow</th>
                        </tr>
                        <tr>
                            <th>Bomb has serial and parallel port</th>
                            <td>SAFE</td>
                            <td>EFAS</td>
                            <td>MESSAGE</td>
                            <td>GROOVE</td>
                        </tr>
                        <tr>
                            <th>Sum of serial number digits > 10</th>
                            <td>CODE</td>
                            <td>EDOC</td>
                            <td>QUIET</td>
                            <td>ETIUQ</td>
                        </tr>
                        <tr>
                            <th>D batteries > AA batteries</th>
                            <td>GROOVE</td>
                            <td>EVOORG</td>
                            <td>TEIUQ</td>
                            <td>QUITE</td>
                        </tr>
                        <tr>
                            <th>Otherwise</th>
                            <td>MESSAGE</td>
                            <td>EGASSEM</td>
                            <td>SAFE</td>
                            <td>EDOC</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 1 of 2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Playfair Cipher</span>
            </div>

            <div class="page-content">

                <h3>Modifying the key</h3>
                <ul>
                    <li>If the serial number doesn’t contain a vowel, <b>swap</b> the parts.</li>
                    <li>
                        If you have one or more strikes, <b>add</b> a third part:
                        <ul>
                            <li>For one strike, add "ONE".</li>
                            <li>For two strikes, add "TWO".</li>
                            <li>For more strikes, add "MANY".</li>
                        </ul>
                    </li>
                    <li>
                        If the sum of digits in serial number is a prime number,
                        <b>reverse</b> the complete key.
                        (Prime numbers: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47)
                    </li>
                </ul>

                <h3>Decrypting the message</h3>
                <ul>
                    <li>
                        Create a 5×5 matrix of letters. Start with your <b>keyword</b>
                        and fill the rest with the unused letters of the alphabet.
                        Each letter must occur only <b>once</b> in the matrix, so only add the first occurrence.
                        ‘J’ and ‘I’ are interchangeable.
                    </li>
                    <li>
                        Split the <b>message</b> into character pairs. For each pair:
                        <ul>
                            <li>If the letters appear on the same row of your matrix, replace them with the letters to their immediate left respectively, wrapping around to the right side of the row if necessary.</li>
                            <li>If the letters are on the same column of your matrix, replace them with the letters immediately above, wrapping to the bottom if necessary.</li>
                            <li>If the letters are on different rows and columns, replace each of them with the letter on the same row but in the column of the other letter in the original pair.</li>
                        </ul>
                    </li>
                    <li>Drop any Xs that don’t make sense and locate any Is that should be Js.</li>
                </ul>
                <table class="table" align="center">
                    <tbody>
                        <tr>
                            <td class="no-border"></td>
                            <td class="no-border"></td>
                            <th colspan="4">Screen Color</th>
                        </tr>
                        <tr>
                            <td class="no-border"></td>
                            <td class="no-border"></td>
                            <th>Magenta</th>
                            <th>Blue</th>
                            <th>Orange</th>
                            <th>Yellow</th>
                        </tr>
                        <tr>
                            <th rowspan="8">Decrypted Message</th>
                            <th>STRIKE</th>
                            <td>ABCD</td>
                            <td>CDAB</td>
                            <td>BADC</td>
                            <td>DABC</td>
                        </tr>
                        <tr>
                            <th>STRIK</th>
                            <td>BCDA</td>
                            <td>DACB</td>
                            <td>ADCB</td>
                            <td>ABCD</td>
                        </tr>
                        <tr>
                            <th>STRYKE</th>
                            <td>CDAB</td>
                            <td>ACBD</td>
                            <td>DCBA</td>
                            <td>BCDA</td>
                        </tr>
                        <tr>
                            <th>STRYK</th>
                            <td>DABC</td>
                            <td>CBDA</td>
                            <td>CBAD</td>
                            <td>CDAB</td>
                        </tr>
                        <tr>
                            <th>ZTRIKE</th>
                            <td>ABDC</td>
                            <td>BDAC</td>
                            <td>BACD</td>
                            <td>DACB</td>
                        </tr>
                        <tr>
                            <th>ZTRIK</th>
                            <td>BDCA</td>
                            <td>DBCA</td>
                            <td>ACDB</td>
                            <td>ACBD</td>
                        </tr>
                        <tr>
                            <th>ZTRYKE</th>
                            <td>CABD</td>
                            <td>BCAD</td>
                            <td>CDBA</td>
                            <td>CBDA</td>
                        </tr>
                        <tr>
                            <th>ZTRYK</th>
                            <td>DCAB</td>
                            <td>CADB</td>
                            <td>DBAC</td>
                            <td>BDAC</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="page-footer relative-footer">Page 2 of 2</div>
        </div>
    </div>
</body>
</html>
