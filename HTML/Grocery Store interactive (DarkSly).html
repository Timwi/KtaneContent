<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Grocery Store — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
            border: none;
        }

        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Firefox */
        input[type=number] {
            -moz-appearance: textfield;
        }

        .noselect {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Grocery Store</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Grocery Store.svg" class="diagram">
                <h2>On the Subject of the Grocery Store</h2>
                
                <p>Press on any grocery item to deduct the item price from the total. Items turn <span style="font-weight: bold; color: red;">red</span> when they are too expensive.</p>
                <p>The total amount starts at $100. Use the rules below to change that amount to your actual starting quantity. </p>

                <div style="display: flex; justify-content:space-between;">
                    <p style="display: inline;"><strong>+$32</strong> if SN has G, S or D</p>
                    <p style="display: inline;"><strong>+$30</strong> if Serial</p>
                    <p style="display: inline;"><strong>−$15</strong> if Parallel</p>
                    <p style="display: inline;"><strong>−$22</strong> 2+ Batteries</p>
                </div>

                <p style="display:inline; font-weight: bold;">Total: &nbsp;$</p>
                <input id="total-amount" type="number" style="width: 4em;" value="100.00" />

                <table id="items-table"></table>
        
            </div>
           <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
    </div>
    <script>
        var groceryItems = [
            { name: "Apples", image: "img/Grocery Store/apples.png", price: 0.96 }, 
            { name: "Bananas", image: "img/Grocery Store/bananas.png", price: 0.58 }, 
            { name: "Bottled Water", image: "img/Grocery Store/bottled water.png", price: 12.48 }, 
            { name: "Bread", image: "img/Grocery Store/bread.png", price: 2.50 }, 
            { name: "Butter", image: "img/Grocery Store/butter.png", price: 5.14 }, 
            { name: "Candy", image: "img/Grocery Store/candy.png", price: 3.99 }, 
            { name: "Cat Food", image: "img/Grocery Store/cat food.png", price: 11.99 }, 
            { name: "Cheese", image: "img/Grocery Store/cheese.png", price: 3.99 }, 
            { name: "Coffee", image: "img/Grocery Store/coffee.png", price: 11.68 }, 
            { name: "Cookies", image: "img/Grocery Store/cookies.png", price: 3.56 }, 
            { name: "Detergent", image: "img/Grocery Store/detergent.png", price: 19.94 }, 
            { name: "Eggs", image: "img/Grocery Store/eggs.png", price: 2.50 }, 
            { name: "Flour", image: "img/Grocery Store/flour.png", price: 6.75 }, 
            { name: "Glass Cleaner", image: "img/Grocery Store/glass cleaner.png", price: 6.28 }, 
            { name: "Hot Sauce", image: "img/Grocery Store/hot sauce.png", price: 5.42 }, 
            { name: "Jelly", image: "img/Grocery Store/jelly.png", price: 5.49 }, 
            { name: "Lettuce", image: "img/Grocery Store/lettuce.png", price: 1.49 }, 
            { name: "Milk", image: "img/Grocery Store/milk.png", price: 1.39 }, 
            { name: "Paper Towels", image: "img/Grocery Store/paper towels.png", price: 8.68 }, 
            { name: "Peanut Butter", image: "img/Grocery Store/peanut butter.png", price: 5.64 }, 
            { name: "Pepper", image: "img/Grocery Store/pepper.png", price: 4.98 }, 
            { name: "Pork", image: "img/Grocery Store/pork.png", price: 4.99 }, 
            { name: "Potatoes", image: "img/Grocery Store/potatoes.png", price: 4.59 }, 
            { name: "Salt", image: "img/Grocery Store/salt.png", price: 3.48 }, 
            { name: "Sausage", image: "img/Grocery Store/sausage.png", price: 2.99 }, 
            { name: "Soda", image: "img/Grocery Store/soda.png", price: 4.48 }, 
            { name: "Soup", image: "img/Grocery Store/soup.png", price: 5.28 }, 
            { name: "Steak", image: "img/Grocery Store/steak.png", price: 12.00 }, 
            { name: "Sugar", image: "img/Grocery Store/sugar.png", price: 11.37 }, 
            { name: "Toiler Paper", image: "img/Grocery Store/toilet paper.png", price: 16.99 }, 
            { name: "Tomatoes", image: "img/Grocery Store/tomatoes.png", price: 1.71 }, 
            { name: "Toothpaste", image: "img/Grocery Store/toothpaste.png", price: 4.99 }, 
            { name: "Turkey", image: "img/Grocery Store/turkey.png", price: 7.48 }
        ];

        var total = document.getElementById("total-amount");
        total.onchange = () => {
            if(total.value == "") total.value = "100.00"

            groceryItems.forEach((item, i) => {
                var td = document.getElementById("td-" + item.name);
                if(item.price > total.value) {
                    td.style.backgroundColor = "rgb(255, 152, 145)";
                } else {
                    td.style.backgroundColor = "transparent";
                }
            });
        }

        var table = document.getElementById("items-table");
        var tableRow;

        groceryItems.forEach((item, i) => {
            if(i % 7 == 0) {
                tableRow = document.createElement("tr");
                table.appendChild(tableRow);
            }

            var tableCell = document.createElement("td");
            tableCell.id = "td-" + item.name;
            tableCell.style.maxWidth = 70;
            tableCell.extraData = item;

            tableCell.onmousedown = () => {
                tableCell.style.opacity = "50%";
            }
            tableCell.onmouseleave = () => {
                tableCell.style.opacity = "100%";
            }
            tableCell.onmouseup = () => {
                if(tableCell.style.backgroundColor != "rgb(255, 152, 145)" && tableCell.style.opacity == 0.5) {
                    total.value = (total.value - tableCell.extraData.price).toFixed(2);
                    total.dispatchEvent(new Event("change"));
                }
                tableCell.style.opacity = "100%";
            }
            
            var image = document.createElement("img");
            image.className = "noselect";
            image.style.display = "block";
            image.style.margin = "auto";
            image.setAttribute("draggable", false);
            image.style.objectFit = "contain";
            image.height = 50;
            image.width = 70;
            image.src = item.image;
            tableCell.appendChild(image);

            var name = document.createElement("p");
            name.className = "noselect";
            name.style.textAlign = "center";
            name.style.lineHeight = 1;
            name.style.marginBottom = "5px";
            name.innerHTML = item.name;
            tableCell.appendChild(name);

            var price = document.createElement("p");
            price.className = "noselect";
            price.style.fontSize = "10pt";
            price.style.margin = 0;
            price.innerHTML = "$" + item.price.toFixed(2);
            tableCell.appendChild(price);

            tableRow.appendChild(tableCell);
        });
    </script>
</body>
</html>
