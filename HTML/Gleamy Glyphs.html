<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1">
	<title>Gleamy Glyphs — Keep Talking and Nobody Explodes Module</title>
	<link rel="stylesheet" type="text/css" href="css/font.css">
	<link rel="stylesheet" type="text/css" href="css/normalize.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<script src="js/ktane-utils.js"></script>
	<script src="js/ruleseed.js"></script>
	<script>
		function setDefaultRules(rnd) {
			setRules(rnd);
		}

		function setRules(rnd) {
			let imgs = [
				"M-9.26-9.26H9.26L.13 9.26h-.26ZM0 4.86l5.92-12H-5.92Z",
				
				"M-9.26-9.26h2.3L0 4.86 6.96-9.26h2.3L.13 9.26h-.26z",
				
				"M-6.06.08q0 1.43.32 2.72.33 1.28 1.05 2.25t1.87 1.54q1.17.55 2.82.55 1.68 0 2.83-.55 1.16-.57 1.87-1.54.73-.97 1.04-2.25.32-1.29.32-2.72v-9.34h2.17V.08q0 1.87-.47 3.55-.45 1.67-1.44 2.92-.98 1.25-2.55 1.99-1.56.72-3.77.72-2.2 0-3.77-.72-1.57-.74-2.56-1.99-.98-1.25-1.45-2.92-.45-1.68-.45-3.55v-9.34h2.17z",
				
				"M3.55 2.17H0q-1.2 0-2.24-.44-1.03-.45-1.8-1.23-.78-.77-1.23-1.8-.46-1.05-.46-2.24 0-1.18.46-2.22.45-1.05 1.22-1.82.78-.78 1.81-1.23 1.05-.45 2.24-.45 1.17 0 2.2.45 1.05.45 1.83 1.23.77.77 1.22 1.82.46 1.04.46 2.22v12.8H3.55zm0-5.71q0-.76-.29-1.4-.28-.67-.77-1.13-.48-.48-1.13-.75Q.72-7.1-.02-7.1q-.74 0-1.38.27-.65.27-1.13.75-.47.46-.74 1.12-.28.65-.28 1.41 0 .75.28 1.4.27.64.74 1.12.48.48 1.13.75Q-.76 0-.02 0h3.57z",
				
				"M.75 2.17H-2.8q-1.19 0-2.24-.44-1.03-.45-1.8-1.23-.78-.77-1.23-1.8-.45-1.05-.45-2.24 0-1.18.45-2.22.45-1.05 1.23-1.82.77-.78 1.8-1.23 1.05-.45 2.24-.45 1.18 0 2.2.45 1.06.45 1.83 1.23.78.77 1.23 1.82.45 1.04.45 2.22V6.2l4.06-4.03L8.5 3.69 2.92 9.26H.75zm0-5.71q0-.76-.28-1.4-.29-.67-.78-1.13-.48-.48-1.12-.75-.65-.27-1.39-.27-.73 0-1.38.27-.64.27-1.12.75-.48.46-.75 1.12-.27.65-.27 1.41 0 .75.27 1.4.27.64.75 1.12.48.48 1.12.75.65.27 1.38.27H.75z",
				
				"M3.55-3.54q0-.76-.29-1.4-.28-.67-.77-1.13-.48-.48-1.13-.75Q.72-7.1-.02-7.1q-.74 0-1.38.27-.65.27-1.13.75-.47.46-.74 1.12-.28.65-.28 1.41v1.18h-2.17v-1.18q0-1.18.46-2.22.45-1.05 1.22-1.82.78-.78 1.81-1.23 1.05-.45 2.24-.45 1.17 0 2.2.45 1.05.45 1.83 1.23.77.77 1.22 1.82.46 1.04.46 2.22v12.8H3.55z",
				
				"M5.72-9.26V9.26H3.55v-16.4h-9.27v-2.12z",
				
				"M3 9.26V2.08Q.88 1.91-.67 1.12-2.2.34-3.2-.89q-1-1.23-1.49-2.82-.47-1.59-.47-3.36v-2.2H-3v2.2q0 1.44.41 2.73.41 1.28 1.28 2.25.88.97 2.2 1.53Q2.25 0 4.1 0h1.08v9.26z",
				
				"M-2.34 6.23v3.65h-2.32V6.23h-1.72V3.97h1.72V0h6.84L-3.5-8.57l1.85-1.31 8.03 12v.14h-8.72v1.7h5.2v2.27z",
				
				"M4.09-8.04-1.23 0h6.4v9.26H3V2.12h-8.17v-.13L2.36-9.26Z",
				
				"M-7.56-3.07q-.37-.83-.37-1.81 0-.9.33-1.7.35-.81.95-1.4.6-.6 1.4-.93.8-.35 1.71-.35.9 0 1.7.35.8.33 1.4.93.6.59.93 1.4.35.8.35 1.7 0 .91-.35 1.71-.33.8-.93 1.4-.6.6-1.4.94-.8.35-1.7.35h-.23L-4-.49l2.66 5.35L5.63-9.26h2.3L-1.2 9.26h-.26Zm1.72-1.8q0 .49.18.92.18.41.5.72t.73.5q.42.16.9.16.48 0 .9-.17.4-.18.72-.49.3-.31.48-.74.18-.42.18-.91 0-.5-.18-.9-.17-.43-.48-.74-.31-.31-.73-.48-.4-.18-.89-.18-.48 0-.9.18-.41.17-.74.48-.3.3-.49.73-.18.42-.18.92Z",
				
				"M9.26-4.23H3.4V.03q0 1.48-.45 2.65-.46 1.18-1.28 2-.83.83-2 1.28-1.17.44-2.59.44-1.34 0-2.5-.44-1.16-.45-2-1.28-.86-.84-1.35-2.01-.5-1.18-.5-2.64V-6.4h2.18V.03q0 1.04.3 1.82.3.8.83 1.32.56.53 1.32.8.76.26 1.7.26.92 0 1.69-.26.77-.27 1.31-.8.56-.53.86-1.32.3-.78.3-1.82V-6.4h8.04z",
				
				"M9.88-.8H-3.78q-.8 0-1.51.3-.7.3-1.2.83-.5.51-.79 1.2-.29.69-.29 1.47 0 .79.3 1.48.28.69.78 1.2.5.5 1.2.8.7.29 1.51.29h1.26v2.31h-1.26q-1.26 0-2.38-.48-1.1-.48-1.93-1.31-.83-.83-1.3-1.93-.49-1.12-.49-2.38 0-1.26.48-2.36.48-1.12 1.31-1.94.83-.83 1.93-1.31 1.12-.48 2.38-.48h10.4l-4.3-4.33 1.62-1.64 5.94 5.97Z"
			];

			let remainingImgs = [];
			let xs = [
				26, 36, 46, 56, 66,
				21, 31, 41, 51, 61, 71,
				16, 26, 36, 46, 56, 66, 76,
				11, 21, 31, 41, 51, 61, 71, 81,
				6, 16, 26, 36, 46, 56, 66, 76, 86,
				11, 21, 31, 41, 51, 61, 71, 81,
				16, 26, 36, 46, 56, 66, 76,
				21, 31, 41, 51, 61, 71,
				26, 36, 46, 56, 66,
			];
			let ys = [
				12.5, 12.5, 12.5, 12.5, 12.5,
				21, 21, 21, 21, 21, 21,
				29.5, 29.5, 29.5, 29.5, 29.5, 29.5, 29.5,
				38, 38, 38, 38, 38, 38, 38, 38,
				46.5, 46.5, 46.5, 46.5, 46.5, 46.5, 46.5, 46.5, 46.5,
				55, 55, 55, 55, 55, 55, 55, 55,
				63.5, 63.5, 63.5, 63.5, 63.5, 63.5, 63.5,
				72, 72, 72, 72, 72, 72,
				80.5, 80.5, 80.5, 80.5, 80.5
			];

			let hexes = [
				[00, 01, 05, 06, 07, 12, 13],
				[01, 02, 06, 07, 08, 13, 14],
				[02, 03, 07, 08, 09, 14, 15],
				[03, 04, 06, 09, 10, 15, 16],
				[05, 06, 11, 12, 13, 20, 21],
				[06, 07, 12, 13, 14, 21, 22],
				[07, 08, 13, 14, 15, 22, 23],
				[08, 09, 14, 15, 16, 23, 24],
				[09, 10, 15, 16, 17, 24, 25],
				[11, 12, 18, 19, 20, 27, 28],
				[12, 13, 19, 20, 21, 28, 29],
				[13, 14, 20, 21, 22, 29, 30],
				[14, 15, 21, 22, 23, 30, 31],
				[15, 16, 22, 23, 24, 31, 32],
				[16, 17, 23, 24, 25, 32, 33],
				[18, 19, 26, 27, 28, 35, 36],
				[19, 20, 27, 28, 29, 36, 37],
				[20, 21, 28, 29, 30, 37, 38],
				[21, 22, 29, 30, 31, 38, 39],
				[22, 23, 30, 31, 32, 39, 40],
				[23, 24, 31, 32, 33, 40, 41],
				[24, 25, 32, 33, 34, 41, 42],
				[27, 28, 35, 36, 37, 43, 44],
				[28, 29, 36, 37, 38, 44, 45],
				[29, 30, 37, 38, 39, 45, 46],
				[30, 31, 38, 39, 40, 46, 47],
				[31, 32, 39, 40, 41, 47, 48],
				[32, 33, 40, 41, 42, 48, 49],
				[36, 37, 43, 44, 45, 50, 51],
				[37, 38, 44, 45, 46, 51, 52],
				[38, 39, 45, 46, 47, 52, 53],
				[39, 40, 46, 47, 48, 53, 54],
				[40, 41, 47, 48, 49, 54, 55],
				[44, 45, 50, 51, 52, 56, 57],
				[45, 46, 51, 52, 53, 57, 58],
				[46, 47, 52, 53, 54, 58, 59],
				[47, 48, 53, 54, 55, 59, 60]
			];

			function sortNums(a, b) { return a - b; }
			function checkDistinct(array)
			{
				let checkSet = new Set(array);
				return checkSet.size === array.length;
			}
			function arraysEqual(a, b)
			{
				if (a === b) return true;
				if (a == null || b == null) return false;
				if (a.length !== b.length) return false;
				for (var i = 0; i < a.length; ++i) {
					if (a[i] !== b[i]) return false;
				}
				return true;
			}
			function okayHexagon(arr)
			{
				for (let img = 0; img < imgs.length; img++) {
					let c = 0;
					for (let ix = 0; ix < arr.length; ix++)
						if (arr[ix] == img)
							c++;
					if (c >= 3)
						return false;
				}
				return true;
			}

			let nums = [];
			let tfs = [];
			let rs = [];
			for (let i = 0; i < 130; i++) {
				nums.push(i % 13);
				tfs.push(rnd.next(0, 4));
				rs.push(rnd.next(0, 8));
			}
			let isDistinct = false;
			while (!isDistinct)
			{
				let tempHexes = [];
				rnd.shuffleFisherYates(nums);
				isDistinct = true;
				for (let i = 0; i < hexes.length; i++)
				{
					let arr = [];
					for (let j = 0; j < 7; j++)
						arr.push(nums[hexes[i][j]]);
					if (!okayHexagon(arr)) {
						isDistinct = false;
						break;
					}
					arr.sort(sortNums);
					for (let j = 0; j < tempHexes.length; j++) {
						if (arraysEqual(arr, tempHexes[j]))
							isDistinct = false;
					}
					if (!isDistinct)
						break;
					tempHexes.push(arr);
				}
			}
			console.log(nums);
			let glyphs = document.getElementsByClassName("glyph");
			for (let i = 0; i < glyphs.length; i++)
			{
				glyphs[i].setAttribute('d', imgs[nums[i]]);
				let sx = tfs[i] === 1 || tfs[i] === 3 ? -.3 : .3;
				let sy = tfs[i] === 2 || tfs[i] === 3 ? -.3 : .3;

				glyphs[i].setAttribute('transform', `translate(${xs[i]+4},${ys[i]+3.5}) rotate(${rs[i] * 45}) scale(${sx},${sy})`);
				// glyphs[i].setAttribute('transform', `translate(${xs[i]+4},${ys[i]+3.5}) scale(0.3,0.3)`);
			}
		}
	</script>
	<style>
		svg circle { fill: transparent; stroke: black; stroke-width: 0.5; }
		.dark svg circle { fill: transparent; stroke: #DDD; stroke-width: 0.5; }
		.glyph { fill: black; }
		.dark .glyph { fill: #DDD; }
	</style>
</head>
<body>
	<div class="section">
		<div class="page page-bg-01">
			<div class="page-header">
				<span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
				<span class="page-header-section-title">Gleamy Glyphs</span>
			</div>
			<div class="page-content">
				<img src="img/Component/Gleamy Glyphs.svg" class="diagram">
				<h2>On the Subject of Gleamy Glyphs</h2>
				<p class="flavour-text">“I’m a sagittarius, what about you?”<br>“Uhhh, backwards J?”</p>

				<p>The seven glyphs on the module exist in the grid below as a hexagon with a side length of two. Each of the glyphs may be rotated or flipped across either axis. Press the only glyph that is in the same position on both the module and within the hexagon.</p>

				<svg xmlns="http://www.w3.org/2000/svg" viewBox="4.5 10 91 80">
				<g>
				<circle cx="30" cy="16" r="4.85" />
				<path class="glyph" />
				<circle cx="30" cy="16" r="4.85" class="highlightable" />
				<circle cx="40" cy="16" r="4.85" />
				<path class="glyph" />
				<circle cx="40" cy="16" r="4.85" class="highlightable" />
				<circle cx="50" cy="16" r="4.85" />
				<path class="glyph" />
				<circle cx="50" cy="16" r="4.85" class="highlightable" />
				<circle cx="60" cy="16" r="4.85" />
				<path class="glyph" />
				<circle cx="60" cy="16" r="4.85" class="highlightable" />
				<circle cx="70" cy="16" r="4.85" />
				<path class="glyph" />
				<circle cx="70" cy="16" r="4.85" class="highlightable" />

				<circle cx="25" cy="24.5" r="4.85" />
				<path class="glyph" />
				<circle cx="25" cy="24.5" r="4.85" class="highlightable" />
				<circle cx="35" cy="24.5" r="4.85" />
				<path class="glyph" />
				<circle cx="35" cy="24.5" r="4.85" class="highlightable" />
				<circle cx="45" cy="24.5" r="4.85" />
				<path class="glyph" />
				<circle cx="45" cy="24.5" r="4.85" class="highlightable" />
				<circle cx="55" cy="24.5" r="4.85" />
				<path class="glyph" />
				<circle cx="55" cy="24.5" r="4.85" class="highlightable" />
				<circle cx="65" cy="24.5" r="4.85" />
				<path class="glyph" />
				<circle cx="65" cy="24.5" r="4.85" class="highlightable" />
				<circle cx="75" cy="24.5" r="4.85" />
				<path class="glyph" />
				<circle cx="75" cy="24.5" r="4.85" class="highlightable" />

				<circle cx="20" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="20" cy="33" r="4.85" class="highlightable" />
				<circle cx="30" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="30" cy="33" r="4.85" class="highlightable" />
				<circle cx="40" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="40" cy="33" r="4.85" class="highlightable" />
				<circle cx="50" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="50" cy="33" r="4.85" class="highlightable" />
				<circle cx="60" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="60" cy="33" r="4.85" class="highlightable" />
				<circle cx="70" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="70" cy="33" r="4.85" class="highlightable" />
				<circle cx="80" cy="33" r="4.85" />
				<path class="glyph" />
				<circle cx="80" cy="33" r="4.85" class="highlightable" />

				<circle cx="15" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="15" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="25" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="25" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="35" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="35" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="45" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="45" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="55" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="55" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="65" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="65" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="75" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="75" cy="41.5" r="4.85" class="highlightable" />
				<circle cx="85" cy="41.5" r="4.85" />
				<path class="glyph" />
				<circle cx="85" cy="41.5" r="4.85" class="highlightable" />

				<circle cx="10" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="10" cy="50" r="4.85" class="highlightable" />
				<circle cx="20" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="20" cy="50" r="4.85" class="highlightable" />
				<circle cx="30" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="30" cy="50" r="4.85" class="highlightable" />
				<circle cx="40" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="40" cy="50" r="4.85" class="highlightable" />
				<circle cx="50" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="50" cy="50" r="4.85" class="highlightable" />
				<circle cx="60" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="60" cy="50" r="4.85" class="highlightable" />
				<circle cx="70" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="70" cy="50" r="4.85" class="highlightable" />
				<circle cx="80" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="80" cy="50" r="4.85" class="highlightable" />
				<circle cx="90" cy="50" r="4.85" />
				<path class="glyph" />
				<circle cx="90" cy="50" r="4.85" class="highlightable" />

				<circle cx="15" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="15" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="25" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="25" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="35" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="35" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="45" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="45" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="55" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="55" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="65" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="65" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="75" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="75" cy="58.5" r="4.85" class="highlightable" />
				<circle cx="85" cy="58.5" r="4.85" />
				<path class="glyph" />
				<circle cx="85" cy="58.5" r="4.85" class="highlightable" />

				<circle cx="20" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="20" cy="67" r="4.85" class="highlightable" />
				<circle cx="30" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="30" cy="67" r="4.85" class="highlightable" />
				<circle cx="40" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="40" cy="67" r="4.85" class="highlightable" />
				<circle cx="50" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="50" cy="67" r="4.85" class="highlightable" />
				<circle cx="60" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="60" cy="67" r="4.85" class="highlightable" />
				<circle cx="70" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="70" cy="67" r="4.85" class="highlightable" />
				<circle cx="80" cy="67" r="4.85" />
				<path class="glyph" />
				<circle cx="80" cy="67" r="4.85" class="highlightable" />

				<circle cx="25" cy="75.5" r="4.85" />
				<path class="glyph" />
				<circle cx="25" cy="75.5" r="4.85" class="highlightable" />
				<circle cx="35" cy="75.5" r="4.85" />
				<path class="glyph" />
				<circle cx="35" cy="75.5" r="4.85" class="highlightable" />
				<circle cx="45" cy="75.5" r="4.85" />
				<path class="glyph" />
				<circle cx="45" cy="75.5" r="4.85" class="highlightable" />
				<circle cx="55" cy="75.5" r="4.85" />
				<path class="glyph" />
				<circle cx="55" cy="75.5" r="4.85" class="highlightable" />
				<circle cx="65" cy="75.5" r="4.85" />
				<path class="glyph" />
				<circle cx="65" cy="75.5" r="4.85" class="highlightable" />
				<circle cx="75" cy="75.5" r="4.85" />
				<path class="glyph" />
				<circle cx="75" cy="75.5" r="4.85" class="highlightable" />

				<circle cx="30" cy="84" r="4.85" />
				<path class="glyph" />
				<circle cx="30" cy="84" r="4.85" class="highlightable" />
				<circle cx="40" cy="84" r="4.85" />
				<path class="glyph" />
				<circle cx="40" cy="84" r="4.85" class="highlightable" />
				<circle cx="50" cy="84" r="4.85" />
				<path class="glyph" />
				<circle cx="50" cy="84" r="4.85" class="highlightable" />
				<circle cx="60" cy="84" r="4.85" />
				<path class="glyph" />
				<circle cx="60" cy="84" r="4.85" class="highlightable" />
				<circle cx="70" cy="84" r="4.85" />
				<path class="glyph" />
				<circle cx="70" cy="84" r="4.85" class="highlightable" />
				</g>
				</svg>
			</div>
			<div class="page-footer relative-footer">Page 1 of 1</div>
		</div>
	</div>
</body>
</html>