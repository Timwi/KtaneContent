<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Toe Tactics — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/jquery.3.7.0.min.js"></script>
    <script src="js/ruleseed.js"></script>
    <style>
        table, .dark table {
            margin: 1em auto;
            border: none;
            text-align: center;
        }
        table tr:nth-child(2) { border-bottom: 3px solid; }
        
        table tr td:nth-child(1),
        .dark table tr td:nth-child(1) {
            border-right: 3px solid;
        }
        .board-area td { padding: 0; }
        svg.board-config {
            width:.8in;
            display: block;
            margin: .05in;
        }
        line {
            stroke: black;
            stroke-width: .75px;
        }
        rect { fill: #BBB; }
        .dark rect { fill: #999; }
        .dark line { stroke: #DDD; }
    </style>
    <script>
        function setDefaultRules(rnd) {
            setRules(rnd);
        }
        function setRules(rnd) {
            const validConfigs = [ 7,11,13,14,19,21,22,25,26,28,35,37,38,41,42,44,49,50,52,56,67,69,70,73,74,76,81,82,84,88,97,98,100,104,112,131,133,134,137,138,140,145,146,148,152,161,162,164,168,176,193,194,196,200,208,224 ]
            rnd.shuffleFisherYates(validConfigs);
            
            let cells = $("table tr.board-area td");
            for (let row = 0; row < 9; row++) {
                $(cells[7 * row]).html(generateSVG(1 << (8 - row)))
                for (let col = 0; col < 9; col++) {
                    let config = validConfigs[6 * row + col];
                    $(cells[7 * row + col + 1]).html(generateSVG(config));
                }
            }   
        }
        function generateSVG(ix) {
            let includedPositions = [ ];
            for (let i = 0; i < 9; i++) {
                if (ix & (1 << i)) {
                    includedPositions.push(8 - i);
                }
            }
            let svg = $('<svg>').addClass('board-config').attr('viewbox', '0 0 30 30');
            
            $('<line>').attr({ x1:10, x2:10, y1:0, y2:30 }).appendTo(svg);
            $('<line>').attr({ x1:20, x2:20, y1:0, y2:30 }).appendTo(svg);
            $('<line>').attr({ x1:0, x2:30, y1:10, y2:10 }).appendTo(svg);
            $('<line>').attr({ x1:0, x2:30, y1:20, y2:20 }).appendTo(svg);
            
            for (let pos of includedPositions) {
                let col = pos % 3;
                let row = Math.floor(pos / 3);
                $('<rect>').attr({ x: 10 * col + 1, y: 10 * row + 1, width:8, height:8 }).appendTo(svg);
            }
            return svg.prop('outerHTML');
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Toe Tactics</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Toe Tactics.svg" class="diagram">
                <h2>On the Subject of Toe Tactics</h2>
                <p class='flavour-text'>Your years of getting ties won’t save you now…</p>
                
                <p>The module presents a 3×3 game of Toe Tactics in progress. If the last digit of the bomb’s serial number is even, you are playing as O; otherwise as X. To solve the module, win the game against an optimally-playing CPU.</p>
                <p>In Toe Tactics, each symbol initially placed on the board and its color corresponds to a pattern. A player wins if any three of their pieces are located in the positions specified by any one of these patterns. Both you and your opponent have the same winning positions.</p>
                <p>See the following page for which patterns correspond to each position, shape, and color.</p>
                
            </div>
            <div class="page-footer relative-footer">Page 1 of 2</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Toe Tactics</span>
            </div>
            <div class="page-content">
                <table> 
                    <tr> <td class='corner'></td> <td colspan='3'>X</td> <td colspan='3'>O</td> </tr>
                    <tr> <td class='corner'></td> <td>Red</td> <td>Blue</td> <td>Yellow</td>   <td>Red</td> <td>Blue</td> <td>Yellow</td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
                    <tr class='board-area'> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>     
                </table>
            </div>
            <div class="page-footer relative-footer">Page 2 of 2</div>
        </div>
    </div>
</body>
</html>