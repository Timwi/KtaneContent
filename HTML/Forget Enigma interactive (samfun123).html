<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Forget Enigma — Keep Talking and Nobody Explodes Module</title>
    <meta name="viewport" content="initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <script src="js/ktane-utils.js"></script>
    <style>

        table {
            margin: 1em auto;
        }

        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }

        /* Interactive */
        .borderless {
            border: none;
        }

        #interactive {
            font-size: 12.5px;
        }
        
        #interactive td.borderless:first-child {
            padding: .3em;
        }

		button {
			font-family: Special Elite;
			background-color: white;
			color: black;
			padding: 1px 3px;
			border-radius: 5px;
			border: black 2px solid;
			transition: 0.3s;
		}

		button:hover {
			background-color: black;
			color: white;
		}
    </style>
    <script src="js/jquery.3.1.1.min.js"></script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Forget Enigma</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Forget Enigma.svg" class="diagram">
                <h2>On the Subject of Forget Enigma</h2>
                <p class="flavour-text">"My mind is like an enigma." - the bomb</p>
                <p>On the module, you will see a configuration of the rotors/reflector, the rotors set up below that, and a keyboard that lights up a single letter.</p>
                <p>Everytime a module is solved, the stage number goes up by 1, the rotors turn, and a new letter will light up.</p>
                <p>To disarm this module, you have to decrypt the letter using the mechanics down below.</p>
                <h3>Step 1: Configuration of the Rotors/Reflector</h3>
                <p>The screen at top shows what type of rotors are used, the order they are in, and which reflector is used. Use the correct rotor charts and correct reflector chart to use to create an Enigma Decryptor.</p>
                <p>They are read in this order: Reflector-Bottom Rotor-Top Rotor. Above the top rotor, you will type A-Z to use as the keyboard.</p>
                <p>Use the schematic at the bottom to help you create the Enigma Decryptor.</p>
                <p>The rotors below the screen shows what letter each one is at. Shift the letters until the bottom left letter is equal to the letter on the rotor.</p>
                
                <table id="interactive" class="borderless"></table>
            </div>
            <div class="page-footer relative-footer">Page 1 of 3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Forget Enigma</span>
            </div>
            <div class="page-content">
                <h2>Enigma Schematic</h2>
                <p style='text-align: center'><img src="img/Forget Enigma/EnigmaScheme.png" style="width: 16cm" /></p>
                </ul>
                <br>
                <br>
                <h3>Step 2: Using the Enigma Decryptor</h3>
                <ul>
                    <li>1: Take the lit letter and find it on the keyboard row of the decryptor.</li>
                    <li>2: Go straight down to the top row of the top rotor to receive a new letter.</li>
                    <li>3: Find the new letter in the bottom row of the top rotor.</li>
                    <li>4: Go straight down to the top row of the bottom rotor to receive a new letter.</li>
                    <li>5: Find the new letter in the bottom row of the bottom rotor.</li>
                    <li>6: Go straight down to the top row of the reflector to receive a new letter.</li>
                    <li>7: Find the new letter in the bottom row of the reflector.</li>
                    <li>8: Go straight up to the bottom row of the bottom rotor to receive a new letter.</li>
                    <li>9: Find the new letter in the top row of the bottom rotor.</li>
                    <li>10: Go straight up to the bottom row of the top rotor to receive a new letter.</li>
                    <li>11: Find the new letter in the top row of the top rotor.</li>
                    <li>12: Go straight up to the keyboard row to receive your decrypted letter.</li>
                    <li>The example below uses I as the lit letter which will decrypt it to W.</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 2 of 3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Forget Enigma</span>
            </div>
            <div class="page-content">
                <br>
                <br>
                <br>
                <p style='text-align: center'><img src="img/Forget Enigma/DecryptSteps.png" style="width: 16cm" /></p>


                <br>
                <br>
                <br>
                <h3>Step 3: Rotor Turning Mechanics</h3>
                <p>On each solve, the rotors will turn but not randomly. This next section talks bout how rotor turning mechanics work.</p>
                <p>You will notice a couple letters on the bottom row of the rotors have * next to them. This will affect the turning of the rotors:</p>
                <ul>
                    <li>If the asterisk is at the leftmost edge of the right/top rotor, on the next solve, both the right/top and bottom/left rotor will turn.</li>
                    <li>Otherwise, on the next solve, only the right/top rotor will turn</li>
                    <li>Each turn only goes up 1 step on the rotor (Ex: A -> B, G -> H, Z -> A, etc.)</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 3 of 3</div>
        </div>
    </div>
    <script>
        const cyclers = {
            "Rotor I": [
                ["E", "K", "M", "F", "L", "G", "D", "Q", "V", "Z", "N", "T", "O", "W", "Y", "H", "X", "U", "S", "P", "A", "I", "B", "R", "C", "J"],
                ["A", "B", "C", "D*", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q*", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
            ],
            "Rotor II": [
                ["A", "J", "D", "K", "S", "I", "R", "U", "X", "B", "L", "H", "W", "T", "M", "C", "Q", "G", "Z", "N", "P", "Y", "F", "V", "O", "E"],
                ["A", "B", "C", "D", "E*", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R*", "S", "T", "U", "V", "W", "X", "Y", "Z"],
            ],
            "Rotor III": [
                ["B", "D", "F", "H", "J", "L", "C", "P", "R", "T", "X", "V", "Z", "N", "Y", "E", "I", "W", "G", "A", "K", "M", "U", "S", "Q", "O"],
                ["A", "B", "C", "D", "E", "F", "G", "H", "I*", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V*", "W", "X", "Y", "Z"],

            ],
            "Rotor IV": [
                ["E", "S", "O", "V", "P", "Z", "J", "A", "Y", "Q", "U", "I", "R", "H", "X", "L", "N", "F", "T", "G", "K", "D", "C", "M", "W", "B"],
                ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J*", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W*", "X", "Y", "Z"],

            ],
            "Rotor V": [
                ["V", "Z", "B", "R", "G", "I", "T", "Y", "U", "P", "S", "D", "N", "H", "L", "X", "A", "W", "M", "J", "Q", "O", "F", "E", "C", "K"],
                ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M*", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z*"],

            ],
            "Rotor VI": [
                ["J", "P", "G", "V", "O", "U", "M", "F", "Y", "Q", "B", "E", "N", "H", "Z", "R", "D", "K", "A", "S", "X", "L", "I", "C", "T", "W"],
                ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L*", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y*", "Z"],

            ],
            "Rotor VII": [
                ["N", "Z", "J", "H", "G", "R", "C", "X", "M", "Y", "S", "W", "B", "O", "U", "F", "A", "I", "V", "L", "P", "E", "K", "Q", "D", "T"],
                ["A", "B", "C", "D", "E", "F", "G", "H*", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U*", "V", "W", "X", "Y", "Z"],

            ],
            "Rotor VIII": [
                ["F", "K", "Q", "H", "T", "L", "X", "O", "C", "B", "J", "S", "P", "D", "Z", "R", "A", "M", "E", "W", "N", "I", "U", "Y", "G", "V"],
                ["A", "B", "C*", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P*", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],

            ],
            "Reflector A": [
                ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                ["L", "U", "S", "N", "P", "Q", "O", "M", "J", "I", "Y", "A", "H", "D", "G", "E", "F", "X", "C", "V", "B", "T", "Z", "R", "K", "W"],

            ],
            "Reflector B": [
                ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                ["X", "Q", "U", "M", "F", "E", "P", "O", "W", "L", "T", "J", "D", "Z", "H", "G", "B", "V", "Y", "K", "C", "R", "I", "A", "S", "N"],

            ],
            "Reflector C": [
                ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
                ["E", "S", "K", "O", "A", "Q", "M", "J", "Y", "H", "C", "P", "G", "T", "D", "L", "F", "U", "B", "N", "R", "X", "Z", "V", "I", "W"],
            ],
        };
        
        function mod26(n) {
            return ((n % 26) + 26) % 26;
        }

        const interactive = $("#interactive");

        // Make the keyboard
        const keyboard = $("<tr>").appendTo(interactive);
            
        $("<td>").addClass("borderless").appendTo(keyboard);
        // The top row of any reflector is just A-Z.
        for (let i = 0; i < 26; i++) {
            $("<td>").text(cyclers["Reflector A"][0][i]).appendTo(keyboard);
        }

        // Make the cyclers
        function makeCycler(names, controls = true) {
            let position = 0;
            let name = names[0];

            const update = () => {
                for (let i = 0; i < 26; i++) {
                    topRow.children().eq(i + 1).text(cyclers[name][0][mod26(i + position)]);
                    bottomRow.children().eq(i).text(cyclers[name][1][mod26(i + position)]);
                }
            };
            
            const selector = $("<select>");
            for (const name of names) {
                $("<option>").attr("value", name).text(name).appendTo(selector);
            }

            selector.change(() => { name = selector.val(); update(); });

            const selectorRow = $("<tr>").appendTo(interactive);
            $("<td>").addClass("borderless").appendTo(selectorRow);
            $("<td colspan=26>").append(selector).appendTo(selectorRow);

            const topRow = $("<tr>").appendTo(interactive);
            if (controls) {
                const shiftLeft = $("<button>").text("←").click(() => { position++; update(); });
                $("<td rowspan=2>").addClass("borderless").append(shiftLeft).appendTo(topRow);
            } else {
                $("<td rowspan=2>").addClass("borderless").appendTo(topRow);
            }

            const bottomRow = $("<tr>").appendTo(interactive);

            for (let i = 0; i < 26; i++) {
                $("<td>").appendTo(topRow);
                $("<td>").appendTo(bottomRow);
            }

            if (controls) {
                const shiftRight = $("<button>").text("→").click(() => { position--; update(); });
                $("<td rowspan=2>").addClass("borderless").append(shiftRight).appendTo(topRow);
            }

            update();
        }

        // Make the rotors
        const rotorNames = Object.keys(cyclers).filter(name => name.includes("Rotor"));
        for (let i = 0; i < 2; i++) {
            makeCycler(rotorNames);
        }

        // Make the reflector
        makeCycler(Object.keys(cyclers).filter(name => name.includes("Reflector")), false);
    </script>
</body>
</html>