<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>赤色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">赤色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：赤色暗号</h2>
                <p class="flavour-text">赤を眺めることは、このモジュール上ではごく普通だ。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに6文字の文字列が表示される。暗号化された単語に「J」が含まれている場合、同じ位置にある真ん中のディスプレーの文字に置き換える。3ステップ完了後、その文字を再び「J」に戻す。</p>
                <p>ページ2には、3つのディスプレーすべてに単語が表示される。上の単語はキーワード1、真ん中の単語はキーワード2、下の単語はキーワード3になる。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：プレイフェア暗号</h3>
                <p>このステップでは、キーワード1を使用して1つ目の行列を作成する。</p>
                <p>作成するには、まずJがある場合はそれをIに変換し、重複する英字の2文字目以降を削除する。それから、アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの最初の数字が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。</p>
                <p>暗号化された文字列を2つずつのペアに分割し、各ペアについて以下の手順を実行する。</p>

                <ul>
                    <li>2つの英字が全く同じ場合、その英字を保持する。</li>
                    <li>そうでない場合、その英字が行列の同じ行に存在するなら、その左隣にある英字にペアの英字を置き換える。段の端はループする。</li>
                    <li>そうでない場合、その英字が行列の同じ列に存在するなら、その真上にある英字にペアの英字を置き換える。列の端はループする。</li>
                    <li>そうでない場合、その英字と同じ行にあり、ペアのもう一方の英字と同じ列にある英字にそれぞれ置き換える。</li>
                </ul>

            </div>
            <div class="page-footer relative-footer">ページ 1/4</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">赤色暗号</span>
            </div>
            <div class="page-content">
                <p>結果の文字列が、新たな暗号化された単語となる。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：PXVEYW キーワード1：NOBLES
                    <br>シリアルナンバーの最初の数字：2
                    <br>キー1：ACDFGHIKMPQRTUVWXYZNOBLES
                </p>
                <table>
                    <tr><th>A</th><th>C</th><th>D</th><th>F</th><th>G</th></tr>
                    <tr><th>H</th><th>I</th><th>K</th><th>M</th><th>P</th></tr>
                    <tr><th>Q</th><th>R</th><th>T</th><th>U</th><th>V</th></tr>
                    <tr><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th></tr>
                    <tr><th>O</th><th>B</th><th>L</th><th>E</th><th>S</th></tr>
                </table>
                <p class="centered">
                    PX -> IN<br>
                    VE -> US<br>
                    YW -> XN<br>
                    新たな暗号化された単語：INSUXN
                </p>
                <h3>ステップ2：共役行列分割</h3>
                <p>このステップでは2つの行列が必要となる。1つ目の行列はステップ1で作成したものである。2つ目の行列はキーワード2を使用して作成する。</p>
                <p>1つ目の行列と同様に、キーワード2にJがある場合はそれをIに変換し、重複する英字の2文字目以降を削除する。それから、アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの二番目の数字が偶数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。</p>
                <p>これで、2つの行列を取得できるはずである。2つの行列の上、左、右に1から5の番号を振る。</p>
                <p>暗号化された単語を使い、各英字について、2つ目の行列から行と列の数字の組を見つけ、6組の数字のペアを得る。次に、4番目から6番目の数字のペアを取り出し、1番目から3番目の数字のペアの下に配置する。最後に、上から下へ、左から右へと数字を読み、新しい6組の数字のペアを得る。これらの数字を1番目の行列の行／列の数字として使用し、新たな暗号化された単語を獲得する。</p>
            </div>
            <div class="page-footer relative-footer">ページ 2/4</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">赤色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：INUSXN キーワード2：GALLON<br>
                    シリアルナンバーの二番目の数字：2<br>
                    キー2：GALONBCDEFHIKMPQRSTUVWXYZ
                </p>
                <table>
                    <tr><th></th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>|</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th></th></tr>
                    <tr><th>1</th><th>A</th><th>C</th><th>D</th><th>F</th><th>G</th><th>|</th><th>G</th><th>A</th><th>L</th><th>O</th><th>N</th><th>1</th></tr>
                    <tr><th>2</th><th>H</th><th>I</th><th>K</th><th>M</th><th>P</th><th>|</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>2</th></tr>
                    <tr><th>3</th><th>Q</th><th>R</th><th>T</th><th>U</th><th>V</th><th>|</th><th>H</th><th>I</th><th>K</th><th>M</th><th>P</th><th>3</th></tr>
                    <tr><th>4</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>|</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>4</th></tr>
                    <tr><th>5</th><th>O</th><th>B</th><th>L</th><th>E</th><th>S</th><th>|</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>5</th></tr>
                </table>
                <p class="centered">
                    I -> 32<br>
                    N -> 15<br>
                    U -> 45<br>
                    S -> 43<br>
                    X -> 53<br>
                    N -> 15
                </p>
                <table>
                    <tr><th>3</th><th>2</th><th>1</th><th>5</th><th>4</th><th>5</th></tr>
                    <tr><th>4</th><th>3</th><th>5</th><th>3</th><th>1</th><th>5</th></tr>
                </table>
                <p class="centered">
                    34 -> U<br>
                    23 -> K<br>
                    15 -> G<br>
                    53 -> L<br>
                    41 -> W<br>
                    55 -> S<br>
                    新たな暗号化された単語：UKGLWS
                </p>
                <h3>ステップ3：三枡暗号</h3>
                <p>このステップでは2つの行列が必要となる。1つ目の行列は先程作成したものである。3つ目の行列はキーワード3を使用して行列1や列2と同様に作成する。</p>
                <p>シリアルナンバーの最後の数字が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。これで、3つの行列を取得できるはずである。</p>
            </div>
            <div class="page-footer relative-footer">ページ 3/4</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">赤色暗号</span>
            </div>
            <div class="page-content">

                <p>暗号化された単語を3組の英字のペアに分割する。各ペアに対して、以下の処理を行う。</p>
                <ul>
                    <li>最初の英字を3つ目の行列から探す。その行は1つ目の行列の行番号となり、その列は2つ目の行列の列番号となる。</li>
                    <li>次に、2番目の英字を3つ目の行列から探す。その行は2つ目の行列の行番号となり、その列は1つ目の行列の列番号となる。</li>
                    <li>最後に、1つ目の行列から取得した英字を最初の英字とし、2つ目の行列から取得した英字を2番目の英字とする。</li>
                </ul>
                <p>最初にJであった英字をJに置き換えることで、復号化された単語を取得できることに注意すること。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：UKGLWS キーワード3：JUNK<br>
                    シリアルナンバーの最後の数字：9<br>
                    キー3：IUNKABCDEFGHLMOPQRSTVWXYZ
                </p>
                <table>
                    <tr><th>A</th><th>C</th><th>D</th><th>F</th><th>G</th><th>|</th><th>G</th><th>A</th><th>L</th><th>O</th><th>N</th><th>|</th><th>I</th><th>U</th><th>N</th><th>K</th><th>A</th></tr>
                    <tr><th>H</th><th>I</th><th>K</th><th>M</th><th>P</th><th>|</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>|</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr>
                    <tr><th>Q</th><th>R</th><th>T</th><th>U</th><th>V</th><th>|</th><th>H</th><th>I</th><th>K</th><th>M</th><th>P</th><th>|</th><th>G</th><th>H</th><th>L</th><th>M</th><th>O</th></tr>
                    <tr><th>W</th><th>X</th><th>Y</th><th>Z</th><th>N</th><th>|</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>|</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th></tr>
                    <tr><th>O</th><th>B</th><th>L</th><th>E</th><th>S</th><th>|</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>|</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                </table>
                <p class="centered">
                    UK -> FA<br>
                    GL -> TH<br>
                    WS -> ER<br>
                    復号化された単語：FATHER
                </p>
                <p>復号化された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 4/4</div>
        </div>
    </div>
</body>
</html>