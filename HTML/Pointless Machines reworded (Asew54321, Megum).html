<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Pointless Machines — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/ruleseed.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .page-footer::before { content: 'Page '; }
        .page-footer::after { content: ' of 3'; }
    </style>
    <script>
        let default_rules = {
            major: [
            "if the current flash’s color occurs twice in the sequence...",
            "if the current flash’s position mirrors a color flashing twice...",
            "if the current flash is in the second half of the sequence...",
            "if the current color’s position is in the first half...",
            "if the current color’s position is first, third, or fifth...",
            "if the current color’s position is second, fourth, or sixth...",
            "if the current color does not flash twice..."
            ],
            minor1: [
            "= The flash left of the current flash.",
            "= The flash 3 steps ahead in the sequence.",
            "= The second flash in the sequence.",
            "= The second occurrence of the color that flashes twice.",
            "= The color right of the current.",
            "= The color 2 steps ahead in the sequence.",
            "= The color 2 steps behind in the sequence.",
            "= The first color in the sequence.",
            "= The third color in the sequence.",
            "= The fourth color in the sequence.",
            "= The fifth color in the sequence.",
            "= The sixth color in the sequence.",
            "= The first occurrence of the color that flashes twice.",
            "= The color whose position mirrors the current.",
            "= The color whose position mirrors 3 steps ahead."
            ],
            minor2: [
            "= The color to the right of the flash with the same color as the current flash’s color.", // conditional, gets removed
            "= The color whose position mirrors 3 steps ahead.",
            "= The fifth color in the sequence.",
            "= The color that flashes twice.",
            "= The color left of the current.",
            "= The color right of the current.",
            "= The color 3 steps ahead in the sequence.",
            "= The color 2 steps ahead in the sequence.",
            "= The color 2 steps behind in the sequence.",
            "= The first color in the sequence.",
            "= The second color in the sequence.",
            "= The third color in the sequence.",
            "= The fourth color in the sequence.",
            "= The sixth color in the sequence.",
            "= The color whose position mirrors the current."
            ],
            dirs: [
            "Up", "Left",
            "Up + Right", "Down + Right",
            "Up + Left", "Right",
            "Down", "Down + Left"
            ]
        };
        function setDefaultRules() {
            setAllRules(default_rules);
        }
        function setRules(seed) {
            let rules = {};
            rules.major = seed.shuffleArray(default_rules.major);
            rules.minor1 = seed.shuffleArray(default_rules.minor1);
            rules.minor2 = seed.shuffleArray(default_rules.minor2.slice(1));
            rules.dirs = seed.shuffleArray(default_rules.dirs);
            setAllRules(rules);
        }
        function setAllRules(rules) {
            document.querySelector("#rule-1").innerText = rules.major[0].replace("if", "If")
            document.querySelector("#rule-2").innerText = "Otherwise, " + rules.major[1];
            document.querySelector("#rule-3").innerText = "Otherwise, " + rules.major[2];
            document.querySelector("#rule-1-1").innerText = rules.minor1[0];
            document.querySelector("#rule-2-1").innerText = rules.minor1[1];
            document.querySelector("#rule-3-1").innerText = rules.minor1[2];
            document.querySelector("#rule-4-1").innerText = rules.minor1[3];
            document.querySelector("#rule-1-2").innerText = rules.minor2[0];
            document.querySelector("#rule-2-2").innerText = rules.minor2[1];
            document.querySelector("#rule-3-2").innerText = rules.minor2[2];
            document.querySelector("#rule-4-2").innerText = rules.minor2[3];
            document.querySelector("#directions").innerHTML = `<th>Direction</th>${[0,1,2,3,4].map(i => `<td>${rules.dirs[i]}</td>`).join("")}`;
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Pointless Machines</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Pointless Machines.svg" class="diagram">
                <h2>On the Subject of Pointmore Machines</h2>
                <p class="flavour-text">Strawberry.</p>
                <p>WARNING! This manual may not work as intended with ruleseeds not equal to 1.</p>
                <p>
                    This module presents a machine with a monitor that flashes a sequence of six colors.
                    There is a brief pause in-between the last and first colors of the sequence.
                    The sequence will consist of the colors Red, White, Yellow, Blue,
                    and Purple with one of the colors being repeated. To disarm the module, a series of six directions
                    corresponding to the six flashing colors must be inputted into the module.
                </p>
                <h3>Part 1: Assigning Information to the Five Colors</h3>
                <ol>
                    <li>
                        Make a list with five slots. Each slot consists of a <b class="term">color</b>, a <b class="term">variable</b>, and a <b class="term">constant</b>
                        (these 3 information pieces of a slot from now on are written in bold (except for the table on page 2),
                        so don’t confuse <b class="term">color</b> with color).
                        The goal for part 1 is to assign information in the form of a <b class="term">variable</b> and <b class="term">constant</b> to each of
                        the 5 colors present on the module, so consider <b class="term">color</b>’s color as an identifier of a slot.
                        For the purposes of the assigning algorithm (steps 2-5), the following information is stored
                        (although information about positions would be ommited starting from Part 2):
                    </li>
                    <ul>
                        <li><b class="definiton">Color</b>: stores a flash (color + position).</li>
                        <li><b class="definiton">Constant</b>: stores a single color.</li>
                        <li><b class="definiton">Variable</b>: stores a flash (color + position).</li>
                    </ul>
                    <li>The first slot’s <b class="term">color</b> is equal to the first flash.</li>
                    <li>
                        Use current slot’s <b class="term">color</b> (refered to as current flash)
                        in the below table to assign to current slot its <b class="term">variable</b> and <b class="term">constant</b>.
                        If obtained <b class="term">variable</b>’s color is the same as any previous
                        (and including the current) slot’s <b class="term">color</b>’s color, proceed forward through the sequence until it is not,
                        wrapping around if necessary. Assign this obtained flash as the <b class="term">variable</b> instead.
                    </li>
                    <li>The next slot’s <b class="term">color</b> will be the previous slot’s <b class="term">variable</b>.</li>
                    <li>
                        Repeat steps 3 and 4 until the fifth slot is assigned its <b class="term">color</b>.
                        The fifth slot has no <b class="term">variable</b> and its <b class="term">constant</b> is assigned the slot’s <b class="term">color</b>’s color.
                        If you did everything correctly, your four <b class="term">variables</b> should have four different colors
                        not equal to the first slot’s <b class="term">color</b>’s color.
                    </li>
                </ol>
            </div>
            <div class="page-footer relative-footer">1</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Pointless Machines</span>
            </div>
            <div class="page-content">
                <table>
                    <tr>
                        <th colspan="2" id="rule-1">If the current color flashes twice...</th>
                    </tr>
                    <tr>
                        <th>Variable</th>
                        <td id="rule-1-1">= The color left of the current.</td>
                    </tr>
                    <tr>
                        <th>Constant</th>
                        <td id="rule-1-2">= The color right of the other color sharing the current color.</td>
                    </tr>
                    <tr>
                        <th colspan="2" id="rule-2">Otherwise, if the current color’s position mirrors a color flashing twice...</th>
                    </tr>
                    <tr>
                        <th>Variable</th>
                        <td id="rule-2-1">= The color 3 steps ahead in the sequence.</td>
                    </tr>
                    <tr>
                        <th>Constant</th>
                        <td id="rule-2-2">= The color whose position mirrors 3 steps ahead.</td>
                    </tr>
                    <tr>
                        <th colspan="2" id="rule-3">Otherwise, if the current color’s position is in the second half...</th>
                    </tr>
                    <tr>
                        <th>Variable</th>
                        <td id="rule-3-1">= The second color in the sequence.</td>
                    </tr>
                    <tr>
                        <th>Constant</th>
                        <td id="rule-3-2">= The fifth color in the sequence.</td>
                    </tr>
                    <tr>
                        <th colspan="2">Otherwise...</th>
                    </tr>
                    <tr>
                        <th>Variable</th>
                        <td id="rule-4-1">= The second occurrence of the color that flashes twice.</td>
                    </tr>
                    <tr>
                        <th>Constant</th>
                        <td id="rule-4-2">= The color that flashes twice.</td>
                    </tr>
                </table>
                <h3>Part 2: Assigning Actual Directions</h3>
                <ol>
                    <li>
                        Add another attribute (which is empty at the start) to each slot in the list: its <b class="term">actual direction</b>.
                        As mentioned earlier, <b class="term">variables</b>’ and <b class="term">colors</b>’
                        information about positions can be ommited from now on.
                    </li>
                    <li>
                        This module uses an eight-way directional system.
                        Replace each <b class="term">constant</b> with one of eight directions using this table:
                        <table>
                            <tr>
                                <th>Colors</th><td>White</td><td>Purple</td><td>Red</td><td>Blue</td><td>Yellow</td>
                            </tr>
                            <tr id="directions">
                                <th>Direction</th><td>Up</td><td>Left</td><td>Up + Right</td><td>Down + Right</td><td>Up + Left</td>
                            </tr>
                        </table>
                    </li>
                    <li>Assign the fifth slot’s <b class="term">constant</b>’s direction to fifth slot’s <b class="term">actual direction</b>.</li>
                    <li>
                        Move to the previous slot. Replace the <b class="term">variable</b> with the previously observed slot’s <b class="term">actual direction</b>.
                        Previous slot means one up from the currently observed slot in the list,
                        previously observed slot means one down from the currently observed slot in the list,
                        assuming the slots 1-5 are written top-to-bottom.
                    </li>
                    <li>
                        Starting from the <b class="term">variable</b>, count the number of clockwise or counterclockwise rotations
                        necessary to rotate to the <b class="term">constant</b>. Then, rotate the same number of times
                        starting from the <b class="term">constant</b> in the same direction. If the resulting direction is the same
                        as any other slot’s <b class="term">actual direction</b>, rotate one step clockwise until a
                        unique direction is obtained. The resulting direction is assigned to this slot’s <b class="term">actual direction</b>.
                    </li>
                    <li>
                        Repeat steps 4 and 5 until all five slots have been assigned an <b class="term">actual direction</b>.
                        Each <b class="term">color</b> is now associated with the <b class="term">actual direction</b> of its slot.
                    </li>
                </ol>
            </div>
            <div class="page-footer relative-footer">2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Pointless Machines</span>
            </div>
            <div class="page-content">
                <h3>Part 3: Submission</h3>
                <ul>
                    <li>This module will never strike.</li>
                    <li>
                        Six directions must be submitted to the module.
                        The six directions are the <b class="term">actual directions</b> associated with the six flashing
                        <b class="term">colors</b> of the sequence in order.
                    </li>
                    <li>
                        To start submission, select the module. An upbeat jingle will play,
                        and static will continuously play in the background. To cancel submission, deselect the module,
                        select it again, then deselect it again. The static will stop playing.
                        Submission may be cancelled at any time.
                    </li>
                    <li>
                        When selecting the module to begin submission, select the module straight-on.
                        Selecting the module at an angle will skew its calibration.
                    </li>
                    <li>
                        To submit a specific direction, rotate the bomb in that direction while the module is selected.
                        The submitted direction will briefly flash on the module’s hinges
                        with an accompanying chime.
                    </li>
                    <li>
                        Once the last six directions submitted to the module are the associated directions with the
                        six flashes in order, the module will solve.
                    </li>
                </ul>
            </div>
            <div class="page-footer relative-footer">3</div>
        </div>
    </div>
</body>
</html>