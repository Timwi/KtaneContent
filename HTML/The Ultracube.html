<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>The Ultracube — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src='js/ruleseed.js'></script>
    <style>
        p {
            margin: .5em 0;
        }

        table.ultracube-rotations {
            border: none;
            margin: 1em auto;
            font-size: 12pt;
        }

        td.sep {
            border: none;
        }
    </style>
    <script>
        function setDefaultRules(rnd) { setRules(rnd); }
        function setRules(rnd)
        {
            let faceDimensions = [
                ['ping', 'pong'],
                ['zig', 'zag'],
                ['bottom', 'top'],
                ['front', 'back'],
                ['left', 'right']
            ];

            let faces = [];
            for (let i = 0; i < faceDimensions.length; i++)
                for (let j = i + 1; j < faceDimensions.length; j++)
                    for (let k = j + 1; k < faceDimensions.length; k++)
                    {
                        let which1 = rnd.next(0, 2);
                        let which2 = rnd.next(0, 2);
                        switch (rnd.next(0, 3))
                        {
                            case 0:
                                faces.push(`${faceDimensions[i][0]}-${faceDimensions[j][which1]}-${faceDimensions[k][which2]}`);
                                faces.push(`${faceDimensions[i][1]}-${faceDimensions[j][which1]}-${faceDimensions[k][which2]}`);
                                break;
                            case 1:
                                faces.push(`${faceDimensions[i][which1]}-${faceDimensions[j][0]}-${faceDimensions[k][which2]}`);
                                faces.push(`${faceDimensions[i][which1]}-${faceDimensions[j][1]}-${faceDimensions[k][which2]}`);
                                break;
                            default:
                                faces.push(`${faceDimensions[i][which1]}-${faceDimensions[j][which2]}-${faceDimensions[k][0]}`);
                                faces.push(`${faceDimensions[i][which1]}-${faceDimensions[j][which2]}-${faceDimensions[k][1]}`);
                                break;
                        }
                    }
            rnd.shuffleFisherYates(faces);
            let colorPermutations = rnd.shuffleFisherYates(["RYGB", "RYBG", "RGYB", "RGBY", "RBYG", "RBGY", "YRGB", "YRBG", "YGRB", "YGBR", "YBRG", "YBGR", "GRYB", "GRBY", "GYRB", "GYBR", "GBRY", "GBYR", "BRYG", "BRGY", "BYRG", "BYGR", "BGRY", "BGYR"]);

            let faceTds = document.getElementsByClassName('face');
            let orderTds = document.getElementsByClassName('order');
            for (let i = 0; i < 20; i++)
            {
                faceTds[i].innerText = faces[i];
                orderTds[i].innerText = colorPermutations[i];
            }
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">The Ultracube</span>
            </div>
            <div class="page-content">
                <img class="diagram" src="img/Component/The Ultracube.svg">
                <h2>On the Subject of The Ultracube</h2>

                <p class="flavour-text">Oh I know this one! Wait, it looks different... Why are there more lines now?</p>

                <p>Observe the sequence of five 5D rotations of the Ultracube. There is a brief pause when the sequence repeats.</p>
                <p>From the first four rotations, obtain four Ultracube faces as listed in the <em>Face</em> column in the below table.</p>
                <p>From the fifth rotation, obtain a sequence of colors as listed in the <em>Order</em> column in the below table.</p>

                <table class="ultracube-rotations">
                    <tr><th>Rot.</th><th>Face</th><th>Order</th><td class="sep" rowspan="20"></td><th>Rot.</th><th>Face</th><th>Order</th></tr>
                    <tr><th>XY</th><td class="face">zag-top-right</td><td class="order">RBGY</td><th>YX</th><td class="face">ping-top-back</td><td class="order">YBRG</td></tr>
                    <tr><th>XZ</th><td class="face">top-back-right</td><td class="order">YGBR</td><th>ZX</th><td class="face">zag-front-right</td><td class="order">RBYG</td></tr>
                    <tr><th>XW</th><td class="face">pong-top-left</td><td class="order">BRYG</td><th>WX</th><td class="face">ping-zig-back</td><td class="order">RYGB</td></tr>
                    <tr><th>XV</th><td class="face">bottom-back-right</td><td class="order">BYRG</td><th>VX</th><td class="face">ping-zig-top</td><td class="order">YRGB</td></tr>
                    <tr><th>YZ</th><td class="face">zig-top-back</td><td class="order">BYGR</td><th>ZY</th><td class="face">zag-top-back</td><td class="order">BGRY</td></tr>
                    <tr><th>YW</th><td class="face">pong-back-left</td><td class="order">BRGY</td><th>WY</th><td class="face">zag-bottom-right</td><td class="order">GRYB</td></tr>
                    <tr><th>YV</th><td class="face">zig-front-right</td><td class="order">YGRB</td><th>VY</th><td class="face">pong-top-right</td><td class="order">YRBG</td></tr>
                    <tr><th>ZW</th><td class="face">pong-zag-right</td><td class="order">GRBY</td><th>WZ</th><td class="face">ping-bottom-back</td><td class="order">GYBR</td></tr>
                    <tr><th>ZV</th><td class="face">ping-zig-bottom</td><td class="order">GBRY</td><th>VZ</th><td class="face">pong-zag-left</td><td class="order">RGBY</td></tr>
                    <tr><th>WV</th><td class="face">ping-zag-back</td><td class="order">GYRB</td><th>VW</th><td class="face">pong-back-right</td><td class="order">BGYR</td></tr>
                </table>

                <svg xmlns="http://www.w3.org/2000/svg" style="width:7cm;float:right" viewBox="-5 -6 127 120"><defs><marker id="a" orient="auto" overflow="visible"><path fill="#a0a0a0" fill-rule="evenodd" stroke="#a0a0a0" stroke-width="1.1" d="M-10 0l-4 4L0 0l-14-4z"/></marker><marker id="b" orient="auto" overflow="visible"><path fill="#a0a0a0" fill-rule="evenodd" stroke="#a0a0a0" stroke-width="1.1" d="M10 0l4-4L0 0l14 4z"/></marker><marker id="e" orient="auto" overflow="visible"><path fill="#a0a0a0" fill-rule="evenodd" stroke="#a0a0a0" stroke-width="1.1" d="M-10 0l-4 4L0 0l-14-4z"/></marker><marker id="f" orient="auto" overflow="visible"><path fill="#a0a0a0" fill-rule="evenodd" stroke="#a0a0a0" stroke-width="1.1" d="M10 0l4-4L0 0l14 4z"/></marker><marker id="c" orient="auto" overflow="visible"><path fill="#a0a0a0" fill-rule="evenodd" stroke="#a0a0a0" stroke-width="1.1" d="M-10 0l-4 4L0 0l-14-4z"/></marker><marker id="d" orient="auto" overflow="visible"><path fill="#a0a0a0" fill-rule="evenodd" stroke="#a0a0a0" stroke-width="1.1" d="M10 0l4-4L0 0l14 4z"/></marker></defs><path fill="#d2d2d2" stroke="#000" stroke-linecap="round" stroke-width=".5" d="M100 21.5a7.5 7.5 0 0 1-7.5 7.5 7.5 7.5 0 0 1-7.5-7.5 7.5 7.5 0 0 1 7.5-7.5 7.5 7.5 0 0 1 7.5 7.5zM20 14v80h80V34a20 20 0 0 1-20-20z" /><path fill="none" stroke="#000" d="M97.5 16.5v40"/><path fill="none" stroke="#a0a0a0" marker-end="url(#a)" marker-start="url(#b)" d="M115 39L5 94"/><path fill="none" stroke="#000" d="M22.5 91.5v-40m70 25l5-20"/><path fill="none" stroke="#a0a0a0" marker-end="url(#c)" marker-start="url(#d)" d="M117.5 69H2.5"/><path fill="none" stroke="#000" d="M92.5 36.5v40"/><text x="13.4" y="57.9" font-family="Special Elite" font-size="6.7" font-weight="400" text-anchor="end"><tspan x="13.4" y="57.9">−X</tspan> <tspan x="13.4" y="63.9">left</tspan></text><text x="102.5" y="56.6" font-family="Special Elite" font-size="6.7" font-weight="400"><tspan x="102.5" y="56.6">+X</tspan> <tspan x="102.5" y="62.6">right</tspan></text><text x="54.4" y="1.9" font-family="Special Elite" font-size="6.7" font-weight="400" text-anchor="end"><tspan x="54.4" y="1.9">+Z</tspan> <tspan x="54.4" y="7.9">back</tspan></text><text x="64.7" y="104.8" font-family="Special Elite" font-size="6.7" font-weight="400"><tspan x="64.7" y="104.8">−Z</tspan> <tspan x="64.7" y="110.8">front</tspan></text><text x="37.5" y="99.9" font-family="Special Elite" font-size="6.7" font-weight="400" text-anchor="end"><tspan x="12.5" y="99.9">−W</tspan> <tspan x="12.5" y="105.9">zig</tspan></text><path fill="none" stroke="#a0a0a0" marker-end="url(#a)" marker-start="url(#b)" d="M75-3.5l-28.8 115"/><text x="43.3" y="102.1" font-family="Special Elite" font-size="6.7" font-weight="400" text-anchor="end"><tspan x="43.3" y="103.1">−V</tspan> <tspan x="43.3" y="109.1">ping</tspan></text><text x="66" y="-.1" font-family="Special Elite" font-size="6.7" font-weight="400"><tspan x="77.9" y="1.9">+V</tspan> <tspan x="77.9" y="8.9">pong</tspan></text><text x="117.5" y="26.1" font-family="Special Elite" font-size="6.7" font-weight="400" text-anchor="end"><tspan x="117.5" y="29.1">+W</tspan> <tspan x="117.5" y="35.1">zag</tspan></text><path fill="none" stroke="#000" d="M92.5 36.5l5-20m-35 35l5-20m-5 60l5-20m-15 5l5-20m-5-20l5-20m-35 75l5-20m-5-20l5-20m0 40v-40m40 0v40m30-55l-30 15m-10-15v40m0-40h40"/><path fill="none" stroke="#a0a0a0" marker-end="url(#e)" marker-start="url(#f)" d="M60-3.5v115"/><path fill="none" stroke="#000" stroke-linecap="round" d="M67.5 71.5h-40m40-40h-40m70 25h-40m-30 15l30-15m0-40l-30 15m70 25l-30 15m-5-20v40m30-55l-30 15m-10-15v40m10-25h-40m40 40h-40m30-55h40m0 40h-40m-30 15l30-15m0-40l-30 15m70 25l-30 15"/></svg>

                <p>The rotations are identified by which positive axis direction rotates into which other positive axis direction.</p>
                <p>To begin, touch any vertex of the Ultracube. This will cause the rotations to cease. You can resume the rotations and cancel your input by long-pressing on any vertex.</p>
                <p>On the face identified by the first rotation, touch the vertex of the color identified by the first color in the color order obtained earlier.</p>
                <p>Repeat this with the remaining rotations and colors in the sequence.</p>
                <p>A mistake will cause the rotations to resume and your progress to reset. The sequence of rotations remains the same, but the vertices may be colored differently.</p>
                <p>The Y axis not shown has +Y/top and −Y/bottom and is perpendicular to X and Z, meaning that it points out of the module, away from the bomb.</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 1</div>
        </div>
    </div>
</body>
</html>
