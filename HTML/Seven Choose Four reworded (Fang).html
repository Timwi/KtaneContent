<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Seven Choose Four — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/jquery.3.7.0.min.js"></script>
    <script src="js/Utilities/svg-utils.js"></script>
    <script>
    $(function() {
        let grid = $(".gridholder");
        let svg = MakeSvgTag(440,432).appendTo(grid);

        let rows = 4;
        let cols = 4;
        let h = 97;
        let w = 102;
        for (let r = 0; r < rows; r++) {
            let text1 = MakeSvgElem("text", { x:(80+r*w), y:30, });
            text1.innerHTML = r;
            let text2 = MakeSvgElem("text", { x:20, y:(95+r*h), });
            text2.innerHTML = r;
            svg.append(text1);
            svg.append(text2);
            for (let c = 0; c < cols; c++) {
                let cell = MakeSvgElem("rect", {
                    class: "highlightable", x:(30+c*w), y:(35+r*h),
                    width:w, height:h, fill:"transparent"
                });
                svg.append(cell);
            }
        }
    });
    </script>
    <style>
        table.alpha {
            font-size: 13px;
            text-align: center;
            margin-left: auto;
            margin-right: auto;
        }
        table.center {
            text-align: center;
        }
        .dark table, table { border: none; }
        .dark .linestable { filter: invert(87%); }
        .gridholder {
            position: relative;
            width: 450px;
            height: 442px;
        }
        .gridholder img, .gridholder svg {
            position: absolute;
            width: 430px;
            bottom: 0;
            right: 0;
        }
        .gridholder svg { width: 450px; }
        svg text {
            font-size: 30px;
            text-anchor: middle;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Seven Choose Four.svg" class="diagram">
                <h2>On the Subject of Seven Choose Four</h2>
                <p class="flavour-text">Pomelo colors? Pomelo colors!</p>

                <p>This module consists of four pink buttons, each with a flashing LED next to them. </p>

                    <h3>Tips to Success Successfully:</h3>
                    <ul>
                        <li>In order to solve this module, you must submit four 4-digit codes in sequence.</li>
                        <li>There are 4 possible type of flashes: Morse Code, Tap Code, a sequence of colors, and a number of long flashes between 1 and 7.</li>
                        <li>The morse code and tap codes are deciphered in the usual way.
                        <br><strong>NOTE:</strong> Always use C instead of K if the received tap code is 13.</li>
                        <li>The sequence of colors will flash 5 different color.</li>
                        <li>The number of long flashes corresponds to the position of this list below:<br> <strong>R G B M C Y W</strong></li>
                        <li>Start from the LED which lights a sequence of colors, take the sequence of the colors and refer to the table below:</li>
                    </ul>
                    <table class = "alpha">
                        <tr><th>Position</th><th>Description</th></tr>
                        <tr><td>1</td><td>Color operator for Stage 1</td></tr>
                        <tr><td>2</td><td>Color operator for Stage 2</td></tr>
                        <tr><td>3</td><td>Color operator for Stage 3</td></tr>
                        <tr><td>4</td><td>Color operator for Stage 4</td></tr>
                        <tr><td>5</td><td>Input for Stage 1 (First letter of the color)</td></tr>
                    </table>
                    <ul>
                        <li>The inputs for subsequent stages are based on the position of the LED which lights a sequence of colors, where remaining inputs continue from the its location downward, wrapping around as necessary.</li>
                        <li>The instructions to determine the 4-digit code for each color operator can be found below.</li>
                    </ul>
                    <p><strong>NOTE:</strong> When entering the code, shift down by N times, wrapping around as necessary, where N = (Current stage number - 1).</p>
                    <p>The module will only issue a strike after the 4-digit code is submitted. If you receive a strike, the input of the current stage will be reset.</p>
                    <p>When a 4-digit code is entered correctly, the button associated with that color will turn green. Once all four buttons are green the module is solved.</p>
                </div>
            <div class="page-footer relative-footer">Page 1 of 7</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <h3>Red</h3>
                <ol>
                    <li>Convert the input key to a number using its alphabetic position (A1Z26).</li>
                    <li>If the number is less than 10, keep the leading 0. (01, 02, etc.)</li>
                    <li>Add number of ports on the bomb which contain the letter <strong>R</strong> in their name. If the number is now greater than 99, use the 2 least significant digits.</li>
                    <li>Convert each digit to 1 if they are odd, and 0 if they are even.</li>
                    <li>Consult the table of logic gates to determine which gate you should use depending on the current stage.</li>
                    <li>Use the two digits as the input for the gate, with 1 being true and 0 being false (See Table Help for help with logic gates).</li>
                    <li>Find your code in the table based on whether the output of the logic gate is true or false.</li>
                </ol>

                <table class="center">
                    <tr><td class="corner"></td><th colspan="4">Stage Number</th></tr>
                    <tr><th class="corner"></th><th>1</th><th>2</th><th>3</th><th>4</th></tr>
                    <tr><th>Logic Output</th><th>NOR</th><th>XOR</th><th>OR</th><th>AND</th></tr>
                    <tr><th>True</th><td>1423</td><td>2314</td><td>4123</td><td>2341</td></tr>
                    <tr><th>False</th><td>2313</td><td>4231</td><td>2233</td><td>1231</td></tr>
                </table>
                <div style="height: 15mm"></div>
                <h4>Table Help:</h4>
                <table class="center">
                    <tr><th rowspan="2">Bit</th><th colspan="4">Logic Gates</th></tr>
                    <tr><th>NOR</th><th>XOR</th><th>OR</th><th>AND</th></tr>
                    <tr><td>00</td><td>1</td><td>0</td><td>0</td><td>0</td></tr>
                    <tr><td>01</td><td>0</td><td>1</td><td>1</td><td>0</td></tr>
                    <tr><td>10</td><td>0</td><td>1</td><td>1</td><td>0</td></tr>
                    <tr><td>11</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 2 of 7</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <h3>Green</h3>
                <ol>
                    <li>Convert the input key to a number using its alphabetic position (A1Z26).</li>
                    <li>If the number is less than 10, keep the leading 0. (01, 02, etc.)</li>
                    <li>Add to each digit independently the number of G's and 7's in the serial number, and then take each digit modulo 4.</li>
                    <li>Use these two digits in all four combinations as row and column (top-left is 0,0) to find four cells in the <strong>Lines Table</strong> (example AB =&gt; AA, AB, BA, BB).</li>
                    <li>Add up the number of lines in all four cells, and use this information to find the 4-digit combination in the table below.</li>
                    <li>Take the combination associated with the current stage number. If the number of lines you counted is even, reverse the sequence.</li>
                </ol>

                <h3>Lines Table</h3>
                <div class="gridholder"><img class="linestable" src="img/Seven Choose Four/Lines Table.png"/></div>
                <div style="height: 12mm"></div>
                <table class="center">
                    <tr><th colspan="4">Stage Number</th></tr>
                    <tr><th>1</th><th>2</th><th>3</th><th>4</th></tr>
                    <tr><td>3241</td><td>1122</td><td>4332</td><td>1231</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 3 of 7</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <h3>Blue</h3>
                <ol>
                    <li>Convert the input key to a number using its alphabetic position (A1Z26).</li>
                    <li>Subtract 5 until it is within the range between 1–5. This is the row value.</li>
                    <li>For the column, use the first letter in serial number that is between A–E.
                        <br>If no such letter exists, then convert the row number to a letter (A=1,B=2,etc.) and use this letter as the column.</li>
                    <li>This is your starting coordinate in the grid below.</li>
                    <li>First, point in the direction which allows you to travel the longest possible distance before hitting the edge of the grid. Ties are broken with a priority list of North, East, South, West.</li>
                    <li>Travel in this direction a number of spaces equal to the number of AA batteries on the bomb.</li>
                    <li>Then, reorient again using the same rule, with a priority list of South, West, North, East; and travel a number of spaces equal to the number of D batteries on the bomb.</li>
                    <li>The space you land on has the 4-digit combination.</li>
                </ol>
                <p><strong>NOTE:</strong> Do not wrap around, instead stay if you’ve reached the edge of the grid.</p>

                <table class="center">
                    <tr><th class="corner"></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>
                    <tr><th>1</th><td>1234</td><td>1243</td><td>2134</td><td>2143</td><td>3124</td></tr>
                    <tr><th>2</th><td>3142</td><td>1324</td><td>1342</td><td>1423</td><td>1432</td></tr>
                    <tr><th>3</th><td>4123</td><td>4132</td><td>2314</td><td>2341</td><td>3214</td></tr>
                    <tr><th>4</th><td>3241</td><td>2413</td><td>2431</td><td>4213</td><td>4231</td></tr>
                    <tr><th>5</th><td>3412</td><td>3421</td><td>4312</td><td>4321</td><td>1234</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 4 of 7</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <h3>Magenta</h3>
                <ol>
                    <li>Find the key letter in the grid below.</li>
                    <li>Also locate the first four characters of the serial number in the grid, converting numbers to their character corresponding to their alphabetical positions, after adding 1 (A=0, Z=25).</li>
                    <li>Calculate the number of spaces it would take to travel the shortest path, only moving orthogonally (not diagonally), from the input to each of the four characters noted from the serial.</li>
                    <li>Add or subtract 4 until it is within the range 1–4 inclusive.</li>
                    <li>These four modified distances in order, are the 4-digit combination.</li>
                </ol>
                <p><strong>NOTE:</strong> A and Z are interchangeable in the grid.</p>

                <table class="center">
                    <tr><th>L</th><th>P</th><th>R</th><th>I</th><th>S</th></tr>
                    <tr><th>X</th><th>O</th><th>F</th><th>B</th><th>V</th></tr>
                    <tr><th>A</th><th>Y</th><th>D</th><th>C</th><th>T</th></tr>
                    <tr><th>K</th><th>G</th><th>W</th><th>Q</th><th>N</th></tr>
                    <tr><th>M</th><th>E</th><th>U</th><th>H</th><th>J</th></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 5 of 7</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <h3>Cyan</h3>
                <ol>
                    <li>Convert the key to a number using its alphabetic position (A1Z26) and subtract 7 until the number is between 1 and 7.</li>
                    <li>This number corresponds with the color in the corresponding position of this list <strong>R G B M C Y W</strong>.</li>
                    <li>You need 3 other color operator (except for this stage) to find the combination.</li>
                    <li>Find your combination by concatenating the 4 values you obtain based on the number of primary and secondary colors among these 4 colors. The two primary numbers should be placed before the two secondary numbers (<strong>XXYY</strong>).</li>
                    <li>For the purposes of calculating <strong>P</strong> and <strong>S</strong>, the number of primary and secondary colors, respectively, <strong>R G B</strong> and <strong>W</strong> count as primary, and <strong>M C Y</strong> and <strong>W</strong> count as secondary.</li>
                </ol>

                <table class="center">
                    <tr><th>#P</th><th>XX</th><th>#S</th><th>YY</th></tr>
                    <tr><th>0P</th><td>12</td><th>0S</th><td>34</td></tr>
                    <tr><th>1P</th><td>13</td><th>1S</th><td>23</td></tr>
                    <tr><th>2P</th><td>13</td><th>2S</th><td>31</td></tr>
                    <tr><th>3P</th><td>42</td><th>3S</th><td>24</td></tr>
                    <tr><th>4P</th><td>43</td><th>4S</th><td>14</td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 6 of 7</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Seven Choose Four</span>
            </div>
            <div class="page-content">
                <h3>Yellow</h3>
                <ol>
                    <li>Take the input for this stage and remove the letter from the word <strong>YELLOW</strong> which is closest to the key letter.
                        <br>Remove the letter further in the alphabet if it’s same distance.
                        <br>If the letter to remove is <strong>L</strong>, only remove one of them.
                        <br><strong>NOTE:</strong> Do not wrap around. eg. Difference between Z and A is NOT 1.
                    </li>
                    <li>Atbash cipher the key (the input from Step 1) (A-&gt;Z, B-&gt;Y, C-&gt;X, etc.) and repeat the step above.</li>
                    <li>You should have 4 letters left in the word <strong>YELLOW</strong>.</li>
                    <li>Shift these letters to the right based on the stage number, wrapping around as needed.</li>
                    <li>Replace the letters with numbers 1–4 based on the order in which they appear in the alphabet (Ex. YELO = 4123), ordering the same letter from left to right if it is the same letter (Ex. YLLO = 4123).</li>
                </ol>

                <h3>White</h3>
                <p>Using the key, and the current stage number, choose any other color operator, and 4-digit combinations will work as the solution for this color.</p>

                <p>Tip: Don’t be lazy.</p>
            </div>
            <div class="page-footer relative-footer">Page 7 of 7</div>
        </div>
    </div>
</body>
</html>