<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>メカナス暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">メカナス暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Mechanus Cipher.svg" class="diagram">
                <h2>モジュール詳細：メカナス暗号</h2>
                <p class="flavour-text">構造物を運んでくるクリーチャーが潜む習慣にちなんで名付けられた暗号。</p>

                <p>モジュールには、文字が書かれた二段のパネルと別の追加パネル、「SUB」と書かれた送信パネル、二つの英字付き歯車がある。</p>
                <p>いずれかの段にあるパネルを押すと、その段のパネルが裏返しになる。上段は、暗号化された単語、キーワード、二進数が表示される。下段は、2組の数字と2つ目のキーワードが表示され、追加パネルにはキー英字が表示される。</p>
                <p>このモジュールを解除するには、以下の手順に従って単語を解読し、歯車を使って送信する。送信するには、歯車を押して回転させ、選択中の英字を入力したいときに送信ボタンを押す。パネルを裏返すと、入力が消去される。</p>
                <h3>単語の解読</h3>
                <h4>ステップ0 - キーの作成</h4>
                <p>ステップ2と3では、とあるキーが必要になる。このキーを作るには、上段からキーワードを取り出し、26文字になるまでこれを繰り返す。次に、この文字列にあるすべての英字を読み順に見て、その英字がすでに出現している場合は、そうでなくなるまで次のアルファベットにずらす。</p>
                <p style="font-size: small"><strong>例：</strong> TROUPER -&gt; TROUPERTROUPERTROUPERTROUP -&gt; TROUPESVWQXYFZABCDGHIJKLMN</p>
                <h4>ステップ1 - パンケーキ転置</h4>
                <p>上段から暗号化された単語を取り出し、下段から2つの数字を取得する。両方の数字から最初の数字を取り出し、端点を含む2つの数字と同じ位置の間にある英字のグループを逆順にする。文字列の他の数字についても同じことを繰り返す</p>
                <p style="font-size: small"><strong>例：</strong> EOISDYN, 1223236 2456565<br>EOISDYN 12 -&gt; OEISDYN<br>OEISDYN 24 -&gt; OSIEDYN<br>OSIEDYN 25 -&gt; ODEISYN<br>ODEISYN 36 -&gt; ODYSIEN<br>ODYSIEN 25 -&gt; OISYDEN<br>OISYDEN 36 -&gt; OIEDYSN<br>OIEDYSN 56 -&gt; OIEDSYN</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/3</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">メカナス暗号</span>
            </div>
            <div class="page-content">
                <h4>ステップ2 - バイナリギア暗号</h4>
                <p>前のステップの暗号化された単語、ステップ0のキー、追加パネルのキー英字、上段の二進数を取得する。キー内の文字列を含む列と、1111から始まる4ビットの二進数の列を作る。二進数の列は0000、キー列はキー英字から始める。そして、暗号化された単語の一番目の英字に当たるまで、必要であればループしながら両方の列内を同時に上に移動し、二進数の列からその位置の値を記録する。他の英字についても、先程終了したところからこれを繰り返す。暗号化された単語の英字が、直前の英字と同じであれば、再びその英字に当たるまで、両方の列内を上へ移動する(これは、暗号化された単語の一番目の英字がキー英字である場合にも適用される)。これらすべての二進数を末尾に追加して1つの大きな文字列にし、それを4つの等しいグループに分割し、二進数テーブルとして設定する。</p>
                <p>二進数テーブルの左端の列を上から下へ読む。直前に終了した場所から始めて、この二進数に到達するまで両方の列を上に移動する。二進数文字列の1桁目が1なら、再び二進数に到達するまで上へ移動する。その英字が新しい英字となる。二進数テーブルのすべての列についてこれを繰り返す。</p>
                <p style="font-size: small"><strong>例：</strong> OIEDSYN, A, 1100000</p>
                <table style="float: left; font-size: 50%; font-family:'Special Elite';"><tr><td>T</td></tr><tr><td>R</td></tr><tr><td>O</td></tr><tr><td>U</td></tr><tr><td>P</td></tr><tr><td>E</td></tr><tr><td>S</td></tr><tr><td>V</td></tr><tr><td>W</td></tr><tr><td>Q</td></tr><tr><td>X</td></tr><tr><td>Y</td></tr><tr><td>F</td></tr><tr><td>Z</td></tr><tr><td>A</td></tr><tr><td>B</td></tr><tr><td>C</td></tr><tr><td>D</td></tr><tr><td>G</td></tr><tr><td>H</td></tr><tr><td>I</td></tr><tr><td>J</td></tr><tr><td>K</td></tr><tr><td>L</td></tr><tr><td>M</td></tr><tr><td>N</td></tr></table>
                <table style="float: left; margin-left: 10%; font-size: 65%;font-family:'Special Elite';"><tr><td>1111</td></tr><tr><td>1110</td></tr><tr><td>1101</td></tr><tr><td>1100</td></tr><tr><td>1011</td></tr><tr><td>1010</td></tr><tr><td>1001</td></tr><tr><td>1000</td></tr><tr><td>0111</td></tr><tr><td>0110</td></tr><tr><td>0101</td></tr><tr><td>0100</td></tr><tr><td>0011</td></tr><tr><td>0010</td></tr><tr><td>0001</td></tr><tr><td>0000</td></tr></table>
                <table style="float: left; margin-left: 10%; font-size: 65%"><tr><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td></tr><tr><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td></tr><tr><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td></tr></table>
                <p style="font-size: small; float: left; margin-left: 10%">O -&gt; 1100<br>I -&gt; 0100<br>E -&gt; 0011<br>D -&gt; 0001<br>S -&gt; 1100<br>Y -&gt; 0001<br>N -&gt; 1101</p>
                <p style="font-size: small; float: left; margin-left: 10%">(+1)1000 -&gt; M<br>(+1)1010 -&gt; S<br>(+0)0011 -&gt; L<br>(+0)0111 -&gt; H<br>(+0)0101 -&gt; E<br>(+0)1000 -&gt; O<br>(+0)0001 -&gt; H</p>
            </div>
            <div class="page-footer relative-footer">ページ 2/3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">メカナス暗号</span>
            </div>
            <div class="page-content">
                <h4 style="clear: both">ステップ3 - 神出鬼没英字暗号</h4>
                <p>前のステップで暗号化した単語、ステップ0のキー、下段のキーワードを取得する。キーを3次元空間で読み順に配置しながら奥から手前に積み、3×3×3の3次元グリッドにする。余ったスペースには#のラベルを貼る。暗号化された単語とキーワードの最初の英字をこのグリッドから探す。各グリッドの軸に対し、2つの英字が同じ位置にあれば、新しい英字はその軸上の同じ位置にある。位置が異なる場合、新しい英字はその軸上で使われていない位置に置かれる。新しい英字は、3つの軸をすべて評価した後に見つけた場所に位置する。これが「#」の場合、それは暗号化された単語の英字になる。暗号化された単語のすべての文字についてこれを繰り返し、できあがった単語を送信する。</p>
                <p style="font-size: small"><strong>例：</strong> MSLHEOH, CHIMERA</p>
                <table style="float: left; font-size: 65%"><tr><th colspan="3">z=1</th><th colspan="3">z=2</th><th colspan="3">z=3</th></tr><tr><td>T</td><td>R</td><td>O</td><td>Q</td><td>X</td><td>Y</td><td>G</td><td>H</td><td>I</td></tr><tr><td>U</td><td>P</td><td>E</td><td>F</td><td>Z</td><td>A</td><td>J</td><td>K</td><td>L</td></tr><tr><td>S</td><td>V</td><td>W</td><td>B</td><td>C</td><td>D</td><td>M</td><td>N</td><td>#</td></tr></table>
                <p style="font-size: small; float: left; margin-left: 10%">M+C -&gt; W<br>S+H -&gt; A<br>L+I -&gt; # -&gt; L<br>H+M -&gt; L<br>E+E -&gt; E<br>O+R -&gt; T<br>H+A -&gt; S</p>
            </div>
            <div class="page-footer relative-footer">ページ 3/3</div>
        </div>
    </div>
</body>
</html>