<!DOCTYPE html>
<html>
    <head>
        <title>Cheap Checkout - Keep Talking and Nobody Explodes Mod</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1">
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <link rel="stylesheet" type="text/css" href="css/font.css">
        <script src="js/ktane-utils.js"></script>
        <script src="js/ruleseed.js"></script>
        <style type="text/css">
            .borderless {
                border: none;
            }

            .sale {
                margin-bottom: 5px;
            }

            .squished {
                margin-top: 0px;
                margin-bottom: 0px;
            }
        </style>
        <script>
            let Prices = [
                // Original 33 items
                "Candy Canes,3.51,Sweet",
                "Socks,6.97,Other",
                "Lotion,7.97,Care Product",
                "Cheese,4.49,Dairy",
                "Mints,6.39,Sweet",
                "Grape Jelly,2.98,Sweet",
                "Honey,8.25,Sweet",
                "Sugar,2.08,Sweet",
                "Soda,2.05,Sweet",
                "Tissues,3.94,Care Product",
                "White Bread,2.43,Grain",
                "Canola Oil,2.28,Oil",
                "Mustard,2.36,Other",
                "Deodorant,3.97,Care Product",
                "White Milk,3.62,Dairy",
                "Pasta Sauce,2.30,Vegetable",
                "Lollipops,2.61,Sweet",
                "Cookies,2.00,Sweet",
                "Paper Towels,9.46,Care Product",
                "Tea,2.35,Water",
                "Coffee Beans,7.85,Other",
                "Mayonnaise,3.99,Oil",
                "Chocolate Milk,5.68,Dairy",
                "Fruit Punch,2.08,Sweet",
                "Potato Chips,3.25,Oil",
                "Shampoo,4.98,Care Product",
                "Toothpaste,2.50,Care Product",
                "Peanut Butter,5.00,Protein",
                "Gum,1.12,Sweet",
                "Water Bottles,9.37,Water",
                "Spaghetti,2.92,Grain",
                "Chocolate Bar,2.10,Sweet",
                "Ketchup,3.59,Other",
                "Cereal,4.19,Grain",

                // New ruleseed items
                "Eggs,2.67,Protein",
                "Baked Beans,1.14,Protein",
                "Peanuts,5.98,Protein",
                "Yogurt,2.72,Dairy",
                "Greek Yogurt,3.47,Dairy",
                "Butter,5.86,Dairy",
                "Toothbrush,2.24,Care Product",
                "Medicine,3.73,Care Product",
                "Soup,1.99,Care Product",
                "Soap,3.97,Care Product",
                "Pretzels,2.98,Grain",
                "Popcorn,2.50,Grain",
                "Oatmeal,7.98,Grain",
                "Rice,2.02,Grain",
                "Flour,3.49,Grain",
                "Licorice,1.98,Sweet",
                "Pie,3.98,Sweet",
                "Cake,9.98,Sweet",
                "Gummy Bears,7.98,Sweet",
                "Relish,2.74,Vegetable",
            ];

            let PricesLB = [
                // Original 11 items
                "Turkey,2.98,Protein",
                "Chicken,1.99,Protein",
                "Steak,4.97,Protein",
                "Pork,4.14,Protein",
                "Lettuce,1.10,Vegetable",
                "Potatoes,0.68,Vegetable",
                "Tomatoes,1.80,Fruit",
                "Broccoli,1.39,Vegetable",
                "Oranges,0.80,Fruit",
                "Lemons,1.74,Fruit",
                "Bananas,0.87,Fruit",
                "Grapefruit,1.08,Fruit",

                // New ruleseed items
                "Onion,1.82,Vegetable",
                "Bacon,5.52,Protein",
                "Apples,1.32,Fruit",
                "Grapes,2.98,Fruit",
                "Fish,9.99,Protein",
                "Watermelon,0.32,Fruit",
                "Carrots,0.77,Vegetable",
                "Cherries,3.21,Fruit",
                "Plums,1.99,Fruit",
                "Pumpkins,1.38,Fruit",
                "Avocados,2.23,Fruit",
                "Ham,2.88,Protein",
                "Sausages,3.88,Protein",
                "Corn,1.14,Vegetable",
            ];

            let SundayValue = 215;
            let MondayPercent = 85;
            let ThursdayOddItems = true;
            let ThursdayPercent = 50;
            let FridayPercent = 125;
            let SaturdayPercent = 65;

            function toDollars(intDollars) {
                const stringDollars = intDollars.toString();
                if (intDollars < 100) return "0." + intDollars;
                else return stringDollars.substring(0, stringDollars.length - 2) + "." + stringDollars.substring(stringDollars.length - 2);
            }

            function toRelativePercent(absolutePercent) {
                if (absolutePercent > 100) return `${absolutePercent - 100}% more`;
                else if (absolutePercent == 50) return "half off";
                else return `${100 - absolutePercent}% off`;
            }

            function setDefaultRules(rng) {
                setRules(rng);
            }

            function setRules(rng) {
                if (rng.seed == 1)
                {
                    Prices = Prices.slice(0, 34);
                    PricesLB = PricesLB.slice(0, 12);
                }
                else
                {
                    Prices = rng.shuffleFisherYates(Prices).slice(0, 33);
                    PricesLB = rng.shuffleFisherYates(PricesLB).slice(0, 11);

                    for (var [index, item] of Prices.entries()) {
                        var split = item.split(",");
                        var intDollars = parseInt(split[1].replace(".", ""));
                        intDollars += rng.next(-10, 11);
                        split[1] = toDollars(intDollars);
                        Prices[index] = split.join(",");
                    }

                    for (var [index, item] of PricesLB.entries()) {
                        var split = item.split(",");
                        var intDollars = parseInt(split[1].replace(".", ""));
                        intDollars += rng.next(-10, 11);
                        split[1] = toDollars(intDollars);
                        PricesLB[index] = split.join(",");
                    }

                    SundayValue = rng.next(50, 301);
                    MondayPercent = rng.next(10, 100);
                    ThursdayOddItems = rng.next(0, 2) == 1;
                    ThursdayPercent = rng.next(25, 76);
                    FridayPercent = rng.next(50, 201);
                    SaturdayPercent = rng.next(50, 201);
                }

                const seededStrings = [
                    toDollars(SundayValue),
                    toRelativePercent(MondayPercent),
                    ThursdayOddItems ? "odd" : "even",
                    toRelativePercent(ThursdayPercent),
                    toRelativePercent(FridayPercent),
                    toRelativePercent(SaturdayPercent)
                ];

                const seededSpans = document.querySelectorAll("span.rule-seeded");
                for (const [index, seededSpan] of seededSpans.entries()) {
                    seededSpan.textContent = seededStrings[index];
                }

                const rows = Array.from(document.querySelectorAll("tr")).slice(1);
                for (const [index, itemString] of Prices.concat(PricesLB).sort().entries()) {
                    const children = rows[index % rows.length].children;
                    const item = itemString.split(",");
                    const columnOffset = Math.floor(index / rows.length) * 4;

                    children[columnOffset].textContent = item[0];
                    children[columnOffset + 1].textContent = `$${item[1]}${ PricesLB.includes(itemString) ? " per lb" : "" }`;
                    children[columnOffset + 2].textContent = item[2];
                }
            }
        </script>
    </head>
    <body>
        <div class="section">
            <div class="page page-bg-01">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Cheap Checkout</span>
                </div>
                <div class="page-content">
                    <img class="diagram" src="img/Component/Cheap%20Checkout.svg">
                    <h2>On the Subject of Cheap Checkout</h2>
                    <p class="flavour-text">Who in the world is purchasing something at a time like this?</p>
                    <ul class="squished">
                        <li>There is a shopping list of items that are being purchased and can be viewed with the arrow buttons.</li>
                        <li>Above that, it shows the amount the customer paid.</li>
                        <li>Add up the amount of money it costs for all the items, applying the sale to each item based on the day of the week.</li>
                        <li>Weighted items must have their weight applied before applying the sale.</li>
                        <li>If the customer has paid enough money, simply input the correct amount of change the customer should receive using the buttons on the module and then press submit.</li>
                        <li>Otherwise if the customer hasn’t paid enough, press submit without any change to alert the customer. Wait for the new amount of money from the customer and then figure out how much change to give.</li>
                        <li>After pressing the submit button, the change will be cleared.</li>
                    </ul>
                    <h3 class="squished">Glossary</h3>
                    <ul class="squished">
                        <li>Item price refers to the price before the sale has been applied.</li>
                        <li>Fixed price items don’t have their prices change based on their weight.</li>
                        <li>A digital root is calculated by adding all the digits of a number together and repeating the process on the new number until you have a single digit.</li>
                        <li>Commercial rounding is when the digit checked for rounding is 5 or greater, the number is rounded up, otherwise you round down.</li>
                    </ul>

                    <h3 class="squished">Sales:</h3>
                    <div style="font-style: italic; font-size: 13px;">The day of the week is the date listed on the defuser’s computer when the module is activated.</div>

                    <em>Special Sunday</em>
                    <div class="sale">All fixed price items that contain an S in them are $<span class="rule-seeded">2.15</span> more.</div>

                    <em>Malleable Monday</em>
                    <div class="sale">The 1st, 3rd and 6th items on the shopping list are <span class="rule-seeded">15% off</span>.</div>

                    <em>Troublesome Tuesday</em>
                    <div class="sale">Calculate the digital root of the item price without the decimal point. Add that many dollars to the item price. Only applies to fixed price items.</div>

                    <em>Wacky Wednesday</em>
                    <div class="sale">Change each occurrence of the largest digit in the price with the smallest digit in the price, and vice versa.</div>

                    <em>Thrilling Thursday</em>
                    <div class="sale">All of the <span class="rule-seeded">odd</span> positioned items on the shopping list are <span class="rule-seeded">half off</span>.</div>

                    <em>Fruity Friday</em>
                    <div class="sale">All fruits are <span class="rule-seeded">25% more</span> per pound.</div>

                    <em>Sweet Saturday</em>
                    <div class="sale">All sweet items are <span class="rule-seeded">35% off</span>.</div>
                </div>
                <div class="page-footer relative-footer">Page 1 of 3</div>
            </div>
            <div class="page page-bg-02">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Cheap Checkout</span>
                </div>
                <div class="page-content">
                    <h3>Item Prices:</h3>
                    <div style="font-style: italic; font-size: 14px;">Prices should always be kept in terms of dollars, for example, $0.68 instead of 68¢. All item prices are rounded to the 2nd decimal. You must commercially round after calculating the item price as well as after applying the sale.</div>
                    <table class="borderless">
                        <tr>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Category</th>
                            <th class="borderless"></th>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Category</th>
                        </tr>
                        <tr><td>Bananas</td><td>$0.87 per lb</td><td>Fruit     </td><td class="borderless"></td><td>Mints</td><td>$6.39</td><td>Sweet              </td></tr>
                        <tr><td>Broccoli</td><td>$1.39 per lb</td><td>Vegetable</td><td class="borderless"></td><td>Mustard</td><td>$2.36</td><td>Other            </td></tr>
                        <tr><td>Candy Canes</td><td>$3.51</td><td>Sweet        </td><td class="borderless"></td><td>Oranges</td><td>$0.80 per lb</td><td>Fruit     </td></tr>
                        <tr><td>Canola Oil</td><td>$2.28</td><td>Oil           </td><td class="borderless"></td><td>Paper Towels</td><td>$9.46</td><td>Care Product</td></tr>
                        <tr><td>Cereal</td><td>$4.19</td><td>Grain             </td><td class="borderless"></td><td>Pasta Sauce</td><td>$2.30</td><td>Vegetable    </td></tr>
                        <tr><td>Cheese</td><td>$4.49</td><td>Dairy             </td><td class="borderless"></td><td>Peanut Butter</td><td>$5.00</td><td>Protein    </td></tr>
                        <tr><td>Chicken</td><td>$1.99 per lb</td><td>Protein   </td><td class="borderless"></td><td>Pork</td><td>$4.14 per lb</td><td>Protein      </td></tr>
                        <tr><td>Chocolate Bar</td><td>$2.10</td><td>Sweet      </td><td class="borderless"></td><td>Potato Chips</td><td>$3.25</td><td>Oil         </td></tr>
                        <tr><td>Chocolate Milk</td><td>$5.68</td><td>Dairy     </td><td class="borderless"></td><td>Potatoes</td><td>$0.68 per lb</td><td>Vegetable</td></tr>
                        <tr><td>Coffee Beans</td><td>$7.85</td><td>Other       </td><td class="borderless"></td><td>Shampoo</td><td>$4.98</td><td>Care Product     </td></tr>
                        <tr><td>Cookies</td><td>$2.00</td><td>Sweet            </td><td class="borderless"></td><td>Socks</td><td>$6.97</td><td>Other              </td></tr>
                        <tr><td>Deodorant</td><td>$3.97</td><td>Care Product   </td><td class="borderless"></td><td>Soda</td><td>$2.05</td><td>Sweet               </td></tr>
                        <tr><td>Fruit Punch</td><td>$2.08</td><td>Sweet        </td><td class="borderless"></td><td>Spaghetti</td><td>$2.92</td><td>Grain          </td></tr>
                        <tr><td>Grape Jelly</td><td>$2.98</td><td>Sweet        </td><td class="borderless"></td><td>Steak</td><td>$4.97 per lb</td><td>Protein     </td></tr>
                        <tr><td>Grapefruit</td><td>$1.08 per lb</td><td>Fruit  </td><td class="borderless"></td><td>Sugar</td><td>$2.08</td><td>Sweet              </td></tr>
                        <tr><td>Gum</td><td>$1.12</td><td>Sweet                </td><td class="borderless"></td><td>Tea</td><td>$2.35</td><td>Water                </td></tr>
                        <tr><td>Honey</td><td>$8.25</td><td>Sweet              </td><td class="borderless"></td><td>Tissues</td><td>$3.94</td><td>Care Product     </td></tr>
                    </table>
                </div>
                <div class="page-footer relative-footer">Page 2 of 3</div>
            </div>
            <div class="page page-bg-03">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Cheap Checkout</span>
                </div>
                <div class="page-content">
                    <table class="borderless">
                        <tr><td>Ketchup</td><td>$3.59</td><td>Other           </td><td class="borderless"></td><td>Tomatoes</td><td>$1.80 per lb</td><td>Fruit  </td></tr>
                        <tr><td>Lemons</td><td>$1.74 per lb</td><td>Fruit     </td><td class="borderless"></td><td>Toothpaste</td><td>$2.50</td><td>Care Product</td></tr>
                        <tr><td>Lettuce</td><td>$1.10 per lb</td><td>Vegetable</td><td class="borderless"></td><td>Turkey</td><td>$2.98 per lb</td><td>Protein  </td></tr>
                        <tr><td>Lollipops</td><td>$2.61</td><td>Sweet         </td><td class="borderless"></td><td>Water Bottles</td><td>$9.37</td><td>Water    </td></tr>
                        <tr><td>Lotion</td><td>$7.97</td><td>Care Product     </td><td class="borderless"></td><td>White Bread</td><td>$2.43</td><td>Grain      </td></tr>
                        <tr><td>Mayonnaise</td><td>$3.99</td><td>Oil          </td><td class="borderless"></td><td>White Milk</td><td>$3.62</td><td>Dairy       </td></tr>       
                    </table>
                </div>
                <div class="page-footer relative-footer">Page 3 of 3</div>
            </div>
        </div>
    </body>
</html>
