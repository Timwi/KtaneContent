<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Robot Programming — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/jquery.3.7.0.min.js"></script>
    <style>
        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 90%;
        }
        .center2 {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 80%;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Robot Programming</span>
            </div>
            <div class="page-content">
                <img src= "img/Component/Robot Programming.svg" class="diagram">
                <h2>On the Subject of Robot Programming</h2>
                <p class="flavour-text">Every kid’s fantasy job is now your adult nightmare. Just try not to ‘crash’ the program.</p>

                <p>This module has 4 directional arrows, and big and small display, and a maze. The small display will show 2 numbers. The left number determines the top 6 rows, the other the bottom 3 rows. Your task as the expert is to determine which behavior each robot has. This is done using the tree of options below.</p>
                <p>The names of the robots are assigned left to right from the defuser’s perspective, starting with the top of the list of names down to the bottom of the list.</p>
                <img src= "img/Robot Programming/chart.png" class="center">
            </div>
            <div class="page-footer relative-footer">Page 1 of 4</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Robot Programming</span>
            </div>
            <div class="page-content">
                <p>R.O.B will follow your commands perfectly.</p>
                <p>HAL will do the complete opposite of your commands.</p>
                <p>R2D2 will alternate between the personalita of R.O.B and HAL, starting with R.O.B.</p>
                <p>Fender will move according to the serial number. Fender starts by looking at the first character of the serial number. If it is a number, Fender will act like R.O.B for that turn. If it was a letter Fender will act like HAL for that turn. Once it is Fender's turn to move, Fender will look at the next character in the serial number following the instructions mentioned before.</p>
                <p>Now that you’ve determined which robot is which, now you can begin inputting commands. Before you do this, however, there are a few things you must keep track of.</p>
                <p>The commands will not affect the robots until the start button is pressed. The screen is very tiny, and therefore only shows the last 3 inputted commands.</p>
                <p>There is an LED that will change every time you input a command. This LED will be the color one of the robots. The LED goes in a pattern. The pattern is Blue, Green, Red, Yellow, then back to Blue. When you input the command, the command will be sent to the robot that is the color of the LED. You can press the button that is the color of the robot south of the display so that they cannot receive any more commands. Be careful, because you cannot unlock a robot until you either press start or reset the entire command sequence.</p>
                <p>Once you have inputted the entire command chain, press the start button labelled “S”. If a robot does not reach their colored square, or runs into a wall or another robot, the module will strike. Press the Red button labelled “R” to reset the command sequence (this will not reset the coordinates)</p>
                <p>Upon a strike, the robot in which crashed will return to the square it was in before the crash, but no robot’s coordinates will be reset. The small display will show the reason of the crash (OOC means “Out of Commands”, OOB means “Out of Boundaries”.), afterwards showing the colors of the robots in reading order, as if they were in their starting position. The position of the serial number Fender was on before the crash occurred will also show, along with the personality R2D2 was on before the crash. If Fender or R2D2 crashed, they will act how they acted before the crash. (This does not apply if they are not at the end of their goals at the end of the sequence.)</p>
            </div>
            <div class="page-footer relative-footer">Page 2 of 4</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Robot Programming</span>
            </div>
            <div class="page-content">
                <p>If a robot is unable to move on the turn that it is picked to move without causing a strike, the module will skip to the next robot until the robot is no longer stuck.</p>
                <img src= "img/Robot Programming/mazes.png" class="center2">
            </div>
            <div class="page-footer relative-footer">Page 3 of 4</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Robot Programming</span>
            </div>
            <div class="page-content">
                <svg viewBox="-0.025 -0.025 9.05 9.05" class="interactive"></svg>
                <h4>Controls</h4>
                <ul>
                    <li>Click on a robot to select it.</li>
                    <li>WASD to move the robot.</li>
                    <li>Q to cycle through the robot's colors.</li>
                    <li>E to cycle through the robot's shapes.</li>
                    <li>Click a valid cell to toggle it between floor and wall.</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 4 of 4</div>
        </div>
    </div>
    <script>
        function $SVG(elem) {
            return $(`<svg>${elem}</svg>`).children().eq(0).unwrap();
        }

        const interactive = $("svg.interactive");
        const colors = ["red", "yellow", "green", "blue"];
        const shapes = [
            "M0.1,0.1 L0.9,0.1 L0.9,0.9 L0.1,0.9 Z",
            "M0.5,0.5 m-0.45,0 a0.45,0.45 0 1,0 0.9,0 a0.45,0.45 0 1,0 -0.9,0",
            "M0.5,0.1 L0.9,0.9 L0.1,0.9 Z",
            "M0.5,0.1 L0.9,0.3 L0.9,0.7 L0.5,0.9 L0.1,0.7 L0.1,0.3 Z",
            ];

        for (let x = 0; x < 9; x++) {
            for (let y = 0; y < 9; y++) {
                let fill = "black";
                if (y == 0) {
                    fill = ["white", "red", "white", "yellow", "white", "green", "white", "blue", "white"][x];
                } else if (x == 0 || x == 8 || y == 8 || (x % 2 == 0 && y % 2 == 0)) {
                    fill = "white";
                }

                const square = $SVG(`<rect width=1 height=1 x=${x} y=${y} fill=${fill} stroke=gray stroke-width=0.025/>`).appendTo(interactive);

                if (
                    fill == "black" && (x % 2 != 1 || y % 2 != 1) ||
                    fill == "white" && (x > 0 && x < 8 && y == 2)
                ) {
                    square.click(() => square.attr("fill", square.attr("fill") == "black" ? "white" : "black"));
                }
            }
        }

        let selectedRobot;
        for (let i = 0; i < 4; i++) {
            let x = i * 2 + 1;
            let y = 7;
            const robot = {
                move: function(xOffset, yOffset) {
                    if (
                        interactive.children(`rect[x=${x + xOffset}][y=${y + yOffset}]`).attr("fill") == "white" ||
                        interactive.children(`path[transform="translate(${x + xOffset} ${y + yOffset})"]`).length == 1 ||
                        y + yOffset < 0
                        )
                        return;

                    x += xOffset;
                    y += yOffset;
                    robotPath.attr("transform", `translate(${x} ${y})`);
                },
                nextColor: function() {
                    robotPath.attr("fill", colors[(colors.indexOf(robotPath.attr("fill")) + 1) % 4]);
                },
                nextShape: function() {
                    robotPath.attr("d", shapes[(shapes.indexOf(robotPath.attr("d")) + 1) % 4]);
                }
            }

            const robotPath = $SVG(`<path d="${shapes[i]}" fill=${colors[i]} stroke-width=0.025 transform="translate(${x} ${y})"/>`).appendTo(interactive);

            robotPath.click(() => {
                interactive.find("path").attr("stroke", "black");
                if (selectedRobot == robot) {
                    selectedRobot = null;
                    return;
                }
                robotPath.attr("stroke", "white");
                selectedRobot = robot;
            });
        }

        $(document).keydown(event => {
            if (selectedRobot == null)
                return;

            switch (event.key.toLowerCase()) {
                case "w":
                    selectedRobot.move(0, -1);
                    break;
                case "s":
                    selectedRobot.move(0, 1);
                    break;
                case "a":
                    selectedRobot.move(-1, 0);
                    break;
                case "d":
                    selectedRobot.move(1, 0);
                    break;
                case "q":
                    selectedRobot.nextColor();
                    break;
                case "e":
                    selectedRobot.nextShape();
                    break;
            }
        });
    </script>
</body>
</html>
