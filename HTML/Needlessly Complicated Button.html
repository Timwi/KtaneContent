<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>Needlessly Complicated Button — Keep Talking and Nobody Explodes Module</title>
        <meta name="viewport" content="initial-scale=1">
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <link rel="stylesheet" type="text/css" href="css/font.css">
        <script src="js/ktane-utils.js"></script>
        <style>
            table {
                margin: 1em auto;
                }
            .no-visibility {
                opacity: 0;
                }
            .fb {
                display: flex;
            }
            .smallStuff {
                font-size: 10pt;
            }
        </style>
    </head>
    <body>
        <div class="section">
            <div class="page page-bg-01">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Needlessly Complicated Button</span>
                </div>
                <div class="page-content">
                    <div class="fb">
                        <div>
                            <h2>On the Subject of the Needlessly Complicated Button</h2>
                            <p class="flavour-text">Three indicators and a button? What could possibly go wrong?</p>

                            <ul>
                                <li>To solve the module, you must press button at the right time for the right duration.</li>
                                <li>Requirements:
                                    <ul>
                                        <li>Number of modules</li>
                                        <li>Number of batteries and their type</li>
                                        <li>Number of ports and their type</li>
                                        <li>Serial</li>
                                        <li>Timer</li>
                                        <li>Eyes</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <img class="diagram" src="img/Component/Needlessly Complicated Button.svg">
                        </div>
                    </div>

                    <h3>Part A: The Button</h3>
                    <ul>
                        <li>The Button contains a label containing a word listed on <strong>Diagram A</strong>.
                            <ul>
                                <li>Use this diagram to determine which two of the three indicators are used for <strong>Part B</strong>.</li>
                            </ul>
                        </li>
                        <li>The color of the label is to be used to determine the offset needed to get the correct values of the indicators.
                            <ul>
                                <li>Check <strong>Diagram B</strong> to find these offsets.</li>
                            </ul>
                        </li>
                    </ul>

                    <h3>Part B: The Indicators</h3>
                    <ul>
                        <li>Once you have determined the two necessary indicators, you will need to use them in <strong>Diagram C</strong>.
                            <ul>
                                <li>Diagram C will tell you <strong>when to press the button</strong>.</li>
                            </ul>
                        </li>
                        <li>The remaining indicator will be used along with the edgework of the bomb in <strong>Diagram B</strong>.
                            <ul>
                                <li>Diagram B will tell you <strong>how long to hold the button</strong> or <strong>when to release</strong>.</li>
                            </ul>
                        </li>
                        <!--<li>But be warned, the color of the label may require you to change the values of the indicators.</li>-->
                        <li>Once you have completed the two diagrams, proceed to <strong>Part C</strong>.</li>
                    </ul>

                    <h3>Part C:</h3>
                    <ul>
                        <li>Once you have gotten the correct duration for the button, press away!</li>
                        <!--<li>If you get it incorrect, the module will reset, and the <strong>remaining indicator will change!</strong></li>-->
                    </ul>
                </div>
                <div class="page-footer relative-footer">Page 1 of 4</div>
            </div>
            <div class="page page-bg-02">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Needlessly Complicated Button</span>
                </div>
                <div class="page-content">
                    <h3>Diagram A:</h3>
                    <div id="annoying-table">
                        <i>Please wait while the chaos loads...</i>
                    </div>
                    <script>
                        "use strict";
                        // nuisance table code
                        const tableElem = document.getElementById("annoying-table");

                        const headerLeading = [
                            "Button Label",
                            "Bomb has more batteries than number of ports", 
                            "First or last letter of button label in any indicator label", 
                            "Any letter in serial is in the button label", 
                            "Otherwise"
                        ];

                        const caseA = "1 and 2";
                        const caseB = "2 and 3";
                        const caseC = "1 and 3";

                        const entries = [ // entry, invisible?, A, B, C, Else
                            ["Blank",           0, caseA, caseB, caseC, caseB],
                            ["Detonate",        0, caseC, caseA, caseB, caseC],
                            ["Press",           0, caseB, caseB, caseC, caseC],
                            ["Cyan",            0, caseB, caseC, caseC, caseA],
                            ["Literally Blank", 0, caseA, caseC, caseC, caseB],
                            ["No Label",        0, caseC, caseC, caseB, caseA],
                            ["Abort",           0, caseC, caseB, caseC, caseA],
                            ["Red",             0, caseB, caseB, caseC, caseC],
                            ["Yellow",          0, caseC, caseA, caseB, caseB],
                            ["Green",           0, caseA, caseC, caseC, caseB],
                            ["Button",          0, caseC, caseB, caseC, caseB],
                            ["Blue",            0, caseB, caseA, caseA, caseC],
                            ["Magenta",         0, caseC, caseB, caseC, caseC],
                            ["[No Label]",      1, caseB, caseB, caseC, caseA],
                            ["Hold",            0, caseA, caseC, caseA, caseB],
                            ["Nothing",         0, caseC, caseA, caseB, caseC],
                        ];

                        const ceaseTheShuffle = false; // Toggle this if you want to be less fun

                        const shuffle = (array) => { // https://github.com/coolaj86/knuth-shuffle
                            let currentIndex = array.length, temporaryValue, randomIndex;

                            if (ceaseTheShuffle) {
                                return array;
                            }

                            // While there remain elements to shuffle...
                            while (0 !== currentIndex) {

                                // Pick a remaining element...
                                randomIndex = Math.floor(Math.random() * currentIndex);
                                currentIndex -= 1;

                                // And swap it with the current element.
                                temporaryValue = array[currentIndex];
                                array[currentIndex] = array[randomIndex];
                                array[randomIndex] = temporaryValue;
                            }

                            return array;
                        }

                        const emptyTable = () => {
                            tableElem.innerHTML = ""; // easiest way i could think to do this
                        }

                        const createTable = (entries) => {
                            const table = document.createElement("table"); // create new table

                            const tbody = document.createElement("tbody");
                            tbody.style = "line-height: 19.8px" // to avoid the weird stretching stuff

                            const trl = document.createElement("tr"); // always first item in table
                            for (let h = 0; h < 5; h++) {
                                const th = document.createElement("th");

                                th.appendChild(document.createTextNode(headerLeading[h]));
                                trl.appendChild(th);
                            }
                            tbody.appendChild(trl);

                            for (let j = 0; j < entries.length; j++) {
                                const tr = document.createElement("tr"); // create table entry

                                const invisFlag = (entries[j][1] === 1);

                                for (let i = 0; i < 6; i++) {
                                    if (i == 0) {
                                        const th = document.createElement("th"); // create table entry header

                                        if (invisFlag) {
                                            th.className = "no-visibility";
                                        }

                                        th.appendChild(document.createTextNode(entries[j][i]));
                                        tr.appendChild(th);
                                    } else if (i > 1) {
                                        const td = document.createElement("td"); // create table entry document

                                        td.style.textAlign = "center";

                                        td.appendChild(document.createTextNode("Indicator"));
                                        td.appendChild(document.createElement("br"));
                                        td.appendChild(document.createTextNode(entries[j][i]));
                                        tr.appendChild(td);
                                    }
                                }

                                tbody.appendChild(tr); // append table entry to table
                            }

                            table.appendChild(tbody);
                            return table;
                        };

                        const renderDelay = 5000;

                        const renderTable = () => {
                            const newEntries = shuffle(entries);
                            const table = createTable(newEntries);

                            emptyTable();

                            tableElem.appendChild(table);

                            setTimeout(() => {
                                renderTable();
                            }, renderDelay)
                        }

                        console.log("[Diagram A] I am not sorry for this.");

                        renderTable(); // START THE MAYHEM
                    </script>
                </div>
                <div class="page-footer relative-footer">Page 2 of 4</div>
            </div>
            <div class="page page-bg-03">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Needlessly Complicated Button</span>
                </div>
                <div class="page-content">
                    <h3>Diagram B:</h3>
                    <img src="img/Needlessly Complicated Button/Diagram B.svg">
                    <p></p>
                    <table style="display: inline-block">
                        <tr>
                            <th>Line Type</th>
                            <th>Use if:</th>
                        </tr>
                        <tr>
                            <th>Solid<br>Line</th>
                            <td>Button is a Primary Color</th>
                        </tr>
                        <tr>
                            <th>Dotted<br>Line</th>
                            <td>Serial contains an even number</th>
                        </tr>
                        <tr>
                            <th>Dashed<br>Line</th>
                            <td>The remaining<br>indicator is prime</th>
                        </tr>
                        <tr>
                            <th>Dot Dashed<br>Line</th>
                            <td>The digital root of the<br>remaining indicator is odd</th>
                        </tr>
                    </table>
                    <table style="float: right">
                        <tr>
                            <th>Value</th>
                            <th>How long to hold</th>
                        </tr>
                        <tr>
                            <th>I</th>
                            <td>Release Immediately</td>
                        </tr>
                        <tr>
                            <th>A</th>
                            <td>Hold for 5 seconds</td>
                        </tr>
                        <tr>
                            <th>B</th>
                            <td>Hold for 10 seconds</td>
                        </tr>
                        <tr>
                            <th>C</th>
                            <td>Hold for 15 seconds</td>
                        </tr>
                        <tr>
                            <th>D</th>
                            <td>Hold for 20 seconds</td>
                        </tr>
                        <tr>
                            <th>F</th>
                            <td>Release on 1</td>
                        </tr>
                        <tr>
                            <th>G</th>
                            <td>Release on 3</td>
                        </tr>
                        <tr>
                            <th>H</th>
                            <td>Release on 5</td>
                        </tr>
                        <tr>
                            <th>J</th>
                            <td>Release on 8</td>
                        </tr>
                        <tr>
                            <th>?</th>
                            <td>Hold Until Satisfied</td>
                        </tr>
                    </table>
                </div>
                <div class="page-footer relative-footer">Page 3 of 4</div>
            </div>
            <div class="page page-bg-04">
                <div class="page-header">
                    <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                    <span class="page-header-section-title">Needlessly Complicated Button</span>
                </div>
                <div class="page-content">
                    <h3>Diagram C:</h3>
                    <br>
                    <p class="smallStuff">*Note for top half of diagram: Indicator 1/2 is referring to <strong>the relevant indicators.</strong></p>
                    <img src="img/Needlessly Complicated Button/Diagram C.svg">
                </div>
                <div class="page-footer relative-footer">Page 4 of 4</div>
            </div>
        </div>
    </body>
</html>