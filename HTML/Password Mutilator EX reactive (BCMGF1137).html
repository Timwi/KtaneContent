<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Password Mutilator EX reactive (BCMGF1137) — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script type="module">
        function toDecimal(str, fromBase) { // Converts something from some base to decimal.
            
            let DIGITS = "0123456789ABCDEF";
            let out = 0;
            if (str == "" || (fromBase < 5 || fromBase > 16))
            {
                return -1;
            } 
            else
            {
                for (let i = 0; i < str.length; i++)
                {
                    if (!DIGITS.includes(str.charAt(i).toUpperCase()))
                    {
                        return -1;
                    }
                    else if (DIGITS.indexOf(str.charAt(i).toUpperCase()) >= fromBase)
                    {
                        return -1;
                    }
                    else 
                    {
                        out = out * fromBase + DIGITS.indexOf(str.charAt(i).toUpperCase());
                    }
                }
                return out;
            }
        }
        
        let display = document.getElementById("display");
        let base = document.getElementById("base");
        let result = document.getElementById("result");
        
        const changeOutput = (value1, value2) => {
            result.value = String(toDecimal(value1, Number(value2)));
        }
        
        changeOutput(display.value, base.value);
        
        display.oninput = (e) => {
            changeOutput(e.target.value, base.value)
        };
        base.oninput = (e) => {
            changeOutput(display.value, e.target.value)
        };
    </script>
    <style>
        .formula {
            text-align: center;
            font-weight: bold;
        }

        .dark .none, .none {
            border: none;
            margin: 0px;
        }

        .dark .none :is(th,td), .none :is(th,td) {
            border: none;
            line-height: 1;
        }

        .sh { margin: 0; }

        table.symbols {
            font-size: 12.5px;
            text-align: center;
        }
        .hstack { 
            gap: 24px;
            flex-wrap: wrap;
        }
        .page.strip::before { background-image: linear-gradient(red, yellow, lime, blue, fuchsia); }
        
        input:invalid {
            border: solid rgb(255, 49, 49) 2px;
            background-color: rgb(174, 80, 80);
        }
        
        .output {
            width: 70px;
            background-color: rgb(198, 198, 198);
        }
        
        .textbox {
            width: 60px;
        }
        
        .small {
            font-size: 12px;
        }
        
        .image-right {
            float:right;
            margin: 15px;
        }
        
        .half {
            width: 300px;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Password Mutilator EX (optimized)</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Password Mutilator EX.svg" class="diagram">
                <h2>On the Subject of A Password Module That Shouldn't Be Touched</h2>
                <p class="flavour-text">This thing is not as secure as 256-bit security, I think.</p>

                <p>
                    In order to solve the module, a password is required to be entered in the input phase.
                </p>

                <h3>Preface</h3>
                <ul class="small">
                    <li>F1 will serve as a submit/stage-advance button.</li>
                    <li>F2 clears your input.</li>
                </ul>

                <h3>Activating The Module</h3>
                <p>If Bamboozled Again, Ultimate Cycle, or UltraStores is present, the input is simply <u>*dead*</u>. This can be inputted using "88DDEEAADD88".</p>
                <p>Otherwise, take the serial number, convert the digits using A0Z25 (table for convenience), and convert everything to lowercase. You can input this by pressing each letter twice on the module.
                <br>For example, "UX4TA2" would be inputted as "UUXXEETTAACC".</p>
                <table>
                    <tr>
                        <th>Digit</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td>
                    </tr>
                    <tr>
                        <th>Letter</th><td>a</td><td>b</td><td>c</td><td>d</td><td>e</td><td>f</td><td>g</td><td>h</td><td>i</td><td>j</td>
                    </tr>
                </table>
                
                <h3>Stage Phase</h3>
                <p>The module's representation of the increase factor (I) can be anywhere from base 5 to base 16. You can use the base converter below to convert from some specified base back to decimal. Case does NOT matter in the boxes.
                <br>(If the result is -1, the input is invalid.)</p>
                <label for="display">Display:</label>
                <input type="text" id="display" class="textbox" maxlength="5" placeholder="display" pattern="[abcdefABCDEF0-9]+">
                <label for="base">Base:</label>
                <input type="number" id="base" class="textbox" placeholder="base" step="1" min="5" max="16">
                <label for="result">Result:</label>
                <input type="text" id="result" class="output" readonly>
                <p>The calculated value for a stage is calculated with the formula:</p>
                <p class="formula">
                    C = I + (TFA % 9) + (BT % 60 + ET % 60)
                </p>
                <ul class="small">
                    <li>C is the calculated value.</li>
                    <li>I is the average increase factor, in base-10.</li>
                    <li>TFA is the 2FAST, in the top-left.</li>
                    <li>BT is amount of bomb time remaining in real time upon advancing from this stage, in the bottom-right.</li>
                    <li>ET is elapsed time since the module initialized upon advancing from this stage, in the bottom-left.</li>
                </ul>
                <p>A stage regenerates its information every 2 minutes, so work quickly.</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 4</div>
            
        </div>
        <div class="page page-bg-01 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Password Mutilator EX (optimized)</span>
            </div>
            <div class="page-content">
                <h3 class="sh">Input/Submission Phase</h3>
                <p>The number of stages, S, is based on the number of modules, M:</p>
                <p class="formula">
                    S = max(floor(M / 2), 5)
                </p>
                <p>The number of stages should match S. Once you've calculated your C-values for each stage, enter the input phase, where each stage has a final value, F:</p>
                <p class="formula">
                    F = (C + 60 * (60 * h + m) + s) % 94 + 33
                </p>
                <ul class="small">
                    <li>h is the number of elapsed hours.</li>
                    <li>m is the number of elapsed minutes.</li>
                    <li>s is the number of elapsed seconds.</li>
                    <li>This can be seen in the bottom-left, and will stay constant.</li>
                </ul>
                <p>If the previous stage's F-value matches this one, add 1 to F; treat 127 as 125.</p>
                <p>Convert all F-values to characters:</p>
                
                <table class="small">
                    <tr>
                        <th>F=</th><td>033</td><td>034</td><td>035</td><td>036</td><td>037</td><td>038</td><td>039</td><td>040</td><td>041</td><td>042</td><td>043</td>
                        <td>044</td><td>045</td><td>046</td><td>047</td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#033;</td><td>&#034;</td><td>&#035;</td><td>&#036;</td><td>&#037;</td><td>&#038;</td><td>&#039;</td><td>&#040;</td><td>&#041;</td><td>&#042;</td><td>&#043;</td>
                        <td>&#044;</td><td>&#045;</td><td>&#046;</td><td>&#047;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>11</td><td>''</td><td>33</td><td>44</td><td>55</td><td>77</td><td>'</td><td>99</td><td>00</td><td>88</td><td>==</td><td>,</td>
                        <td>-</td><td>.</td><td>/</td>
                    </tr>
                    <tr>
                        <th>F=</th><td>048</td><td>049</td><td>050</td><td>051</td><td>052</td><td>053</td><td>054</td><td>055</td><td>056</td><td>057</td><td>058</td>
                        <td>059</td><td>060</td><td>061</td><td>062</td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#048;</td><td>&#049;</td><td>&#050;</td><td>&#051;</td><td>&#052;</td><td>&#053;</td><td>&#054;</td><td>&#055;</td><td>&#056;</td><td>&#057;</td><td>&#058;</td>
                        <td>&#059;</td><td>&#060;</td><td>&#061;</td><td>&#062;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>;;</td><td>;</td>
                        <td>,</td><td>=</td><td>.</td>
                    </tr>
                    <tr>
                        <th>F=</th><td>063</td><td>064</td><td>065</td><td>066</td><td>067</td><td>068</td><td>069</td><td>070</td><td>071</td><td>072</td><td>073</td>
                        <td>074</td><td>075</td><td>076</td><td>077</td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#063;</td><td>&#064;</td><td>&#065;</td><td>&#066;</td><td>&#067;</td><td>&#068;</td><td>&#069;</td><td>&#070;</td><td>&#071;</td><td>&#072;</td><td>&#073;</td>
                        <td>&#074;</td><td>&#075;</td><td>&#076;</td><td>&#077;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>//</td><td>22</td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td>
                        <td>K</td><td>L</td><td>M</td>
                    </tr>
                    <tr>
                        <th>F=</th><td>078</td><td>079</td><td>080</td><td>081</td><td>082</td><td>083</td><td>084</td><td>085</td><td>086</td><td>087</td><td>088</td>
                        <td>089</td><td>090</td><td>091</td><td>092</td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#078;</td><td>&#079;</td><td>&#080;</td><td>&#081;</td><td>&#082;</td><td>&#083;</td><td>&#084;</td><td>&#085;</td><td>&#086;</td><td>&#087;</td><td>&#088;</td>
                        <td>&#089;</td><td>&#090;</td><td>&#091;</td><td>&#092;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>N</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td>
                        <td>Z</td><td>[</td><td>\</td>
                    </tr>
                    <tr>
                        <th>F=</th><td>093</td><td>094</td><td>095</td><td>096</td><td>097</td><td>098</td><td>099</td><td>100</td><td>101</td><td>102</td><td>103</td>
                        <td>104</td><td>105</td><td>106</td><td>107</td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#093;</td><td>&#094;</td><td>&#095;</td><td>&#096;</td><td>&#097;</td><td>&#098;</td><td>&#099;</td><td>&#100;</td><td>&#101;</td><td>&#102;</td><td>&#103;</td>
                        <td>&#104;</td><td>&#105;</td><td>&#106;</td><td>&#107;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>]</td><td>66</td><td>--</td><td>`</td><td>AA</td><td>BB</td><td>CC</td><td>DD</td><td>EE</td><td>FF</td><td>GG</td><td>HH</td>
                        <td>II</td><td>JJ</td><td>KK</td>
                    </tr>
                    <tr>
                        <th>F=</th><td>108</td><td>109</td><td>110</td><td>111</td><td>112</td><td>113</td><td>114</td><td>115</td><td>116</td><td>117</td><td>118</td>
                        <td>119</td><td>120</td><td>121</td><td>122</td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#108;</td><td>&#109;</td><td>&#110;</td><td>&#111;</td><td>&#112;</td><td>&#113;</td><td>&#114;</td><td>&#115;</td><td>&#116;</td><td>&#117;</td><td>&#118;</td>
                        <td>&#119;</td><td>&#120;</td><td>&#121;</td><td>&#122;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>LL</td><td>MM</td><td>NN</td><td>OO</td><td>PP</td><td>QQ</td><td>RR</td><td>SS</td><td>TT</td><td>UU</td><td>VV</td><td>WW</td><td>XX</td><td>YY</td>
                        <td>ZZ</td>
                    </tr>
                    <tr>
                        <th>F=</th><td>123</td><td>124</td><td>125</td><td>126</td>
                        <td rowspan="3" colspan="11">
                            If you're Eltrick (otherwise want to be like him), all characters are from this string:
                            <br>
                            <code>
                            &#33;&#34;&#35;&#36;&#37;&#38;&#39;&#40;&#41;&#42;&#43;&#44;&#45;&#46;&#47;&#48;&#49;&#50;&#51;&#52;&#53;&#54;&#55;&#56;&#57;&#58;&#59;&#60;&#61;&#62;&#63;&#64;&#65;&#66;&#67;&#68;&#69;&#70;&#71;&#72;&#73;&#74;&#75;&#76;&#77;&#78;&#79;&#80;&#81;&#82;&#83;&#84;&#85;&#86;&#87;&#88;&#89;&#90;&#91;&#92;&#93;&#94;&#95;&#96;&#97;&#98;&#99;&#100;&#101;&#102;&#103;&#104;&#105;&#106;&#107;&#108;&#109;&#110;&#111;&#112;&#113;&#114;&#115;&#116;&#117;&#118;&#119;&#120;&#121;&#122;&#123;&#124;&#125;&#126;
                            </code>
                        </td>
                    </tr>
                    <tr>
                        <th>Symbol</th><td>&#123;</td><td>&#124;</td><td>&#125;</td><td>&#126;</td>
                    </tr>
                    <tr>
                        <th>Input</th><td>[[</td><td>\\</td><td>]]</td><td>``</td>
                    </tr>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 2 of 4</div>
        </div>
        <div class="page page-bg-01 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Password Mutilator EX (optimized)</span>
            </div>
            <div class="page-content">
                <h3>Solving Strategy, With Example</h3>
                <p>
                    As of writing this manual, the only challenge bomb solve that has Password Mutilator EX is <a href="https://www.youtube.com/watch?v=wQXsXIR2b3U&t=5649s">Fang's 47 2023</a>,
                    with Danielstigman as the defuser and Varunaxx as the expert who did the module.
                </p>
                <p>Activating the module is easy, as you can refer to the first page of this manual. The hard part starts when you press F1, however. There is a lot to unpack, but you can follow this procedure:</p>
                
                <ol class="small">
                    <li>Read the raw value once ("R1").</li>
                    <li>Wait 5 seconds, then read the raw value again ("R2"). If R2 loops around and is less than R1, prepend a 1 to R2.</li>
                    <li>Wait until the display loops back to less than 4 digits. Take the largest digit that appears (0-9, A-F).</li>
                    <li>This is your base. Convert R1 and R2 from that base to decimal.</li>
                    <li>Subtract R1 from R2, and then divide the result by 5. Round the result to get the increase factor. You can think of this using this formula (rounding accordingly):</li>
                </ol>
                <img src="img/Password Mutilator EX/example.png" class="image-right half">
                <p class="formula">
                    I = (R2 - R1) / 5
                </p>
                <ol start="6" class="small">
                    <li>Write down the Two-Factor ("TFA"). It may look like 2 3-digit numbers, but concatenate them into a single 6-digit number.</li>
                    <li>Press F1. You now have 5 seconds to write down the last 2 digits of the BT and ET before they disappear.</li>
                    <li>Plug the obtained values into the equation for your C-value! You are now done with this stage.</li>
                </ol>
                <p>Now that you have a C-value for this stage, repeat for subsequent stages, until you get to the pre-input phase. <u>C-values do not change between stages.</u></p>
                <p>In the example from the first stage of Password Mutilator EX from Fang's 47 2023, Danielstigman read the raw value at BT=-02:34:24 (9573) and BT=-02:34:19 (2607).
                Since the raw value looped around midway through, it technically exceeded 10000. In addition, there was no base conversion because there was a 9 but no A (base-10).
                Therefore, R2 is actually 12607.
                The increase factor is equal to:
                <p class="formula">
                    I = (12607 - 9573) / 5 = 606.8 ≈ <u>607</u>
                </p>
                <p>
                Danielstigman read the TFA (848218), and then pressed F1 to advance a stage, reading ET = 36 and BT = 54. Using this information, the calculated value is:</p>
                <p class="formula">
                    C = 607 + (848218 % 9) + (54 % 60 + 36 % 60) = <u>701</u>
                </p>
            </div>
            <div class="page-footer relative-footer">Page 3 of 4</div>
        </div>
        <div class="page page-bg-01 strip">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Password Mutilator EX (optimized)</span>
            </div>
            <div class="page-content">
                <p>Once you obtain every C-value you need, it is now time to calculate F-values. It's worth mentioning that the elapsed time will not change in this phase.
                </p>
                <p>Once you obtain all F-values, they need to be converted into characters before inputting.</p>
                <p>Back to the aforementioned example, when Danielstigman entered input phase, the elapsed time was 1:49:29. The final value for the first stage is:</p>
                <p class="formula">
                    F = (701 + 60 * (60 * 1 + 49) + 29) % 94 + 33 = <u>65</u>
                </p>
                <p>65 translates to the character "A", which was inputted into the module in the input phase.</p>
                <p>The final answer for the module was "Ak&amp;2D&amp;]V/R@C\?.)GCRu{5>" (ignoring quotes), which is inputted as "AKK772D77]V/R22C\//.00GCRUU[[5.." (ignoring quotes).</p>
                <p><b><u>Danielstigman and Varunaxx went on to solve the module with no strikes.</u></b></p>
            </div>
            <div class="page-footer relative-footer">Page 4 of 4</div>
        </div>
    </div>
</body>
</html>