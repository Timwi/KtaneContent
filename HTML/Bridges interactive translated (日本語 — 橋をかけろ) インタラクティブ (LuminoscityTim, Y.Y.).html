<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>橋をかけろ — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/jquery.3.7.0.min.js"></script>
    <script src="js/Utilities/math-utils.js"></script>
    <script>
        $(function() {
            let page = $(".page-bg-02 .page-content");
            let row = $("<div>").addClass("hstack").appendTo(page);
            const buttonText = ["▼", "▼", "↻"];
            const images = [ "biohazard", "boxes", "fire", "glass", "recycle", "snowflake", "thiswayup", "umbrella" ];
            let offset = 0;
            let cell = $("table.interactive")[0].getElementsByTagName("td");

            function offsetTable(c) {
                for (let c = 0; c < images.length; c++)
                    cell[c].innerHTML = `<img src="img/Bridges/${images[ UMod(images.length + offset + c, images.length) ]}M.png">`;
            }

            $("<button>").addClass("btn-l").text(buttonText[0]).appendTo(row).click(function() {
                offset += 1;
                offsetTable(offset);
            });
            $("<button>").addClass("btn-r").text(buttonText[1]).appendTo(row).click(function() {
                offset -= 1;
                offsetTable(offset);
            });
            $("<button>").text(buttonText[2]).appendTo(row).click(function() {
                offset = 0;
                offsetTable(offset);
            });
            offsetTable(offset);
        });
    </script>
    <style>
        .hstack {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }
        button {
            font-weight: bold;
            height: 40px;
            width: 40px;
            font-size: 30px;
        }
        button.btn-l, button.btn-r {
            font-size: 25px;
            text-align: center;
        }
        button.btn-l { transform: rotateZ(90deg); }
        button.btn-r { transform: rotateZ(-90deg); }
        td img {
            width: 60px;
            height: 60px;
        }
        .dark td img { filter: invert(90%); }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橋をかけろ</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Bridges.svg" class="diagram">
                <h2>モジュール詳細：橋をかけろ</h2>
                <p class="flavour-text">ロンドン橋落ちる、落ちる、落ちる……</p>

                <p>
                   英語では"Bridges"と呼ばれる、「橋をかけろ」パズルが表示される。「島」に見立てた丸を「橋」に見立てた線で全て繋ぐことが目標である。このモジュールの右上にある小さなLEDが緑色の場合、答えはちょうど1つになる。それ以外の場合、唯一解とは限らない。いずれの場合でも解除方法には影響しない。
                </p>
                
                <h4>橋のかけ方</h4>
                <p>接続したい2つの島をクリックすると、その間に橋をかけられる。まだそこに橋がない場合は橋が1本かかる。1本かかっている時には橋が2本に増える。2本かかっている時には橋が取り除かれる。</p>

                <h4>橋のかけ方のルール</h4>
                <ul>
                    <li>橋は異なる2つの島の間に直線でかけられる。</li>
                    <li><em>他の橋と交差させたり、島を飛び越えてかけてはいけない。</em></li>
                    <li>タテヨコにのみ橋をかけられる(<em>ナナメに橋をかけてはいけない</em>)。</li>
                    <li>橋は1ヵ所に2本までかけられる。</li>
                    <li>それぞれの島にかけられている橋の数は、それぞれの島の数字と一致している必要がある。*</li>
                    <li>島は全体がひとつながりになる(どの島からどの島へも橋を渡って移動できる必要がある)。</li>
                </ul>
                <p>上記の下線付きのルールのいずれかを破ろうとすると、ミスが記録される。配置しようとした橋と交差する時は、その交差する橋もしくは島が赤く点滅する。橋をナナメにかけようとした時は、選択した2つの島が赤く点滅する。</p>
                <p>*モジュール上の記号を数字に変換する方法は、次のページの表を参照する。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">橋をかけろ</span>
            </div>
            <div class="page-content">
                <h4>送信</h4>
                <p>大きなチェックマークの付いたボタンを押し、回答を送信する。全ての島に正しい数の橋が繋がり、全体がひとつながりになっている時、モジュールが解除される。全ての島に正しい数の橋が繋がっているが、全体がひとつながりになっていない時、全ての島が黄色に点滅するが、ミスは記録されない。それ以外の場合、ミスが記録され、繋がっている橋の数が正しくない島が赤く点滅する。</p>
                <h4>記号の解読</h4>
                <p>以下の表はこのモジュールに用いられる可能性のある記号と、それが表す数字の表である。爆弾に付いているバッテリーの数とこのモジュールの中の島の数の合計を、8で割ったときの余りだけ画像を左にずらして用いる(1と8は繋がっている)。</p>
                <br>
                <table class="interactive">
                    <tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr>
                    <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                </table>
                <div class="buttons"></div>
            </div>
            <div class="page-footer relative-footer">ページ 2/2</div>
        </div>
    </div>
</body>
</html>