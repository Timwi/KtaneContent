<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>SQL - Evil — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .arrow { width: 50px; }
        .hstack {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            justify-content: space-around;
        }
        .hstack.center { align-content: center; }
        td.hstack { text-align: center; }

        .line {
          margin-top: 7px;
          width: 35px;
          background: darkgray;
          height: 5px;
          float: left;
        }

        .point {
          width: 0;
          height: 0;
          border-top: 10px solid transparent;
          border-bottom: 10px solid transparent;
          border-left: 15px solid darkgray;
          float: right;
        }

        .dark .bb, .bb { border-bottom: 3px solid; }
        .dark .tb, .tb { border-top: 3px solid; }
        .dark .lb, .lb { border-left: 3px solid; }
        .dark .rb, .rb { border-right: 3px solid; }
        .hcell { background-color: #eaeaea; }
        .dark .hcell { background-color: #555; }
        .scell { background-color: #cacaca; }
        .dark .scell { background-color: #777; }
    </style>
    <script src="js/ktane-utils.js"></script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">SQL - Evil</span>
            </div>
            <div class="page-content">
                <img src="img/Component/SQL - Evil.svg" class="diagram">
                <h2>On the Subject of SQL - Evil</h2>
                <p class="flavour-text">How fun is it to ride through a large table of numbers to find similarities...</p>

                <p>This module is a SQL code simulator. To disarm it, produce a SQL query that outputs a given result. The input data is in this document, use it to reproduce the given result. Use the documentation to build a SQL query that will reproduce the expected result from the input data.</p>

                <h2>The Goal button</h2>
                <p>Press the <strong>Goal</strong> button to see what results the module expects. The expectation is a table of numbers with anywhere from 3 to 4 rows and 3 columns. Below are a few examples:</p>

                <div class="hstack">
                    <table style="align-self: flex-start;">
                        <tr><td>2</td><td>9</td><td>6</td></tr>
                        <tr><td>4</td><td>2</td><td>1</td></tr>
                        <tr><td>7</td><td>1</td><td>4</td></tr>
                        <tr><td>3</td><td>8</td><td>2</td></tr>
                    </table>
                    <table style="align-self: flex-start;">
                        <tr><td>2</td><td>9</td><td>6</td></tr>
                        <tr><td>4</td><td>2</td><td>1</td></tr>
                        <tr><td>7</td><td>1</td><td>4</td></tr>
                    </table>
                </div>

                <h2 style="margin-top: 2cm">The Check button</h2>

                <p>Upon pressing the <strong>Check</strong> button, the module compiles the SQL query and executes it against the input data. The result is compared to the goal table. If it matches, the module is disarmed; otherwise, a strike is registered.</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 5</div>
        </div>
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">SQL - Evil</span>
            </div>
            <div class="page-content">

                <h2>Disarming the module</h2>

                <p>To disarm the module, find numbers from the goal table in the input data that could indicate what options were used. The rows are always used from top to bottom, but the columns can be reordered. Example:</p>

                <div class="hstack">
                    <div>
                        <p><strong>Goal matrix</strong></p>
                        <table style="align-self: flex-start;">
                            <tr><td>9</td><td>0</td><td class="tb lb rb hcell">1</td></tr>
                            <tr><td>1</td><td>1</td><td class="lb rb hcell">4</td></tr>
                            <tr><td>1</td><td>0</td><td class="bb lb rb hcell">7</td></tr>
                        </table>
                    </div>
                    <div style="align-self: center; flex-basis: 33%;">
                        <p>Values from the goal in column 3 seem to match column F!</p>
                        <p><strong>This could mean we used column F to group values together!</strong></p>
                        <div class="arrow">
                            <div class="line"></div>
                            <div class="point"></div>
                        </div>
                    </div>
                    <div>
                        <p><strong>Example input data</strong></p>
                        <table>
                            <tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr>
                            <tr><td>9</td><td>3</td><td>8</td><td>6</td><td>9</td><td class="tb lb rb hcell">1</td></tr>
                            <tr><td>9</td><td>3</td><td>0</td><td>4</td><td>3</td><td class="lb rb hcell">1</td></tr>
                            <tr><td>1</td><td>2</td><td>1</td><td>6</td><td>2</td><td class="lb rb hcell">4</td></tr>
                            <tr><td>1</td><td>7</td><td>0</td><td>4</td><td>3</td><td class="bb lb rb hcell">7</td></tr>
                        </table>
                    </div>
                </div>

                <h2 style="margin-top: 2cm">The input data</h2>
                <p>The input data used to disarm the module is shown below. Find the values from the goal table inside this table and craft a SQL query that generates the same output.</p>

                <div class="hstack center">
                    <table>
                        <tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th></tr>
                        <tr><td>9</td><td>5</td><td>0</td><td>2</td><td>1</td><td>0</td><td>3</td></tr>
                        <tr><td>7</td><td>8</td><td>3</td><td>1</td><td>0</td><td>6</td><td>4</td></tr>
                        <tr><td>7</td><td>5</td><td>7</td><td>4</td><td>6</td><td>5</td><td>3</td></tr>
                        <tr><td>9</td><td>8</td><td>0</td><td>4</td><td>1</td><td>0</td><td>4</td></tr>
                        <tr><td>1</td><td>2</td><td>7</td><td>2</td><td>6</td><td>6</td><td>3</td></tr>
                        <tr><td>1</td><td>8</td><td>3</td><td>1</td><td>6</td><td>0</td><td>5</td></tr>
                        <tr><td>9</td><td>2</td><td>7</td><td>2</td><td>1</td><td>5</td><td>5</td></tr>
                    </table>

                    <blockquote style="flex-basis: 50%;">
                        <p><strong>Remember:</strong></p>
                        <p>SQL results are not necessarily in reading order. The <strong>rows</strong> will be processed from top to bottom, but the <strong>columns</strong> can be arbitrarily reordered in the SELECT clause in the query.</p>
                    </blockquote>
                </div>
            </div>
            <div class="page-footer relative-footer">Page 2 of 5</div>
        </div>
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">SQL - Evil</span>
            </div>
            <div class="page-content">

                <h2>On the Subject of SQL</h2>
                <p>SQL is a query language that describes how to manipulate sources of data and generate a result. It comprises many different keywords, only a small subset of which is used by this module.</p>

                <h3>How SQL is processed</h3>
                <p>SQL is processed as follows:</p>
                <ol>
                    <li style="margin-bottom: 1em">All rows are grouped together based on the <strong>GROUP BY</strong> clause (described below). You <strong>must</strong> provide 1 group by expression.</li>

                    <li style="margin-bottom: 1em">Each group’s rows are then processed against the <strong>SELECT</strong> clause and aggregated as configured (described below). You <strong>must</strong> aggregate all but 1 expression, that one expression <strong>has</strong> to be the one you use in the <strong>GROUP BY</strong> clause.</li>
                </ol>

                <h3>SELECT X, Y, Z</h3>
                <p>The <strong>SELECT</strong> clause chooses which columns to return (and in what order). The module offers up to 3 simple column references. Each column can be clicked to cycle between columns A to G and a “-” which disables that selection. An example of this follows:</p>

                <div class="hstack">
                    <table>
                        <tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th></tr>
                        <tr><td>9</td><td>3</td><td>0</td><td>2</td><td>0</td><td>4</td><td>6</td></tr>
                        <tr><td>7</td><td>8</td><td>6</td><td>1</td><td>2</td><td>9</td><td>8</td></tr>
                        <tr><td>2</td><td>0</td><td>5</td><td>4</td><td>7</td><td>3</td><td>1</td></tr>
                        <tr><td>4</td><td>7</td><td>1</td><td>5</td><td>3</td><td>0</td><td>9</td></tr>
                        <tr><td>6</td><td>2</td><td>7</td><td>9</td><td>8</td><td>6</td><td>5</td></tr>
                        <tr><td>1</td><td>9</td><td>3</td><td>7</td><td>6</td><td>5</td><td>4</td></tr>
                        <tr><td>8</td><td>5</td><td>4</td><td>3</td><td>1</td><td>8</td><td>2</td></tr>
                    </table>
                    <div style="align-self: center; flex-basis: 33%;">
                        <p><strong>SQL:</strong> SELECT D, A</p>
                        <p>Notice there is no 3<sup>rd</sup> expression. We used a “-”.</p>
                        <div class="arrow">
                            <div class="line"></div>
                            <div class="point"></div>
                        </div>
                    </div>
                    <table>
                        <tr><th>D</th><th>A</th></tr>
                        <tr><td>2</td><td>9</td></tr>
                        <tr><td>1</td><td>7</td></tr>
                        <tr><td>4</td><td>2</td></tr>
                        <tr><td>5</td><td>4</td></tr>
                        <tr><td>9</td><td>6</td></tr>
                        <tr><td>7</td><td>1</td></tr>
                        <tr><td>3</td><td>8</td></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Page 3 of 5</div>
        </div>
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">SQL - Evil</span>
            </div>
            <div class="page-content">

                <h3>GROUP BY X</h3>
                <p>The <strong>GROUP BY</strong> clause chooses which column to use to create groups of rows. When you group by a certain column, all the values for that column are inspected and then, groups are made from those values. Then, you apply aggregators (See below) to the group of rows. For example:</p>

                <div class="hstack">
                    <table>
                        <tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th></tr>
                        <tr><td>9</td><td>5</td><td>0</td><td>2</td><td>1</td><td>0</td><td>3</td></tr>
                        <tr><td>7</td><td>8</td><td>3</td><td>1</td><td>0</td><td>6</td><td>4</td></tr>
                        <tr><td>7</td><td>5</td><td>7</td><td>4</td><td>6</td><td>5</td><td>3</td></tr>
                        <tr><td>9</td><td>8</td><td>0</td><td>4</td><td>1</td><td>0</td><td>4</td></tr>
                        <tr><td>1</td><td>2</td><td>7</td><td>2</td><td>6</td><td>6</td><td>3</td></tr>
                        <tr><td>1</td><td>8</td><td>3</td><td>1</td><td>6</td><td>0</td><td>5</td></tr>
                        <tr><td>9</td><td>2</td><td>7</td><td>2</td><td>1</td><td>5</td><td>5</td></tr>
                    </table>
                    <div style="align-self: center; flex-basis: 33%;">
                        <p><strong>SQL:</strong> GROUP BY C</p>
                        <div class="arrow">
                            <div class="line"></div>
                            <div class="point"></div>
                        </div>
                    </div>
                    <table>
                        <tr><th>A</th><th>B</th><th>D</th><th>E</th><th>F</th><th>G</th></tr>
                        <tr><td colspan="6" class="tb bb lb rb hcell">C = 0</td></tr>
                        <tr><td>9</td><td>5</td><td>2</td><td>1</td><td>0</td><td>3</td></tr>
                        <tr><td>9</td><td>8</td><td>4</td><td>1</td><td>0</td><td>4</td></tr>
                        <tr><td colspan="6" class="tb bb lb rb hcell">C = 3</td></tr>
                        <tr><td>7</td><td>8</td><td>1</td><td>0</td><td>6</td><td>4</td></tr>
                        <tr><td>1</td><td>8</td><td>1</td><td>6</td><td>0</td><td>5</td></tr>
                        <tr><td colspan="6" class="tb bb lb rb hcell">C = 7</td></tr>
                        <tr><td>7</td><td>5</td><td>4</td><td>6</td><td>5</td><td>3</td></tr>
                        <tr><td>1</td><td>2</td><td>2</td><td>6</td><td>6</td><td>3</td></tr>
                        <tr><td>9</td><td>2</td><td>2</td><td>1</td><td>5</td><td>5</td></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Page 4 of 5</div>
        </div>
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">SQL - Evil</span>
            </div>
            <div class="page-content">

                <h3>SELECT Aggregators</h3>

                <p>This module allows usage of SELECT aggregators. Aggregators are group functions used to simplify groups of rows into single values. To use aggregators, you <strong>must</strong> use a <strong>GROUP BY</strong> expression. Here are a few examples of how aggregators affect groups of rows:</p>

                <table style="width: 100%">
                    <tr><th>Example data</th><th>Condition</th><th>Result</th></tr>
                    <tr>
                        <td class="hstack nohighlight">
                            <table>
                                <tr><th>A</th><th>B</th></tr>
                                <tr><td colspan="2" class="tb bb lb rb hcell">C = 0</td></tr>
                                <tr><td>9</td><td>5</td></tr>
                                <tr><td>9</td><td>8</td></tr>
                            </table>
                            <table>
                                <tr><th>A</th><th>B</th></tr>
                                <tr><td colspan="2" class="tb bb lb rb hcell">C = 3</td></tr>
                                <tr><td>7</td><td>8</td></tr>
                                <tr><td>1</td><td>8</td></tr>
                            </table>
                            <table>
                                <tr><th>A</th><th>B</th></tr>
                                <tr><td colspan="2" class="tb bb lb rb hcell">C = 7</td></tr>
                                <tr><td>7</td><td>5</td></tr>
                                <tr><td>1</td><td>2</td></tr>
                                <tr><td>9</td><td>2</td></tr>
                            </table>
                        </td>
                        <td style="text-align: center">SELECT MIN(A), MAX(B), C</td>
                        <td class="nohighlight">
                            <table style="margin: auto">
                                <tr><td>9</td><td>8</td><td class="tb rb lb hcell">0</td></tr>
                                <tr><td>1</td><td>8</td><td class="rb lb hcell">3</td></tr>
                                <tr><td>1</td><td>5</td><td class="bb rb lb hcell">7</td></tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="hstack nohighlight">
                            <table>
                                <tr><th>A</th><th>B</th></tr>
                                <tr><td colspan="2" class="tb bb lb rb hcell">C = 0</td></tr>
                                <tr><td>9</td><td>5</td></tr>
                                <tr><td>9</td><td>8</td></tr>
                            </table>
                            <table>
                                <tr><th>A</th><th>B</th></tr>
                                <tr><td colspan="2" class="tb bb lb rb hcell">C = 3</td></tr>
                                <tr><td>7</td><td>8</td></tr>
                                <tr><td>1</td><td>8</td></tr>
                            </table>
                            <table>
                                <tr><th>A</th><th>B</th></tr>
                                <tr><td colspan="2" class="tb bb lb rb hcell">C = 7</td></tr>
                                <tr><td>7</td><td>5</td></tr>
                                <tr><td>1</td><td>2</td></tr>
                                <tr><td>9</td><td>2</td></tr>
                            </table>
                        </td>
                        <td style="text-align: center">SELECT COUNT(A), AVG(B), C</td>
                        <td class="nohighlight">
                            <table style="margin: auto">
                                <tr><td>2</td><td>6</td><td class="tb rb lb hcell">0</td></tr>
                                <tr><td>2</td><td>8</td><td class="rb lb hcell">3</td></tr>
                                <tr><td>3</td><td>3</td><td class="bb rb lb hcell">7</td></tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="hstack nohighlight">
                            <table>
                                <tr><th>A</th></tr>
                                <tr><td colspan="1" class="tb bb lb rb hcell">C = 0</td></tr>
                                <tr><td>9</td></tr>
                                <tr><td>9</td></tr>
                            </table>
                            <table>
                                <tr><th>A</th></tr>
                                <tr><td colspan="1" class="tb bb lb rb hcell">C = 3</td></tr>
                                <tr><td>7</td></tr>
                                <tr><td>1</td></tr>
                            </table>
                            <table>
                                <tr><th>A</th></tr>
                                <tr><td colspan="1" class="tb bb lb rb hcell">C = 7</td></tr>
                                <tr><td>7</td></tr>
                                <tr><td>1</td></tr>
                                <tr><td>9</td></tr>
                            </table>
                        </td>
                        <td style="text-align: center">SELECT SUM(A), C</td>
                        <td class="nohighlight">
                            <table style="margin: auto">
                                <tr><td>18</td><td class="tb rb lb hcell">0</td></tr>
                                <tr><td>8</td><td class="rb lb hcell">3</td></tr>
                                <tr><td>17</td><td class="bb rb lb hcell">7</td></tr>
                            </table>
                        </td>
                    </tr>
                </table>

                <blockquote>
                    <p><strong>Note:</strong> The AVG aggregator will be rounded down automatically because the resulting decimal values are casted to integers, therefore decimals are lost in the process. You will never see decimal numbers in this module.</p>
                </blockquote>
            </div>
            <div class="page-footer relative-footer">Page 5 of 5</div>
        </div>
    </div>
</body>
</html>