<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Simon Steps — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/ruleseed.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
            text-align: center;
        }
        .page-footer::before { content: 'Page '; }
        .page-footer::after { content: ' of 1'; }
    </style>
    <script>
        const direction = ["U", "R", "D", "L"];
        let defaultRules = null;
        let rng;

        function setDefaultRules(rnd) {
            getDefaultRules();
            for (let i = 1; i <= 4; i++)
                for (let j = 1; j <= 8; j++)
                    document.getElementById(`stage-${i}-row-${j}`).innerText = defaultRules[`stage-${i}-row-${j}`];

            const directions = [
                ["U", "R", "D", "L", "U", "L", "D", "R"],
                ["R", "D", "L", "U", "R", "U", "L", "D"],
                ["D", "L", "U", "R", "D", "R", "U", "L"],
                ["L", "U", "R", "D", "L", "D", "R", "U"]
            ];
            generateTables(directions);
        }

        function getDefaultRules() {
            if (defaultRules !== null)
                return;
            defaultRules = {};
            for (let i = 1; i <= 4; i++)
                for (let j = 1; j <= 8; j++)
                    defaultRules[`stage-${i}-row-${j}`] = document.getElementById(`stage-${i}-row-${j}`).innerText;
        }

        function setRules(rnd) {
            setDefaultRules();
            rng = rnd;
            generateDirections(rng);
        }

        function generateDirections(rng) {
            const directions = [
                ["", "", "", "", "", "", "", ""],
                ["", "", "", "", "", "", "", ""],
                ["", "", "", "", "", "", "", ""],
                ["", "", "", "", "", "", "", ""]
            ];
            for (let i = 0; i < 4; i++)
                for (let j = 0; j < 8; j++)
                    directions[i][j] = direction[rng.nextMax(4)];
            generateTables(directions);
        }

        function generateTables(directions) {
            for (let i = 1; i <= 4; i++) {
                for (let j = 1; j <= 8; j++) {
                    switch (directions[i - 1][j - 1]) {
                        case "U":
                            document.getElementById(`stage-${i}-row-${j}`).innerText = "Up";
                            break;
                        case "L":
                            document.getElementById(`stage-${i}-row-${j}`).innerText = "Left";
                            break;
                        case "R":
                            document.getElementById(`stage-${i}-row-${j}`).innerText = "Right";
                            break;
                        case "D":
                            document.getElementById(`stage-${i}-row-${j}`).innerText = "Down";
                            break;
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Simon Steps</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Simon Steps.svg" class="diagram">
                <h2>On the Subject of Simon Steps</h2>
                <p class="flavour-text">I’m stepping away from this. Too many Simons on this trail.</p>
                <p>For each stage note the flashing digits and colours.</p>
                <p>On each subsequent stage append the flashing digits to the ruleseed and use this manual 
                   with that ruleseed <b>%2147483647</b>
                   (you can do that by appending "<var>#n</var>" (where <var>n</var> is the ruleseed) to this browser's page name).</p>
                <p>Press anything to enter submission. A number will appear in the center of the diamond. 
                   Use the colours that flashed on that stage <b>in the table associated with the module's current stage</b>
                   to get the directions to submit.</p>
                <p>To solve the module, complete the four stages of the module. 
                   Pressing an incorrect direction during a stage's submission will result in a strike. Once the module strikes, all stages
                   from beginning to current will flash again. Once finished, the module will allow submissions.</p>
                <table class="steps-table">
                    <tr><td colspan="2">Stage 1</td><td class="keypad-table-spacer"></td><td colspan="2">Stage 2</td><td class="keypad-table-spacer"></td><td colspan="2">Stage 3</td><td class="keypad-table-spacer"></td><td colspan="2">Stage 4</td></tr>
                    <tr><td>Red</td><td id="stage-1-row-1"></td><td class="keypad-table-spacer"></td><td>Red</td><td id="stage-2-row-1"></td><td class="keypad-table-spacer"></td><td>Red</td><td id="stage-3-row-1"></td><td class="keypad-table-spacer"></td><td>Red</td><td id="stage-4-row-1"></td></tr>
                    <tr><td>Orange</td><td id="stage-1-row-2"></td><td class="keypad-table-spacer"></td><td>Orange</td><td id="stage-2-row-2"></td><td class="keypad-table-spacer"></td><td>Orange</td><td id="stage-3-row-2"></td><td class="keypad-table-spacer"></td><td>Orange</td><td id="stage-4-row-2"></td></tr>
                    <tr><td>Yellow</td><td id="stage-1-row-3"></td><td class="keypad-table-spacer"></td><td>Yellow</td><td id="stage-2-row-3"></td><td class="keypad-table-spacer"></td><td>Yellow</td><td id="stage-3-row-3"></td><td class="keypad-table-spacer"></td><td>Yellow</td><td id="stage-4-row-3"></td></tr>
                    <tr><td>Green</td><td id="stage-1-row-4"></td><td class="keypad-table-spacer"></td><td>Green</td><td id="stage-2-row-4"></td><td class="keypad-table-spacer"></td><td>Green</td><td id="stage-3-row-4"></td><td class="keypad-table-spacer"></td><td>Green</td><td id="stage-4-row-4"></td></tr>
                    <tr><td>Cyan</td><td id="stage-1-row-5"></td><td class="keypad-table-spacer"></td><td>Cyan</td><td id="stage-2-row-5"></td><td class="keypad-table-spacer"></td><td>Cyan</td><td id="stage-3-row-5"></td><td class="keypad-table-spacer"></td><td>Cyan</td><td id="stage-4-row-5"></td></tr>
                    <tr><td>Blue</td><td id="stage-1-row-6"></td><td class="keypad-table-spacer"></td><td>Blue</td><td id="stage-2-row-6"></td><td class="keypad-table-spacer"></td><td>Blue</td><td id="stage-3-row-6"></td><td class="keypad-table-spacer"></td><td>Blue</td><td id="stage-4-row-6"></td></tr>
                    <tr><td>Purple</td><td id="stage-1-row-7"></td><td class="keypad-table-spacer"></td><td>Purple</td><td id="stage-2-row-7"></td><td class="keypad-table-spacer"></td><td>Purple</td><td id="stage-3-row-7"></td><td class="keypad-table-spacer"></td><td>Purple</td><td id="stage-4-row-7"></td></tr>
                    <tr><td>White</td><td id="stage-1-row-8"></td><td class="keypad-table-spacer"></td><td>White</td><td id="stage-2-row-8"></td><td class="keypad-table-spacer"></td><td>White</td><td id="stage-3-row-8"></td><td class="keypad-table-spacer"></td><td>White</td><td id="stage-4-row-8"></td></tr>
                </table>
            </div>
            <div class="page-footer relative-footer">1</div>
        </div>
    </div>
</body>
</html>