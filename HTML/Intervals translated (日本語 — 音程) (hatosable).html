<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>音程 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
    .imgbox {
        display: grid;
        height: 100%;
    }
    .center-fit {
        max-width: 80%;
        max-height: 80vh;
        margin: auto;
    }
    .minimum{
     font-size: 5px;
    }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">音程</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Intervals.svg" class="diagram">
                <h2>モジュール詳細：音程</h2>
                <p class="flavour-text">2個のボタンしかないなんて、超カンタンじゃん！</p>
                <ul>
                    <li>モジュール上には、ラベルが記された2つのボタンがある。
                    <li>モジュールを解除するには、モジュールで再生される音の正しい音程(インターバル)を送信する。
                    <li>間違った音程を送信すると、ミスが記録される。
                    <li>ボタンの押し方は「左左、右右、左右、右左」の4種類の組み合わせがある。
                    <li>これらの組み合わせのうち2つは、一方のボタンが循環しながらそのボタンに応じて一定の方向に3つの音を奏でる。左のボタンは、常に「I（長音程）、A（短音程）、+（増音程）、o（減音程）、P（完全）」の順で循環する。右のボタンは、1～8までの数字を循環させる。
                    <li>残りの組み合わせのうち1つは、音程を奏でる。パターンは、メロディー（上昇または下降）またはハーモニー（同時）である。これが、送信する必要のある音程である。
                    <li>残り1つの組み合わせは画面上に現れている音程を送信し、3つの和音を奏でる。この組み合わせは最初に入力された際には送信されない。
                    <li>全ての組み合わせはシャッフルされているが、変更はされない。
                    <li>このマニュアルが何を言っているのか分からない場合は、「音程にまつわる講義」を参照すること。
                </ul>
                <h3>鍵盤</h3>
                <div>
                    <!--

                        <select></select>
                        <button>Play</button>
                    -->
                    <svg viewBox="-0.05 -0.05 22.1 3.75" class="piano-1"></svg>
                    <svg viewBox="-0.05 -0.05 22.1 3.75" class="piano-2"></svg>
                    <audio class="note-audio" hidden></audio>
                </div>
                <h3><u>音程にまつわる<span class="minimum">ありがたい</span>講義</u></h3>
                <p>音程とは、ズバリ二つの音の高さの差を表すんだ。音程というと我々はピッチ(pitch)を思い浮かべるかもしれないが、厳密に言うとそれは音高と呼ばれ、全く異なるんだよね。それぞれの音程は「質(音階の英字)」と「量(数字)」で記述する。例えば、M6やm3やP4という感じだ。やはり何事も質と量のバランスが大事ってこと。
                <p>ここからは質について詳しく話していこう。各音階が持つ質は「長音程(M)、短音程(m)、増音程(Aug)、減音程(Dim)、完全(P)」のどれかになる。「そんなの日本人でも聞いたことねぇよ！」とツッコミたくなるかもしれないが、まぁ落ち着いてくれ。音楽のコードで「メジャー(M)、マイナー(m)」くらいは何となく聞いたことあるだろう。それと近い。ただ、質が完全の音程はP1、P4、P5、P8しかない。しかも、これらの音程は長音程にも短音程にもなれないんだ。どういうことか分かるか？そう、M5とかm8という音程は存在しないんだ！もちろん、逆にP2やP7も存在しない。<br>しかも、まだ存在しない音程はある。それはdim1だ。このdimというのは、短音程のときの差から更に半音狭めた時の音程になる。下の図を見てもらうと分かるように、短音2度はドとレ♭からなる音程だ。ピアノを用意して数えてみると、その半音差は1となる。そこからさらに半音差を狭めると……。ああ！0だ！これでは完全に一致してしまう！そうなってしまっては音程もクソも無くなってしまう、という訳さ。その他の音程は図を見て察してくれ。
                <div class="imgbox">
                    <img class="center-fit" src='img/Intervals/Intervals.png'>
                </div>
            </div>
           <div class="page-footer relative-footer">ページ 1/2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">音程</span>
            </div>
            <div class="page-content">
                <p>さて、ここからいよいよお待ちかねの音程の求め方だが……。実を言うとその音程を持っている人気楽曲を参考にする人が大多数だ。P5は、スター・ウォーズのテーマの最初の2音がちょうどそれだったりする。ほら、あの、テーンテーンテテテテーンの部分。一応オリジナルのマニュアルが、オンラインで有名楽曲の音程を調べられる<a href="https://flypaper.soundfly.com/tips/interval-cheat-sheet-songs-to-help-you-remember-common-intervals/">サイト</a>を用意してくれている。でも、<b>日本人には全然馴染みのない曲も多いんだよな！</b> ご安心を。優しい僕が、日本人にも比較的馴染みのある曲で一覧をまとめている<a href="https://www.musicca.com/jp/interval-song-chart/">サイト</a>を発見した。多少マシにはなるだろう。
                <p>当たり前だが、モジュールはこれらのサイトと全く同じ音で音程を演奏する訳ではない。違う音から始まっても、同じ音程で奏でられる。異なる音で始まったとしても、同じに聞こえるはずだ。嘘だと思うなら、以下のオーディオクリップを聞いてみるんだ。音は違うが、同じ音程で演奏していると、どちらも同じ曲に感じるだろう？
                <br>
                <audio controls>
                    <source src="img/Intervals/TwinkleC.mp3" type="audio/mpeg">
                    このブラウザではオーディオがサポートされていない。残念！別のブラウザで試してみてくれ。
                </audio>
                <audio controls>
                    <source src="img/Intervals/TwinkleFS.mp3" type="audio/mpeg">
                    このブラウザではオーディオがサポートされていない。残念！別のブラウザで試してみてくれ。
                </audio>
                <p>驚いていないで次のオーディオクリップを聞いてみるんだ。どうだい？全く異なる音で始まっていても、ちゃんとあの曲だって分かるだろう。
                <br>
                <audio controls>
                    <source src="img/Intervals/Mario.mp3" type="audio/mpeg">
                    このブラウザではオーディオがサポートされていない。残念！別のブラウザで試してみてくれ。
                </audio>
                <p>じゃあ、音程を学ぶぴったりの方法とは何か？耳を鍛えろ。以上。今、画面の向こうで嫌な顔をしたな？しょうがないな。<a href="https://www.musictheory.net/exercises">musictheory.net</a>のthe Ear Training sectionの項目では、クイズ形式で耳を鍛える事ができるし、その他にも手厚いサポートを受けることができる。クイズに縛られたくなければ<a href="https://www.musicca.com/jp/interval-finder">musicca.com</a>の和音検索をうまく使うと良い。一番簡単なのは完全音程で、一番難しいのは短音程だ。それでは頑張ってくれ！
            </div>
           <div class="page-footer relative-footer">ページ 2/2</div>
        </div>
    </div>
    <script>
     const noteAudio = document.querySelector("audio.note-audio");
     const notes = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];

     let piano = document.querySelector(".piano-1");
     let x = 0;
     for (let octave = 3; octave < 9; octave++)
     {
         if (octave == 6)
         {
             piano = document.querySelector(".piano-2");
             x = 0;
         }

         const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
         text.setAttribute("x", x + 3.5);
         text.setAttribute("y", 3.5);
         text.setAttribute("font-size", "0.5");
         text.setAttribute("fill", "black");
         text.setAttribute("text-anchor", "middle");
         text.textContent = (octave == 3 ? "3rd" : `${octave}th`) + " Octave";;
         piano.append(text);

         for (const note of notes) {
             const sharp = note.endsWith("#");

             const key = document.createElementNS("http://www.w3.org/2000/svg", "rect");
             key.setAttribute("x", x - (sharp ? 0.4 : 0));
             key.setAttribute("y", 0);
             key.setAttribute("width", sharp ? 0.75 : 1);
             key.setAttribute("height", sharp ? 2 : 3);
             key.setAttribute("fill", sharp ? "black" : "white");
             key.setAttribute("stroke", "black");
             key.setAttribute("stroke-width", 0.05);
             if (sharp) piano.append(key); else piano.prepend(key);

             key.addEventListener("click", function() {
                 noteAudio.src = `audio/Intervals/${encodeURIComponent(note + octave)}.mp3`;
                 noteAudio.play();
             });

             const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
             text.setAttribute("x", x - (sharp ? 0.4 : 0) + (sharp ? 0.75 : 1) / 2);
             text.setAttribute("y", sharp ? 1.25 : 2.6);
             text.setAttribute("font-size", "0.5");
             text.setAttribute("fill", sharp ? "white" : "black");
             text.setAttribute("text-anchor", "middle");
             text.style.pointerEvents = "none";
             text.textContent = note;
             piano.append(text);

             x += sharp ? 0 : 1;

             if (octave == 8)
                 break;
         }
     }

     selector.addEventListener("change", function(e)
     {
         noteAudio.src = `audio/Intervals/${encodeURIComponent(selector.value)}.mp3`;
         noteAudio.play();
     });
 </script>
</body>
</html>
