<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Affine CM — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Affine CM</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Cipher Machine.svg" class="diagram">
                <h2>On the Subject of the Affine CM</h2>
                <p class="flavour-text">A machine that knows no bounds when it comes to ciphers.</p>
                <p>Turn each letter of the encrypted word into its alphabetic position (A1Y25Z0). These numbers will be your Cs to decrypt.</p>
                <p>Take the 2 variables from screen 1. The number on the left is E and the letter on the right is X.</p>
                <p>Convert the variable X to a Value via the Value Table. Take the resulting value, modulo 25, plus 1. This is your actual X value.</p>
                <p>If the Submit Button is white, use Equation A. Otherwise, use Equation B.</p>
                <p>Take each number C through the equation then turn it back to a letter.</p>
                <h4 class="centered">Equation A</h4>
                <p class="centered">((C * E) + X) mod 26</p>
                <h4 class="centered">Equation B</h4>
                <p class="centered">((C - X) * D) mod 26</p>
                <p>The instructions to determine D are written on the next page.</p>
                <h4 class="centered">Example</h4>
                <p class="centered">Encrypted Word: PUKNE<br>E: 7<br>X: S → (9 % 25) + 1 = 10<br>Submit Button: White</p>
                <p class="centered">
                P → ((16 * 7) + 10) % 26 → 18 → R<br>
                U → ((21 * 7) + 10) % 26 → 1 → A<br>
                K → ((11 * 7) + 10) % 26 → 9 → I<br>
                N → ((14 * 7) + 10) % 26 → 4 → D<br>
                E → ((5 * 7) + 10) % 26 → 19 → S 
                </p>
                <p class="centered">Decrypted Word: RAIDS</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Affine CM</span>
            </div>
            <div class="page-content">
                <h3>Determining D - Logic Way</h3>
                <ul>
                <li>1. Set up 7 variables: A, B, Q, R, T1, T2, T3.</li>
                <li>2. Set A equal to 26.</li>
                <li>3. Set B equal to E.</li>
                <li>4. Q is equal to A / B, rounded down.</li>
                <li>5. R is equal to A mod B.</li>
                <li>6. Set T1 equal to 0.</li>
                <li>7. Set T2 equal to 1.</li>
                <li>8. T3 is equal to T1 - (T2 * Q).</li>
                <li>9. Set A equal to B.</li>
                <li>10. Set B equal to R.</li>
                <li>11. Q is equal to A / B, rounded down.</li>
                <li>12. R is equal to A mod B.</li>
                <li>13. Set T1 equal to T2.</li>
                <li>14. Set T2 equal to T3.</li>
                <li>15. T3 is equal to T1 - (T2 * Q).</li>
                <li>16. Repeat steps 9 - 15 until R is equal to 0, stopping at step 12.</li>
                <li>17. Your D is equal to T2 mod 26.</li>
                </ul>
             <h3>Determining D - Brute Force Way</h3>
                <ul>
                <li>1. Find I in this equation: ((I * 26) + 1) mod E = 0</li>
                <li>2: D is equal to: ((I * 26) + 1) / E</li>
                <li>A: This can be used as well: (D * E) mod 26 = 1</li>
                </ul>
            <h3>Determining D - Degenerate Way</h3>
            <p>There's going to be a cheat sheet somewhere down the line. I might as well do it for them:</p>
            <table>
            <tr><th>E</th><td>3</td><td>5</td><td>7</td><td>9</td><td>11</td><td>15</td><td>17</td><td>19</td><td>21</td><td>23</td><td>25</td></tr>
            <tr><th>D</th><td>9</td><td>21</td><td>15</td><td>3</td><td>19</td><td>7</td><td>23</td><td>11</td><td>5</td><td>17</td><td>25</td></tr>
            </table>
            </div>
            <div class="page-footer relative-footer">Page 2 of 2</div>
        </div>
    </div>
</body>
</html>